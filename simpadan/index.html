<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>SIMPADAN TANGKAP - SISTEM PEMETAAN NELAYAN</title>
    
    <!-- LOAD SEMUA CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@500;600;700;800;900&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <!-- LOAD SEMUA JAVASCRIPT LIBRARY -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- LOAD FILE JAVASCRIPT YANG DIPISAHKAN -->
    <script src="idcard.js" onerror="console.log('File idcard.js tidak ditemukan, menggunakan versi di main.js')"></script>
    <script src="reload.js" onerror="console.log('File reload.js belum tersedia di server, menggunakan database lokal.')"></script>
    <script src="convert.js"></script>
    <script src="main.js" defer></script>
</head>
<body>

    <!-- Modal Loading -->
    <div class="loading-modal-overlay" id="loadingModal" style="display: none;">
        <div class="loading-modal-content">
            <div class="loading-spinner"></div>
            <h3 class="loading-title" id="loadingTitle">Memproses Data</h3>
            <p class="loading-message" id="loadingMessage">Mohon tunggu, sistem sedang memproses permintaan Anda. Proses ini mungkin memerlukan waktu beberapa saat tergantung jumlah data yang tersedia.</p>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <div id="qr-code-generator">
        <div id="qr-right"></div> 
    </div>
    
    <!-- Container untuk tabel PDF (hidden) -->
    <div class="pdf-table-container" id="pdfTableContainer"></div>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="login-overlay" id="loginModal">
        <ul class="circles">
            <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
        </ul>
        <div class="login-card">
            <div class="login-header-new">
                <div class="simata-logo-container">
                    <div class="simata-icon-box">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMPADAN TANGKAP" onerror="this.onerror=null; this.innerHTML='<i class=\'fas fa-eye fa-4x\'></i>';">
                    </div>
                </div>
                <h1 class="simata-title">SIMPADAN TANGKAP</h1>
                <p class="simata-subtitle">SISTEM SATU DATA NELAYAN</p>
                <div class="simata-slogan">Situbondo Naik Kelas</div>
            </div>
            <div class="p-4 p-md-5 pt-2">
                <form id="loginForm">
                    <div class="mb-4 text-center">
                        <p class="small text-primary fw-bold mb-2" id="currentDateDisplay"></p>
                        <div class="input-group input-group-lg shadow-sm rounded-pill overflow-hidden">
                            <span class="input-group-text bg-light border-0 ps-4"><i class="fas fa-key text-success"></i></span>
                            <input type="password" class="form-control bg-light border-0 fs-6" id="securityCode" placeholder="Masukkan kode keamanan" required>
                            <button type="button" class="input-group-text bg-light border-0 password-toggle-btn" id="passwordToggle">
                                <i class="fas fa-eye" id="passwordToggleIcon"></i>
                            </button>
                        </div>
                        <small class="text-muted mt-2 d-block" id="passwordHint">Kode Keamanan Berubah Setiap Hari</small>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 py-3 fw-bold shadow rounded-pill" id="loginButton" style="background: var(--primary-gradient);">
                        BUKA DASHBOARD
                        <span class="spinner-border spinner-border-sm d-none ms-2" id="loginSpinner"></span>
                    </button>
                </form>
                
                <!-- TOMBOL TAMBAHAN BARU -->
                <div class="login-extra-buttons">
                    <a href="https://drive.google.com/drive/folders/1zmLnQ8bXFEL682BXzA2pV6WsQq7p4wdo?usp=sharing" target="_blank" class="btn btn-outline-primary">
                        <i class="fas fa-download me-2"></i>Panduan Aplikasi
                    </a>
                    <a href="http://www.dinasperikanansitubondo.com/simpadan/peta" target="_blank" class="btn btn-outline-success">
                        <i class="fas fa-map me-2"></i>Lihat Peta
                    </a>
                </div>
                
                <div class="text-center mt-4 pt-3 border-top">
                    <small class="text-muted opacity-75">&copy; 2025 Dinas Perikanan Kabupaten Situbondo</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Notifikasi Login Berhasil -->
    <div class="modal fade login-success-modal" id="loginSuccessModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="w-100 d-flex flex-column align-items-center justify-content-center">
                        <i class="fas fa-check-circle fa-3x mb-3 text-warning"></i>
                        <h4 class="fw-bold mb-0 text-center">Akses Diotorisasi</h4>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="login-success-icon d-flex justify-content-center">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h5 class="fw-bold text-center mb-4" style="color: #0c2461;">SELAMAT DATANG DI SIMPADAN TANGKAP</h5>
                    
                    <div class="welcome-message">
                        <p class="mb-3">Anda telah berhasil mengakses <span class="fw-bold" style="color: #0c2461;">Sistem Informasi Pemetaan Data Nelayan Terpadu</span> Dinas Perikanan Kabupaten Situbondo.</p>
                        
                        <div class="welcome-highlight mb-3">
                            <i class="fas fa-user-check me-2"></i>Akses Anda telah diverifikasi dan diotorisasi
                        </div>
                        
                        <div class="welcome-highlight mb-3">
                            <i class="fas fa-database me-2"></i>Sistem siap untuk pengelolaan data nelayan terpadu
                        </div>
                        
                        <div class="welcome-highlight">
                            <i class="fas fa-chart-line me-2"></i>Dashboard analitik tersedia untuk pengambilan keputusan
                        </div>
                    </div>
                    
                    <p class="text-muted small mt-4 text-center">
                        <i class="fas fa-info-circle me-2"></i>
                        Sistem ini menggunakan teknologi keamanan dinamis untuk melindungi data sensitif
                    </p>
                </div>
                <div class="modal-footer justify-content-center border-0">
                    <button type="button" class="btn btn-primary px-5 fw-bold shadow" data-bs-dismiss="modal" id="btnContinueDashboard">
                        <i class="fas fa-rocket me-2"></i>LANJUT KE DASHBOARD
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="welcomeModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content welcome-modal-content">
                <div class="welcome-header">
                    <i class="fas fa-satellite-dish fa-3x mb-3 text-warning"></i>
                    <h4 class="fw-bold mb-0">Selamat Datang, Sobat!</h4>
                </div>
                <div class="welcome-body">
                    <p class="text-muted mb-4">
                        Untuk memastikan data yang Anda akses adalah data terbaru dan valid, sistem merekomendasikan untuk melakukan <strong>Sinkronisasi Data</strong> terlebih dahulu.
                    </p>
                    <div class="d-grid gap-2 justify-content-center">
                        <button type="button" class="welcome-btn-reload" id="btnWelcomeReload">
                            <i class="fas fa-sync me-2"></i> Sinkronisasi Data Sekarang
                        </button>
                        <button type="button" class="btn btn-link text-muted text-decoration-none btn-sm mt-2" data-bs-dismiss="modal">
                            Tutup Notifikasi
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Data Wilayah - DIREVISI DENGAN TAB DESA DAN KECAMATAN -->
    <div class="modal fade" id="modalDataWilayah" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="wilayah-modal-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="modal-title fw-bold mb-1"><i class="fas fa-map-marked-alt me-2"></i> Data Wilayah</h5>
                            <p class="mb-0 opacity-75">Kelola data berdasarkan wilayah administratif</p>
                        </div>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                </div>
                <div class="modal-body p-0">
                    <div class="wilayah-search-box px-4">
                        <div class="alert alert-info mb-3">
                            <i class="fas fa-info-circle me-2"></i>
                            Pilih desa atau kecamatan untuk memuat data nelayan dari wilayah tersebut. Anda juga dapat langsung input data untuk wilayah yang dipilih.
                        </div>
                        
                        <div class="row align-items-center mb-3">
                            <div class="col-md-6">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" class="form-control" id="searchWilayah" placeholder="Cari nama desa atau kecamatan...">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex justify-content-end align-items-center gap-3">
                                    <div class="wilayah-status-indicator" id="wilayahStatusIndicator">
                                        <i class="fas fa-globe"></i>
                                        <span>Mode Global</span>
                                    </div>
                                    <button class="btn btn-warning" id="btnInputGlobalModal">
                                        <i class="fas fa-globe me-2"></i> Switch ke Global
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tab untuk Desa dan Kecamatan -->
                    <div class="px-4 mb-4">
                        <ul class="nav nav-tabs" id="wilayahTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="desa-tab" data-bs-toggle="tab" data-bs-target="#desa-tab-pane" type="button" role="tab" aria-controls="desa-tab-pane" aria-selected="true">
                                    <i class="fas fa-village me-2"></i> Data Desa
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="kecamatan-tab" data-bs-toggle="tab" data-bs-target="#kecamatan-tab-pane" type="button" role="tab" aria-controls="kecamatan-tab-pane" aria-selected="false">
                                    <i class="fas fa-city me-2"></i> Data Kecamatan
                                </button>
                            </li>
                        </ul>
                        
                        <div class="tab-content mt-3" id="wilayahTabContent">
                            <!-- Tab Desa -->
                            <div class="tab-pane fade show active" id="desa-tab-pane" role="tabpanel" aria-labelledby="desa-tab" tabindex="0">
                                <div class="wilayah-grid" id="desaListContainer">
                                    <!-- Data desa akan dimuat di sini -->
                                </div>
                            </div>
                            
                            <!-- Tab Kecamatan -->
                            <div class="tab-pane fade" id="kecamatan-tab-pane" role="tabpanel" aria-labelledby="kecamatan-tab" tabindex="0">
                                <div class="wilayah-grid" id="kecamatanListContainer">
                                    <!-- Data kecamatan akan dimuat di sini -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-primary" id="btnLoadSelectedWilayah">
                        <i class="fas fa-download me-2"></i> Muat Data Wilayah Terpilih
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Pengaturan Keamanan -->
    <div class="modal fade" id="modalPengaturanKeamanan" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title fw-bold"><i class="fas fa-user-shield me-2"></i> Pengaturan Keamanan Sistem</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="security-status mb-4">
                        <h6><i class="fas fa-shield-alt me-2 text-primary"></i>Status Keamanan Sistem</h6>
                        <p class="mb-0 small">Semua pengaturan keamanan di bawah ini mempengaruhi akses ke fitur input data dan data nelayan.</p>
                    </div>
                    
                    <!-- Kode Keamanan Input Data -->
                    <div class="security-card mb-4">
                        <div class="security-card-header">
                            <h6 class="fw-bold mb-0"><i class="fas fa-edit me-2 text-primary"></i>Kode Keamanan Input Data</h6>
                        </div>
                        <div class="security-card-body">
                            <form id="inputCodeForm">
                                <div class="row mb-3">
                                    <div class="col-md-12 mb-3">
                                        <label class="form-label">Kode Keamanan Input Data Saat Ini</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="currentInputCode" placeholder="Masukkan kode saat ini" required>
                                            <button type="button" class="btn btn-outline-secondary" id="toggleCurrentInputCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <small class="text-muted">Kode ini digunakan untuk mengakses fitur input data nelayan.</small>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Kode Keamanan Input Data Baru</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="newInputCode" placeholder="Kode baru (min. 6 digit)" required minlength="6">
                                            <button type="button" class="btn btn-outline-secondary" id="toggleNewInputCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Konfirmasi Kode Baru</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="confirmInputCode" placeholder="Ulangi kode baru" required minlength="6">
                                            <button type="button" class="btn btn-outline-secondary" id="toggleConfirmInputCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-2"></i>Perbarui Kode Keamanan Input Data
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Kode Keamanan Data Menu -->
                    <div class="security-card mb-4">
                        <div class="security-card-header">
                            <h6 class="fw-bold mb-0"><i class="fas fa-database me-2 text-success"></i>Kode Keamanan Data Menu</h6>
                        </div>
                        <div class="security-card-body">
                            <form id="dataMenuCodeForm">
                                <div class="row mb-3">
                                    <div class="col-md-12 mb-3">
                                        <label class="form-label">Kode Keamanan Data Menu Saat Ini</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="currentDataMenuCode" placeholder="Masukkan kode saat ini" required>
                                            <button type="button" class="btn btn-outline-secondary" id="toggleCurrentDataMenuCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <small class="text-muted">Kode ini digunakan untuk mengakses menu data nelayan.</small>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Kode Keamanan Data Menu Baru</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="newDataMenuCode" placeholder="Kode baru (min. 6 digit)" required minlength="6">
                                            <button type="button" class="btn btn-outline-secondary" id="toggleNewDataMenuCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Konfirmasi Kode Baru</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="confirmDataMenuCode" placeholder="Ulangi kode baru" required minlength="6">
                                            <button type="button" class="btn btn-outline-secondary" id="toggleConfirmDataMenuCode">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-save me-2"></i>Perbarui Kode Keamanan Data Menu
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- FITUR BARU: Pengaturan Pejabat Penandatangan -->
                    <div class="card p-4 border-0 shadow-sm mb-4">
                        <h6 class="fw-bold mb-3 border-bottom pb-2">Pengaturan Pejabat Penandatangan</h6>
                        <form id="officialForm">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Nama Pejabat</label>
                                    <input type="text" class="form-control" id="officialName" placeholder="Masukkan nama pejabat" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">NIP</label>
                                    <input type="text" class="form-control" id="officialNip" placeholder="Masukkan NIP pejabat" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-12">
                                    <label class="form-label">Jabatan</label>
                                    <input type="text" class="form-control" id="officialPosition" placeholder="Masukkan jabatan pejabat" required>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Simpan Pengaturan Pejabat</button>
                            <small class="text-muted d-block mt-2">*Data ini akan digunakan untuk tanda tangan pada dokumen PDF resmi</small>
                        </form>
                    </div>
                    
                    <!-- Kode Keamanan Sensor Data -->
                    <div class="card p-4 border-0 shadow-sm mb-4">
                        <h6 class="fw-bold mb-3 border-bottom pb-2">Kode Keamanan Sensor Data</h6>
                        <form id="sensorCodeForm">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Kode Keamanan Sensor Saat Ini</label>
                                    <input type="password" class="form-control" id="currentSensorCode" placeholder="Masukkan kode saat ini" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Kode Keamanan Sensor Baru</label>
                                    <input type="password" class="form-control" id="newSensorCode" placeholder="Kode baru (min. 6 digit)" required minlength="6">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Konfirmasi Kode Baru</label>
                                    <input type="password" class="form-control" id="confirmSensorCode" placeholder="Ulangi kode baru" required minlength="6">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Perbarui Kode Keamanan Sensor</button>
                            <small class="text-muted d-block mt-2">*Kode ini digunakan untuk menonaktifkan sensor dan reset data</small>
                        </form>
                    </div>
                    
                    <div class="card p-4 border-0 shadow-sm border-left border-4 border-danger">
                        <h6 class="fw-bold mb-3 text-danger"><i class="fas fa-user-shield me-2"></i>Privasi & Keamanan Data</h6>
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong class="d-block">Sensor Data Pribadi (NIK & No. HP)</strong>
                                <small class="text-muted">Menyensor 4 digit terakhir dengan tanda bintang (*) pada tabel dan hasil unduhan.</small>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="privacyToggle" style="width: 3em; height: 1.5em; cursor: pointer;" checked>
                            </div>
                        </div>
                        <div id="privacyStatus" class="mt-2 small text-success fw-bold">Status: Sensor Aktif (Aman)</div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-danger" id="btnResetAllCodes">
                        <i class="fas fa-redo me-2"></i> Reset Semua Kode
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal untuk Password Input Data -->
<div class="modal fade" id="modalInputPassword" tabindex="-1" aria-labelledby="modalInputPasswordLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="modalInputPasswordLabel">
                    <i class="fas fa-lock me-2"></i>Keamanan Input Data
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-4">
                    <i class="fas fa-shield-alt fa-3x text-primary mb-3"></i>
                    <h5 class="text-dark">Akses Input Data Dilindungi</h5>
                    <p class="text-muted">Masukkan password untuk mengakses menu Input Data</p>
                </div>
                
                <div class="mb-3">
                    <label for="inputPasswordInput" class="form-label">
                        <i class="fas fa-key me-1"></i>Password Input Data
                    </label>
                    <div class="input-group">
                        <input type="password" class="form-control" id="inputPasswordInput" placeholder="Masukkan password">
                        <button class="btn btn-outline-secondary" type="button" id="toggleInputPassword">
                            <i class="fas fa-eye" id="toggleInputPasswordIcon"></i>
                        </button>
                    </div>
                    <div class="form-text">Default password: 666666</div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-primary" id="inputPasswordBtn" onclick="verifyInputPassword()">
                    <i class="fas fa-unlock me-1"></i>Verifikasi
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal untuk Password Data Nelayan -->
<div class="modal fade" id="modalDataMenuPassword" tabindex="-1" aria-labelledby="modalDataMenuPasswordLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="modalDataMenuPasswordLabel">
                    <i class="fas fa-database me-2"></i>Keamanan Data Nelayan
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-4">
                    <i class="fas fa-lock fa-3x text-info mb-3"></i>
                    <h5 class="text-dark">Akses Data Nelayan Dilindungi</h5>
                    <p class="text-muted">Masukkan password untuk mengakses menu Data Nelayan</p>
                </div>
                
                <div class="mb-3">
                    <label for="dataMenuPasswordInput" class="form-label">
                        <i class="fas fa-key me-1"></i>Password Data Nelayan
                    </label>
                    <div class="input-group">
                        <input type="password" class="form-control" id="dataMenuPasswordInput" placeholder="Masukkan password">
                        <button class="btn btn-outline-secondary" type="button" id="toggleDataMenuPassword">
                            <i class="fas fa-eye" id="toggleDataMenuPasswordIcon"></i>
                        </button>
                    </div>
                    <div class="form-text">Default password: 999999</div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-info text-white" id="dataMenuPasswordBtn" onclick="verifyDataMenuPassword()">
                    <i class="fas fa-unlock me-1"></i>Verifikasi
                </button>
            </div>
        </div>
    </div>
</div>
    <!-- Main App Container (Akan ditampilkan setelah login) -->
    <div id="mainApp" style="display: none;">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars me-1"></i> MENU
        </button>

        <!-- Header -->
        <header class="app-header">
            <div class="app-logo-icon">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMPADAN TANGKAP" onerror="this.onerror=null; this.innerHTML='<i class=\'fas fa-eye fa-4x\'></i>';">
            </div>
            <h1 class="app-title">SIMPADAN TANGKAP</h1>
            <p class="app-subtitle">SISTEM SATU DATA NELAYAN</p>
            <div class="app-slogan">Situbondo Naik Kelas</div>
            <div class="app-origin">Dinas Perikanan Kabupaten Situbondo</div>
        </header>

        <!-- Main Container -->
        <div class="app-container">
            <div class="row g-0">
                <!-- Sidebar -->
                <div class="col-md-3 col-lg-2 bg-white border-end" id="sidebar">
                    <div class="nav flex-column nav-pills p-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                        <button class="nav-link active" id="v-pills-dashboard-tab" data-bs-toggle="pill" data-bs-target="#v-pills-dashboard" type="button" role="tab">
                            <i class="fas fa-chart-line"></i> Dashboard
                        </button>
                        <button class="nav-link" id="v-pills-data-tab" data-bs-toggle="pill" data-bs-target="#v-pills-data" type="button" role="tab">
                            <i class="fas fa-database"></i> Data Nelayan
                        </button>
                        <button class="nav-link" id="v-pills-input-tab" data-bs-toggle="pill" data-bs-target="#v-pills-input" type="button" role="tab">
                            <i class="fas fa-edit"></i> Input Data
                        </button>
                        <button class="nav-link" id="v-pills-map-tab" data-bs-toggle="pill" data-bs-target="#v-pills-map" type="button" role="tab">
                            <i class="fas fa-map-marked-alt"></i> Peta Sebaran
                        </button>
                        <button class="nav-link" id="v-pills-wilayah-tab" data-bs-toggle="pill" data-bs-target="#v-pills-wilayah" type="button" role="tab">
                            <i class="fas fa-map-marked-alt"></i> Data Wilayah
                        </button>
                        <button class="nav-link" id="v-pills-verifikasi-tab" data-bs-toggle="pill" data-bs-target="#v-pills-verifikasi" type="button" role="tab">
                            <i class="fas fa-qrcode"></i> Verifikasi KIN
                        </button>
                        <button class="nav-link" id="v-pills-filter-tab" data-bs-toggle="pill" data-bs-target="#v-pills-filter" type="button" role="tab">
                            <i class="fas fa-filter"></i> Filter Data
                        </button>
                        <button class="nav-link" id="v-pills-keamanan-tab" data-bs-toggle="pill" data-bs-target="#v-pills-keamanan" type="button" role="tab">
                            <i class="fas fa-user-shield"></i> Pengaturan Keamanan
                        </button>
                        <hr class="my-3">
                        <button class="nav-link text-danger" id="v-pills-logout-tab" type="button" id="btnLogout">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="col-md-9 col-lg-10">
                    <div class="tab-content p-3 p-lg-5" id="v-pills-tabContent">
                        <!-- Dashboard Tab -->
                        <div class="tab-pane fade show active" id="v-pills-dashboard" role="tabpanel">
                            <h3 class="section-title"><i class="fas fa-chart-line me-2"></i> Dashboard Statistik</h3>
                            <div class="row dashboard-row mb-4">
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <h4 class="card-title text-primary" id="totalNelayan">0</h4>
                                            <p class="card-text text-muted">Total Nelayan</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <h4 class="card-title text-success" id="totalPemilik">0</h4>
                                            <p class="card-text text-muted">Pemilik Kapal</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <h4 class="card-title text-warning" id="totalABK">0</h4>
                                            <p class="card-text text-muted">ABK</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <h4 class="card-title text-info" id="totalKapal">0</h4>
                                            <p class="card-text text-muted">Total Kapal</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Charts -->
                            <div class="row mb-4">
                                <div class="col-md-6 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body">
                                            <h5 class="card-title">Distribusi Profesi</h5>
                                            <div class="chart-container-fixed">
                                                <canvas id="profesiChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="card border-0 shadow-sm h-100">
                                        <div class="card-body">
                                            <h5 class="card-title">Distribusi Alat Tangkap</h5>
                                            <div class="chart-container-fixed">
                                                <canvas id="alatTangkapChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Data Terbaru -->
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white border-0">
                                    <h5 class="mb-0">Data Terbaru</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table data-table" id="latestDataTable">
                                            <thead>
                                                <tr>
                                                    <th>Nama</th>
                                                    <th>Profesi</th>
                                                    <th>Alat Tangkap</th>
                                                    <th>Domisili</th>
                                                    <th>Tanggal Validasi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="latestDataBody">
                                                <!-- Data akan diisi oleh JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Data Nelayan Tab -->
                        <div class="tab-pane fade" id="v-pills-data" role="tabpanel">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h3 class="section-title mb-0"><i class="fas fa-database me-2"></i> Data Nelayan</h3>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-success" id="btnExportExcel">
                                        <i class="fas fa-file-excel me-2"></i> Excel
                                    </button>
                                    <button type="button" class="btn btn-danger" id="btnExportPDF">
                                        <i class="fas fa-file-pdf me-2"></i> PDF
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table data-table" id="dataTable">
                                    <thead>
                                        <tr>
                                            <th class="col-id-cell">Nama Lengkap & NIK</th>
                                            <th>Usia</th>
                                            <th>Domisili</th>
                                            <th class="col-contact-cell">Kontak</th>
                                            <th>Profesi</th>
                                            <th>Status</th>
                                            <th>Alat Tangkap</th>
                                            <th class="col-status-cell">Validasi</th>
                                            <th class="col-action sticky-col-right">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dataTableBody">
                                        <!-- Data akan diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="pagination-container">
                                <div class="pagination-info" id="paginationInfo">
                                    Menampilkan 0 dari 0 data
                                </div>
                                <nav aria-label="Page navigation">
                                    <ul class="pagination" id="pagination">
                                        <!-- Pagination akan diisi oleh JavaScript -->
                                    </ul>
                                </nav>
                            </div>
                        </div>

                        <!-- Input Data Tab -->
                        <div class="tab-pane fade" id="v-pills-input" role="tabpanel">
                            <h3 class="section-title mb-4"><i class="fas fa-edit me-2"></i> Input Data Nelayan</h3>
                            <form id="inputForm">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="nama" class="form-label">Nama Lengkap</label>
                                        <input type="text" class="form-control" id="nama" placeholder="Masukkan nama lengkap" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="nik" class="form-label">NIK</label>
                                        <input type="text" class="form-control" id="nik" placeholder="Masukkan NIK" required maxlength="16">
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label for="tahun_lahir" class="form-label">Tahun Lahir</label>
                                        <input type="number" class="form-control" id="tahun_lahir" placeholder="Contoh: 1985" required min="1900" max="2025">
                                    </div>
                                    <div class="col-md-8">
                                        <label for="alamat" class="form-label">Alamat Lengkap</label>
                                        <input type="text" class="form-control" id="alamat" placeholder="Masukkan alamat lengkap" required>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="domisili" class="form-label">Domisili</label>
                                        <select class="form-select" id="domisili" required>
                                            <option value="">Pilih domisili</option>
                                            <!-- Opsi akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="wa" class="form-label">Nomor WhatsApp/Telepon</label>
                                        <input type="text" class="form-control" id="wa" placeholder="Contoh: 081234567890" required>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="profesi" class="form-label">Profesi</label>
                                        <select class="form-select" id="profesi" required>
                                            <option value="">Pilih profesi</option>
                                            <option value="Penuh">Nelayan Penuh</option>
                                            <option value="Sambilan Utama">Nelayan Sambilan Utama</option>
                                            <option value="Sambilan Tambahan">Nelayan Sambilan Tambahan</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="status" class="form-label">Status</label>
                                        <select class="form-select" id="status" required>
                                            <option value="">Pilih status</option>
                                            <option value="Pemilik">Pemilik Kapal</option>
                                            <option value="ABK">ABK (Anak Buah Kapal)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="alatTangkap" class="form-label">Alat Penangkapan Ikan (API)</label>
                                        <select class="form-select" id="alatTangkap" required>
                                            <option value="">Pilih alat tangkap</option>
                                            <!-- Opsi akan diisi oleh JavaScript -->
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="usaha" class="form-label">Usaha Sampingan</label>
                                        <input type="text" class="form-control" id="usaha" placeholder="Contoh: Petani, Pedagang, dll">
                                    </div>
                                </div>
                                
                                <!-- Kapal Section (hanya muncul jika status Pemilik) -->
                                <div class="row mb-3" id="kapalSection" style="display: none;">
                                    <div class="col-md-6">
                                        <label for="namaKapal" class="form-label">Nama Kapal</label>
                                        <input type="text" class="form-control" id="namaKapal" placeholder="Masukkan nama kapal">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="jenisKapal" class="form-label">Jenis Kapal</label>
                                        <select class="form-select" id="jenisKapal">
                                            <option value="">Pilih jenis kapal</option>
                                            <option value="Perahu Motor Tempel">Perahu Motor Tempel</option>
                                            <option value="Kapal Motor">Kapal Motor</option>
                                            <option value="Perahu Tanpa Motor">Perahu Tanpa Motor</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Ikan Tangkapan -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <label class="form-label">Jenis Ikan Tangkapan</label>
                                        <div id="ikanContainer">
                                            <!-- Checkbox ikan akan diisi oleh JavaScript -->
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                    <button type="reset" class="btn btn-secondary me-md-2">Reset Form</button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-2"></i> Simpan Data
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Peta Tab -->
                        <div class="tab-pane fade" id="v-pills-map" role="tabpanel">
                            <h3 class="section-title mb-4"><i class="fas fa-map-marked-alt me-2"></i> Peta Sebaran Nelayan</h3>
                            <div id="map-container">
                                <div id="map"></div>
                            </div>
                        </div>

                        <!-- Data Wilayah Tab -->
                        <div class="tab-pane fade" id="v-pills-wilayah" role="tabpanel">
                            <h3 class="section-title mb-4"><i class="fas fa-map-marked-alt me-2"></i> Data Wilayah</h3>
                            <div class="card">
                                <div class="card-header bg-white">
                                    <h5 class="mb-0">Kelola Data Berdasarkan Wilayah</h5>
                                </div>
                                <div class="card-body">
                                    <p>Gunakan fitur ini untuk melihat dan mengelola data nelayan berdasarkan wilayah administratif (Desa/Kecamatan).</p>
                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalDataWilayah">
                                        <i class="fas fa-map-marked-alt me-2"></i> Buka Data Wilayah
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Verifikasi KIN Tab -->
                        <div class="tab-pane fade" id="v-pills-verifikasi" role="tabpanel">
                            <div class="verify-card">
                                <div class="verify-header">
                                    <div class="verify-icon-container">
                                        <i class="fas fa-qrcode"></i>
                                    </div>
                                    <h4 class="fw-bold mb-3">Verifikasi Kartu Identitas Nelayan (KIN)</h4>
                                    <p class="mb-4 opacity-75">Masukkan Kode Identifikasi Nelayan (KIN) untuk memverifikasi keaslian data</p>
                                    
                                    <div class="verify-input-group mb-4">
                                        <input type="text" class="form-control form-control-lg border-0" id="kinCode" placeholder="Masukkan Kode KIN (contoh: KIN-2025-0001)" aria-label="Kode KIN">
                                        <button class="btn btn-primary btn-lg px-4" type="button" id="btnVerifyKIN">
                                            <i class="fas fa-search me-2"></i> Verifikasi
                                        </button>
                                    </div>
                                    
                                    <div class="verify-breadcrumb">
                                        <div class="verify-breadcrumb-item active">
                                            <i class="fas fa-key me-2"></i> Masukkan Kode
                                        </div>
                                        <div class="verify-breadcrumb-item">
                                            <i class="fas fa-user-check me-2"></i> Verifikasi Identitas
                                        </div>
                                        <div class="verify-breadcrumb-item">
                                            <i class="fas fa-id-card me-2"></i> Tampilkan Hasil
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="verify-result-content" id="verifyResult" style="display: none;">
                                    <!-- Hasil verifikasi akan ditampilkan di sini -->
                                </div>
                            </div>
                        </div>

                        <!-- Filter Data Tab -->
                        <div class="tab-pane fade" id="v-pills-filter" role="tabpanel">
                            <h3 class="section-title mb-4"><i class="fas fa-filter me-2"></i> Filter Data</h3>
                            <div class="card">
                                <div class="card-header bg-white">
                                    <h5 class="mb-0">Filter Data Nelayan</h5>
                                </div>
                                <div class="card-body">
                                    <form id="filterForm">
                                        <div class="row g-3">
                                            <div class="col-md-4">
                                                <label for="filterProfesi" class="form-label">Profesi</label>
                                                <select class="form-select" id="filterProfesi">
                                                    <option value="">Semua Profesi</option>
                                                    <option value="Penuh">Nelayan Penuh</option>
                                                    <option value="Sambilan Utama">Nelayan Sambilan Utama</option>
                                                    <option value="Sambilan Tambahan">Nelayan Sambilan Tambahan</option>
                                                </select>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="filterStatus" class="form-label">Status</label>
                                                <select class="form-select" id="filterStatus">
                                                    <option value="">Semua Status</option>
                                                    <option value="Pemilik">Pemilik Kapal</option>
                                                    <option value="ABK">ABK</option>
                                                </select>
                                            </div>
                                            <div class="col-md-4">
                                                <label for="filterDomisili" class="form-label">Domisili</label>
                                                <select class="form-select" id="filterDomisili">
                                                    <option value="">Semua Domisili</option>
                                                    <!-- Opsi akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="filterAlatTangkap" class="form-label">Alat Tangkap</label>
                                                <select class="form-select" id="filterAlatTangkap">
                                                    <option value="">Semua Alat Tangkap</option>
                                                    <!-- Opsi akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="filterIkan" class="form-label">Jenis Ikan</label>
                                                <select class="form-select" id="filterIkan">
                                                    <option value="">Semua Jenis Ikan</option>
                                                    <!-- Opsi akan diisi oleh JavaScript -->
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                                            <button type="reset" class="btn btn-secondary me-md-2">Reset Filter</button>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-filter me-2"></i> Terapkan Filter
                                            </button>
                                        </div>
                                    </form>
                                    
                                    <div class="mt-4">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <h6>Hasil Filter</h6>
                                            <button type="button" class="btn btn-danger btn-sm" id="btnDownloadFilteredPDF">
                                                <i class="fas fa-file-pdf me-1"></i> Unduh PDF
                                            </button>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-sm data-table" id="filterTable">
                                                <thead>
                                                    <tr>
                                                        <th>Nama</th>
                                                        <th>Profesi</th>
                                                        <th>Status</th>
                                                        <th>Alat Tangkap</th>
                                                        <th>Domisili</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="filterTableBody">
                                                    <!-- Data hasil filter akan diisi di sini -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pengaturan Keamanan Tab -->
                        <!-- TAMBAHAN: Pengaturan Keamanan Sistem -->
<div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-warning text-white">
        <h5 class="mb-0"><i class="fas fa-shield-alt me-2"></i>Pengaturan Keamanan Sistem</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card h-100 border">
                    <div class="card-header bg-light">
                        <h6 class="mb-0"><i class="fas fa-keyboard me-2"></i>Keamanan Input Data</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Status Keamanan</label>
                            <div class="d-flex align-items-center">
                                <div class="form-check form-switch me-3">
                                    <input class="form-check-input" type="checkbox" id="inputPasswordToggle">
                                    <label class="form-check-label" for="inputPasswordToggle">
                                        <span id="inputPasswordStatus" class="fw-bold">AKTIF (ON)</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-text">Jika aktif, menu Input Data akan meminta password</div>
                        </div>
                        
                        <form id="inputPasswordForm" class="mt-3">
                            <div class="mb-3">
                                <label for="currentInputPassword" class="form-label">
                                    <i class="fas fa-lock me-1"></i>Password Saat Ini
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="currentInputPassword" placeholder="Masukkan password saat ini" required>
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('currentInputPassword', 'toggleCurrentInputPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleCurrentInputPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="newInputPassword" class="form-label">
                                    <i class="fas fa-key me-1"></i>Password Baru
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="newInputPassword" placeholder="Masukkan password baru (min. 6 karakter)" required minlength="6">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('newInputPassword', 'toggleNewInputPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleNewInputPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="confirmInputPassword" class="form-label">
                                    <i class="fas fa-key me-1"></i>Konfirmasi Password Baru
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="confirmInputPassword" placeholder="Konfirmasi password baru" required minlength="6">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('confirmInputPassword', 'toggleConfirmInputPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleConfirmInputPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-warning text-white">
                                <i class="fas fa-save me-1"></i>Perbarui Password
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 mb-4">
                <div class="card h-100 border">
                    <div class="card-header bg-light">
                        <h6 class="mb-0"><i class="fas fa-database me-2"></i>Keamanan Data Nelayan</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Status Keamanan</label>
                            <div class="d-flex align-items-center">
                                <div class="form-check form-switch me-3">
                                    <input class="form-check-input" type="checkbox" id="dataMenuPasswordToggle">
                                    <label class="form-check-label" for="dataMenuPasswordToggle">
                                        <span id="dataMenuPasswordStatus" class="fw-bold">AKTIF (ON)</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-text">Jika aktif, menu Data Nelayan akan meminta password</div>
                        </div>
                        
                        <form id="dataMenuPasswordForm" class="mt-3">
                            <div class="mb-3">
                                <label for="currentDataMenuPassword" class="form-label">
                                    <i class="fas fa-lock me-1"></i>Password Saat Ini
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="currentDataMenuPassword" placeholder="Masukkan password saat ini" required>
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('currentDataMenuPassword', 'toggleCurrentDataMenuPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleCurrentDataMenuPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="newDataMenuPassword" class="form-label">
                                    <i class="fas fa-key me-1"></i>Password Baru
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="newDataMenuPassword" placeholder="Masukkan password baru (min. 6 karakter)" required minlength="6">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('newDataMenuPassword', 'toggleNewDataMenuPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleNewDataMenuPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="confirmDataMenuPassword" class="form-label">
                                    <i class="fas fa-key me-1"></i>Konfirmasi Password Baru
                                </label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="confirmDataMenuPassword" placeholder="Konfirmasi password baru" required minlength="6">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('confirmDataMenuPassword', 'toggleConfirmDataMenuPasswordIcon')">
                                        <i class="fas fa-eye" id="toggleConfirmDataMenuPasswordIcon"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-info text-white">
                                <i class="fas fa-save me-1"></i>Perbarui Password
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="alert alert-info mt-3">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Informasi:</strong> Password default untuk Input Data adalah <code>666666</code> dan untuk Data Nelayan adalah <code>999999</code>. Dianjurkan untuk mengubah password default setelah pertama kali login.
        </div>
    </div>
</div>
                        
                        <div class="tab-pane fade" id="v-pills-keamanan" role="tabpanel">
                            <h3 class="section-title mb-4"><i class="fas fa-user-shield me-2"></i> Pengaturan Keamanan</h3>
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                Pengaturan keamanan ini memungkinkan Anda mengatur kode akses untuk fitur input data dan data nelayan.
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <div class="card h-100 border-0 shadow-sm">
                                        <div class="card-header bg-white">
                                            <h6 class="mb-0"><i class="fas fa-edit me-2 text-primary"></i> Keamanan Input Data</h6>
                                        </div>
                                        <div class="card-body">
                                            <p class="small text-muted">Atur kode keamanan untuk mengakses menu Input Data Nelayan.</p>
                                            <div class="d-grid">
                                                <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalPengaturanKeamanan" onclick="showSecuritySection('input')">
                                                    <i class="fas fa-cog me-2"></i> Atur Kode Input Data
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-4">
                                    <div class="card h-100 border-0 shadow-sm">
                                        <div class="card-header bg-white">
                                            <h6 class="mb-0"><i class="fas fa-database me-2 text-success"></i> Keamanan Data Menu</h6>
                                        </div>
                                        <div class="card-body">
                                            <p class="small text-muted">Atur kode keamanan untuk mengakses menu Data Nelayan.</p>
                                            <div class="d-grid">
                                                <button type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#modalPengaturanKeamanan" onclick="showSecuritySection('data')">
                                                    <i class="fas fa-cog me-2"></i> Atur Kode Data Menu
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card border-0 shadow-sm">
                                <div class="card-header bg-white">
                                    <h6 class="mb-0"><i class="fas fa-history me-2 text-warning"></i> Riwayat Akses Keamanan</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Waktu</th>
                                                    <th>Aktivitas</th>
                                                    <th>IP Address</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="securityLogTable">
                                                <!-- Riwayat keamanan akan diisi di sini -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="fab-container" id="fabContainer">
            <a href="#" class="fab-item" id="fabRefresh" title="Refresh Data">
                <i class="fas fa-sync-alt"></i>
            </a>
            <a href="#" class="fab-item" id="fabPrint" title="Cetak Laporan">
                <i class="fas fa-print"></i>
            </a>
            <a href="#" class="fab-item" id="fabHelp" title="Bantuan">
                <i class="fas fa-question-circle"></i>
            </a>
            <button class="fab-main" id="fabMain">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        
        <!-- Sticky Warning -->
        <div class="sticky-warning" id="stickyWarning">
            <div class="d-flex align-items-start">
                <i class="fas fa-exclamation-triangle text-danger me-2 mt-1"></i>
                <div>
                    <strong>Peringatan!</strong>
                    <p class="mb-0 small" id="warningMessage">Data belum disimpan. Harap simpan perubahan Anda.</p>
                </div>
                <button type="button" class="btn-close ms-auto" id="closeWarning"></button>
            </div>
        </div>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="container">
                <h5 class="footer-brand">SISTEM MANAJEMEN & PEMETAAN DATA PEMBERDAYAAN NELAYAN TANGKAP</h5>
                <div class="footer-text">
                    &copy; 2025 Bidang Pemberdayaan Nelayan <span class="footer-divider">|</span> Dinas Perikanan Kabupaten Situbondo
                </div>
                <div class="footer-links">
                    <a href="#" style="pointer-events: none;">
                        <i class="fas fa-phone-alt me-1"></i> Contact Center: 0878-6561-4222
                    </a>
                    <span class="footer-divider">|</span>
                    <a href="mailto:info@dinasperikanansitubondo.com">
                        <i class="fas fa-envelope me-1"></i> info@dinasperikanansitubondo.com
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modal Detail Data -->
    <div class="modal fade" id="detailModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title fw-bold"><i class="fas fa-id-card me-2"></i>DETAIL LENGKAP NELAYAN</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4 bg-light">
                    <div class="card border-0 shadow-sm mb-3">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 border-end">
                                    <h6 class="text-primary fw-bold mb-3">IDENTITAS PRIBADI</h6>
                                    <div class="detail-label">Nama Lengkap</div>
                                    <div class="detail-value" id="d_nama">-</div>
                                    <div class="detail-label">NIK (Nomori Induk Kependudukan)</div>
                                    <div class="detail-value font-monospace" id="d_nik">  </div>
                                    <div class="detail-label">Usia / Tahun Lahir</div>
                                    <div class="detail-value" id="d_usia">-</div>
                                    <div class="detail-label">Alamat Lengkap</div>
                                    <div class="detail-value" id="d_alamat">-</div>
                                    <div class="detail-label">Domisili</div>
                                    <div class="detail-value" id="d_domisili">-</div>
                                    <div class="detail-label">Kontak (WhatsApp/Telp)</div>
                                    <div class="detail-value font-monospace" id="d_wa">-</div>
                                </div>
                                <div class="col-md-6 ps-md-4 mt-3 mt-md-0">
                                    <h6 class="text-primary fw-bold mb-3">PROFESI & KEPEMILIKAN</h6>
                                    <div class="detail-label">Profesi</div>
                                    <div class="detail-value"><span id="d_profesi" class="badge bg-primary"></span></div>
                                    <div class="detail-label">Status</div>
                                    <div class="detail-value" id="d_status">-</div>
                                    <div class="detail-label">Alat Penangkapan Ikan (API)</div>
                                    <div class="detail-value" id="d_alatTangkap">-</div>
                                    <div class="detail-label">Usaha Sampingan</div>
                                    <div class="detail-value" id="d_usaha">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card border-0 shadow-sm mb-3" id="d_kapal_card" style="display:none;">
                        <div class="card-body bg-white border-left border-4 border-info">
                            <h6 class="text-info fw-bold mb-3"><i class="fas fa-ship me-2"></i>DATA KAPAL DIMILIKI</h6>
                            <div class="row">
                                <div class="col-6">
                                    <div class="detail-label">Nama Kapal</div>
                                    <div class="fw-bold" id="d_namaKapal">.</div>
                                </div>
                                <div class="col-6">
                                    <div class="detail-label">Jenis Kapal</div>
                                    <div class="fw-bold"><span id="d_jenisKapal"> -</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card border-0 shadow-sm mb-3">
                        <div class="card-body bg-white border-left border-4 border-success">
                            <h6 class="text-success fw-bold mb-3"><i class="fas fa-fish me-2"></i>JENIS IKAN TANGKAPAN</h6>
                            <div id="d_ikan"></div>
                        </div>
                    </div>

                    <div class="text-end text-muted small fst-italic">
                        Terakhir divalidasi: <span id="d_tgl_valid">-</span> oleh <span id="d_validator">-</span>
                    </div>
                </div>
                <div class="modal-footer bg-white">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-danger" id="btnDownloadDetailPdf"><i class="fas fa-file-pdf me-2"></i>UNDUH DOKUMEN (PDF)</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading untuk ID Card -->
    <div class="idcard-loading" id="idcardLoading">
        <div class="idcard-loading-content">
            <div class="spinner-border text-primary mb-3" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <h6>Membuat ID Card...</h6>
            <p class="small text-muted">Harap tunggu sebentar</p>
        </div>
    </div>

    <!-- Modal Kode Keamanan Input Data -->
    <div class="modal fade" id="modalInputCode" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title fw-bold"><i class="fas fa-key me-2"></i>Kode Keamanan Input Data</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Masukkan kode keamanan untuk mengakses fitur Input Data Nelayan.
                    </div>
                    <form id="inputCodeFormModal">
                        <div class="mb-3">
                            <label for="inputCode" class="form-label">Kode Keamanan</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="inputCode" placeholder="Masukkan kode keamanan" required>
                                <button type="button" class="btn btn-outline-secondary" id="toggleInputCode">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <small class="text-muted">Kode ini diatur di menu Pengaturan Keamanan.</small>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-unlock me-2"></i> Buka Akses
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Kode Keamanan Data Menu -->
    <div class="modal fade" id="modalDataCode" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title fw-bold"><i class="fas fa-database me-2"></i>Kode Keamanan Data Menu</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Masukkan kode keamanan untuk mengakses menu Data Nelayan.
                    </div>
                    <form id="dataCodeFormModal">
                        <div class="mb-3">
                            <label for="dataCode" class="form-label">Kode Keamanan</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="dataCode" placeholder="Masukkan kode keamanan" required>
                                <button type="button" class="btn btn-outline-secondary" id="toggleDataCode">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <small class="text-muted">Kode ini diatur di menu Pengaturan Keamanan.</small>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-unlock me-2"></i> Buka Akses
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Script untuk memanipulasi DOM setelah halaman dimuat -->
    <script>
        // Fungsi untuk menampilkan bagian keamanan tertentu di modal
        function showSecuritySection(section) {
            if (section === 'input') {
                // Scroll ke bagian input code form
                document.getElementById('currentInputCode').scrollIntoView({ behavior: 'smooth' });
            } else if (section === 'data') {
                // Scroll ke bagian data menu code form
                document.getElementById('currentDataMenuCode').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // Fungsi untuk toggle password visibility
        function setupPasswordToggles() {
            // Toggle untuk modal input code
            const toggleInputCode = document.getElementById('toggleInputCode');
            const inputCode = document.getElementById('inputCode');
            
            if (toggleInputCode && inputCode) {
                toggleInputCode.addEventListener('click', function() {
                    const type = inputCode.getAttribute('type') === 'password' ? 'text' : 'password';
                    inputCode.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            // Toggle untuk modal data code
            const toggleDataCode = document.getElementById('toggleDataCode');
            const dataCode = document.getElementById('dataCode');
            
            if (toggleDataCode && dataCode) {
                toggleDataCode.addEventListener('click', function() {
                    const type = dataCode.getAttribute('type') === 'password' ? 'text' : 'password';
                    dataCode.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            // Toggle untuk form pengaturan keamanan
            const toggles = [
                { btn: 'toggleCurrentInputCode', input: 'currentInputCode' },
                { btn: 'toggleNewInputCode', input: 'newInputCode' },
                { btn: 'toggleConfirmInputCode', input: 'confirmInputCode' },
                { btn: 'toggleCurrentDataMenuCode', input: 'currentDataMenuCode' },
                { btn: 'toggleNewDataMenuCode', input: 'newDataMenuCode' },
                { btn: 'toggleConfirmDataMenuCode', input: 'confirmDataMenuCode' }
            ];
            
            toggles.forEach(item => {
                const btn = document.getElementById(item.btn);
                const input = document.getElementById(item.input);
                
                if (btn && input) {
                    btn.addEventListener('click', function() {
                        const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                        input.setAttribute('type', type);
                        this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                    });
                }
            });
        }
        
        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            setupPasswordToggles();
            
            // Tampilkan tanggal saat ini di login form
            const currentDate = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDateDisplay').textContent = currentDate.toLocaleDateString('id-ID', options);
        });
    </script>

</body>
</html>
