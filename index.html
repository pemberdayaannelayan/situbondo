<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Bidang Pemberdayaan Nelayan - Dinas Perikanan Situbondo</title>
    <meta name="description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMATA, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta name="keywords" content="Dinas Perikanan Situbondo, SIMATA Situbondo, Peta Nelayan, Pemberdayaan Nelayan, Kartu KUSUKA, Bantuan Kapal, Pengaduan Nelayan, Layanan Nelayan">
    <meta name="author" content="Dinas Perikanan Situbondo">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#0284c7">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.dinasperikanansitubondo.com/">
    <meta property="og:title" content="Layanan Pemberdayaan Nelayan - Situbondo">
    <meta property="og:description" content="Akses mudah data KUSUKA, SIMATA, Bantuan Sarpras, dan Saluran Aspirasi Masyarakat Pesisir Situbondo.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS untuk peta -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Chart.js untuk statistik -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Satisfy&display=swap" rel="stylesheet">
    
    <!-- Font Awesome & AOS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            /* Palette Warna Laut Cerah & Profesional */
            --primary: #1a237e;
            --primary-dark: #0c4a6e;
            --secondary: #283593;
            --accent: #1976d2;
            --accent-dark: #1565c0;
            --success-color: #06d6a0;
            --warning-color: #ffd166;
            --danger-color: #ff6b6b;
            --light-bg: #f0f9ff;
            --white: #ffffff;
            
            --text-main: #0f172a;
            --text-sub: #475569;
            --gray-color: #666;

            --font-head: 'Outfit', sans-serif;
            --font-body: 'Plus Jakarta Sans', sans-serif;
            --font-signature: 'Satisfy', cursive;
            
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-sub);
            background-color: var(--light-bg);
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        h1, h2, h3, h4, h5, .navbar-brand {
            font-family: var(--font-head);
            color: var(--text-main);
        }

        /* --- CSS untuk Slogan Signatur (Pemberdayaan Nelayan) --- */
        .slogan-signature {
            font-family: var(--font-signature);
            color: var(--primary);
            font-size: calc(2rem + 1vw); 
            font-weight: 700; 
            line-height: 1.2;
            margin-bottom: 10px;
            display: inline-block;
        }

        /* --- CSS Revisi untuk kata 'untuk' (Kecil & Bersih) --- */
        .connector-text {
            font-family: var(--font-body);
            font-size: 0.5em;
            font-weight: 400;
            font-style: italic;
            color: var(--text-sub);
            vertical-align: middle;
            margin: 0 5px;
            letter-spacing: 1px;
        }

        /* --- CSS Revisi untuk 'Situbondo Naik Kelas' (Orange) --- */
        .text-orange-gradient {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            text-shadow: 0px 4px 10px rgba(245, 158, 11, 0.2);
        }

        /* --- Navbar (Clean & Glassy) --- */
        .navbar {
            padding: 10px 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .navbar-brand img {
            height: 55px; 
            width: auto;
            object-fit: contain;
            transition: transform 0.3s;
        }

        .navbar-brand:hover img {
            transform: scale(1.05);
        }

        .brand-text h5 {
            font-weight: 800;
            margin: 0;
            line-height: 1;
            color: var(--primary-dark);
            letter-spacing: -0.5px;
        }
        .brand-text span {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .nav-link {
            font-weight: 600;
            color: var(--text-main) !important;
            margin: 0 10px;
            position: relative;
            transition: 0.3s;
            padding: 8px 12px !important;
        }

        .nav-link:hover {
            color: var(--primary) !important;
        }

        .nav-link.active {
            color: var(--primary) !important;
            font-weight: 700;
        }

        .btn-cta {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 10px 30px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(2, 132, 199, 0.3);
            transition: 0.3s;
            min-height: 44px;
            min-width: 44px;
        }
        
        .btn-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(2, 132, 199, 0.4);
            color: white;
        }

        /* --- Hero Section --- */
        .hero-section {
            min-height: 100vh;
            background: url('https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            display: flex;
            align-items: center;
            padding-top: 140px; 
            padding-bottom: 80px;
        }

        .hero-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to right, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.7) 60%, rgba(255,255,255,0) 100%);
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-badge {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border: 1px solid var(--primary);
            color: var(--primary-dark);
            padding: 10px 24px;
            border-radius: 30px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        /* --- ANIMASI TOMBOL --- */
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(2, 132, 199, 0); }
            100% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0); }
        }

        .btn-pulse-primary {
            animation: pulse-glow 2s infinite;
        }

        .btn-pulse-outline {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            min-height: 44px;
            min-width: 44px;
        }
        
        .btn-pulse-outline:hover {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 0 20px rgba(2, 132, 199, 0.5);
        }

        /* --- Service Cards --- */
        .section-header h2 {
            font-weight: 800;
            color: var(--primary-dark);
        }
        
        .service-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            border: 1px solid rgba(2, 132, 199, 0.1); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
            transition: all 0.4s ease;
            height: 100%;
            position: relative;
            display: block;
            text-decoration: none !important;
            color: inherit;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .service-card:hover {
            text-decoration: none !important;
            color: inherit;
        }

        .service-card::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            transform: scaleX(0);
            transform-origin: left;
            transition: 0.4s;
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(2, 132, 199, 0.15);
            text-decoration: none !important;
        }

        .service-card:hover::after {
            transform: scaleX(1);
        }

        /* --- LOGO LANGSUNG DI MENU (TANPA ICON BOX) --- */
        .menu-logo {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin: 0 auto 25px auto;
            display: block;
            transition: transform 0.4s ease;
        }

        .service-card:hover .menu-logo {
            transform: scale(1.1);
        }

        .card-link-text {
            color: var(--primary);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: auto; 
            padding-top: 20px;
        }

        /* --- Galeri Foto Thumbnail Styles --- */
        .gallery-thumbnail-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin-top: 20px;
            margin-bottom: 20px;
            height: 180px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .gallery-thumbnail-item {
            position: relative;
            overflow: hidden;
            border-radius: 5px;
            transition: transform 0.3s ease;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .gallery-thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .gallery-thumbnail-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 132, 199, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-thumbnail-item:hover .gallery-overlay {
            opacity: 1;
        }

        /* --- LOGO PEMBERDAYAAN NELAYAN DI INFO PANEL --- */
        .info-panel-logo {
            width: 180px;
            height: auto;
            margin: 0 auto 25px auto;
            display: block;
        }

        /* ============================================ */
        /* PERBAIKAN DESAIN PETA STATISTIK UNTUK MOBILE */
        /* ============================================ */
        
        /* Header Peta - Desain Baru */
        .peta-statistik-header {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: white;
            padding: 25px 40px;
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid #f59e0b;
        }
        
        .header-content {
            position: relative;
            z-index: 2;
        }
        
        .header-bg {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 40%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: cover;
            opacity: 0.5;
        }
        
        /* Judul Peta - Warna dan Font Diperbaiki */
        .peta-statistik-title {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            font-weight: 800;
        }
        
        .peta-statistik-title i {
            color: #f59e0b;
            font-size: 2.5rem;
            text-shadow: 0 0 15px rgba(245, 158, 11, 0.5);
        }
        
        .peta-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
            max-width: 800px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 400;
        }
        
        /* Metadata - Desain Baru */
        .metadata {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .meta-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .meta-item:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .meta-item i {
            font-size: 1.1rem;
            color: #f59e0b;
        }
        
        /* Container Utama Peta */
        .peta-statistik-container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            animation: fadeIn 0.8s ease-out;
            border: 1px solid #e2e8f0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Sidebar - Warna Diperbaiki */
        .peta-sidebar {
            flex: 1;
            min-width: 350px;
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 25px;
            border-right: 1px solid #e2e8f0;
            overflow-y: auto;
            max-height: 800px;
        }
        
        /* Tab Menu - Desain Baru */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e2e8f0;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px 12px 0 0;
            overflow: hidden;
            padding: 5px;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            font-weight: 700;
            color: #64748b;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            font-size: 0.9rem;
            flex: 1;
            text-align: center;
            border-radius: 8px;
            -webkit-tap-highlight-color: transparent;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--accent);
            background: rgba(25, 118, 210, 0.1);
        }
        
        .tab:hover {
            color: var(--primary);
            background: rgba(25, 118, 210, 0.05);
        }
        
        /* Kotak Statistik - Desain Baru */
        .stats-box {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
            transition: var(--transition);
        }
        
        .stats-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .stats-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f1f5f9;
            font-weight: 700;
        }
        
        .stats-title i {
            color: #f59e0b;
        }
        
        /* Grid Statistik */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 20px 12px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--accent), var(--primary));
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
            background: #e8eeff;
            box-shadow: 0 10px 20px rgba(25, 118, 210, 0.15);
            border-color: var(--accent);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
            font-family: var(--font-head);
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: var(--gray-color);
            font-weight: 600;
        }
        
        /* Daftar Desa - Desain Baru */
        .desa-list {
            max-height: 350px;
            overflow-y: auto;
            border-radius: 12px;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            -webkit-overflow-scrolling: touch;
        }
        
        .desa-list-header {
            padding: 15px 20px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            font-size: 0.9rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .desa-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
            -webkit-tap-highlight-color: transparent;
            min-height: 60px;
        }
        
        .desa-item:hover {
            background: #f8fafc;
            padding-left: 25px;
        }
        
        .desa-item.active {
            background: #e8eeff;
            border-left: 5px solid var(--accent);
        }
        
        .desa-name {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 0.95rem;
        }
        
        .desa-details {
            font-size: 0.8rem;
            color: var(--gray-color);
            display: flex;
            gap: 12px;
        }
        
        /* Container Peta - FIX UNTUK MOBILE */
        .peta-map-container {
            flex: 2;
            min-width: 600px;
            height: 700px;
            position: relative;
            background: #f8fafc;
        }
        
        #statistikMap {
            width: 100%;
            height: 100%;
            border-radius: 0 0 20px 0;
            z-index: 1;
        }
        
        /* Kontrol Peta - Desain Baru dengan TOMBOL BARU */
        .peta-controls {
            position: absolute;
            top: 25px;
            right: 25px;
            z-index: 1000;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }
        
        .control-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            transition: var(--transition);
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 44px;
            min-width: 44px;
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
        }
        
        .control-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
            color: white;
            text-decoration: none;
        }
        
        .control-btn i {
            font-size: 1.1rem;
        }
        
        /* Tombol Khusus untuk Cek Detail Data Peta */
        .btn-detail-peta {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .btn-detail-peta:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
        }
        
        /* Legend Peta - Desain Baru */
        .peta-legend {
            position: absolute;
            bottom: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 250px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .legend-title {
            font-weight: bold;
            margin-bottom: 12px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .legend-title i {
            color: #f59e0b;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            border: 3px solid white;
            box-shadow: 0 0 8px rgba(0,0,0,0.2);
        }
        
        .legend-label {
            font-size: 0.85rem;
            color: var(--text-sub);
            font-weight: 500;
        }
        
        /* Footer Peta - DESAIN BARU DENGAN FORMAT TEKS YANG LEBIH BAIK */
        .peta-footer {
            text-align: center;
            padding: 25px;
            background: linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%);
            color: var(--text-sub);
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .peta-footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .peta-footer-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: bold;
            color: var(--primary);
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.7);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid rgba(25, 118, 210, 0.2);
        }
        
        .peta-footer-logo i {
            color: #f59e0b;
            font-size: 1.2rem;
        }
        
        /* PERBAIKAN FORMAT TEKS FOOTER - DESAIN BARU */
        .footer-info-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 12px 20px;
            border-radius: 10px;
            border: 1px solid rgba(25, 118, 210, 0.1);
            margin: 5px 0;
            transition: var(--transition);
        }
        
        .footer-info-item:hover {
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transform: translateY(-3px);
        }
        
        /* PERBAIKAN KHUSUS UNTUK TEKS VERSI APLIKASI - MENGGANTI SIMBOL </> DENGAN ICON YANG LEBIH BAIK */
        .app-version {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 800;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .last-update {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Auto Update Info */
        .auto-update-info {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 0.85rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            border: 1px solid #e2e8f0;
            font-weight: 600;
        }
        
        .auto-update-info i {
            color: #f59e0b;
        }
        
        /* Chart Container - WARNA DIPERBAIKI */
        .chart-container {
            height: 180px;
            margin-top: 15px;
            position: relative;
        }
        
        /* Search Box */
        .search-box {
            margin-bottom: 20px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 14px 18px 14px 50px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: white;
            color: var(--text-main);
            min-height: 44px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(25, 118, 210, 0.15);
        }
        
        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-color);
            font-size: 1.1rem;
        }
        
        /* Loading Screen */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.98);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            width: 70px;
            height: 70px;
            border: 6px solid #f0f0f0;
            border-top: 6px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 10000;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease-out;
            max-width: 400px;
            font-size: 0.9rem;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Detail Modal */
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: 15px;
        }
        
        .detail-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .detail-modal .modal-content {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.3s ease-out;
            -webkit-overflow-scrolling: touch;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .detail-modal .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .detail-modal .modal-header h3 {
            margin: 0;
            color: var(--primary);
            font-size: 1.4rem;
        }
        
        .detail-modal .modal-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--gray-color);
            cursor: pointer;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            min-width: 44px;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
        }
        
        .detail-modal .modal-close:hover {
            background: #f1f5f9;
            color: var(--primary);
        }
        
        .detail-modal .modal-body {
            padding: 25px;
            -webkit-overflow-scrolling: touch;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }
        
        .detail-item-title {
            font-size: 0.9rem;
            color: var(--gray-color);
            margin-bottom: 5px;
        }
        
        .detail-item-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        /* ============================================ */
        /* PERBAIKAN UTAMA UNTUK RESPONSIVE MOBILE */
        /* ============================================ */
        
        /* Layout utama untuk mobile */
        .peta-content {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
        }
        
        @media (max-width: 1200px) {
            .peta-content {
                flex-direction: column;
            }
            
            .peta-sidebar, .peta-map-container {
                min-width: 100%;
                width: 100%;
            }
            
            #statistikMap {
                border-radius: 0;
            }
            
            .peta-footer-content {
                flex-direction: column;
                text-align: center;
                gap: 25px;
            }
        }
        
        /* PERBAIKAN KHUSUS UNTUK TABLET */
        @media (max-width: 991px) {
            .peta-map-container {
                height: 500px;
                min-width: 100%;
                order: 1;
            }
            
            .peta-sidebar {
                min-width: 100%;
                max-height: 500px;
                order: 2;
            }
            
            .peta-controls {
                flex-direction: row;
                top: 15px;
                right: 15px;
                gap: 8px;
                flex-wrap: wrap;
                justify-content: flex-end;
            }
            
            .control-btn {
                padding: 10px 14px;
                font-size: 0.85rem;
                min-height: 40px;
                min-width: 40px;
            }
            
            .peta-legend {
                bottom: 15px;
                right: 15px;
                left: 15px;
                max-width: none;
                padding: 15px;
            }
            
            .auto-update-info {
                bottom: 15px;
                left: 15px;
                right: 15px;
                justify-content: center;
                text-align: center;
                padding: 10px 15px;
            }
            
            .desa-list {
                max-height: 300px;
            }
        }
        
        /* PERBAIKAN KHUSUS UNTUK SMARTPHONE (768px ke bawah) */
        @media (max-width: 768px) {
            .peta-statistik-title {
                font-size: 1.6rem;
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .peta-statistik-title i {
                font-size: 1.8rem;
            }
            
            .peta-subtitle {
                font-size: 1rem;
                line-height: 1.4;
            }
            
            .peta-statistik-header {
                padding: 20px 15px;
            }
            
            .metadata {
                flex-direction: column;
                gap: 10px;
            }
            
            .meta-item {
                width: 100%;
                justify-content: flex-start;
                padding: 10px 15px;
                font-size: 0.85rem;
            }
            
            /* Layout utama untuk mobile - sidebar di atas, peta di bawah */
            .peta-content {
                flex-direction: column;
            }
            
            .peta-map-container {
                height: 400px;
                min-height: 400px;
                order: 2;
            }
            
            .peta-sidebar {
                order: 1;
                max-height: none;
                padding: 20px 15px;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
            
            #statistikMap {
                height: 400px;
                border-radius: 0;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-value {
                font-size: 1.6rem;
            }
            
            .stat-label {
                font-size: 0.75rem;
            }
            
            /* Tabs untuk mobile */
            .tabs {
                flex-direction: row;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding: 5px 0;
            }
            
            .tab {
                padding: 12px 10px;
                font-size: 0.85rem;
                min-width: 100px;
                white-space: nowrap;
                flex-shrink: 0;
            }
            
            /* Kontrol peta untuk mobile */
            .peta-controls {
                top: 10px;
                right: 10px;
                left: 10px;
                flex-direction: row;
                justify-content: space-between;
                gap: 5px;
            }
            
            .control-btn {
                padding: 8px 12px;
                font-size: 0.75rem;
                flex: 1;
                min-height: 36px;
                justify-content: center;
                text-align: center;
            }
            
            .control-btn i {
                font-size: 0.9rem;
                margin-right: 4px;
            }
            
            /* Legend untuk mobile */
            .peta-legend {
                position: relative;
                bottom: auto;
                right: auto;
                left: auto;
                max-width: 100%;
                margin: 15px;
                padding: 15px;
                border-radius: 10px;
            }
            
            .auto-update-info {
                position: relative;
                bottom: auto;
                left: auto;
                right: auto;
                margin: 15px;
                justify-content: center;
            }
            
            /* Daftar desa untuk mobile */
            .desa-list {
                max-height: 250px;
            }
            
            .desa-item {
                padding: 12px 15px;
                min-height: 55px;
            }
            
            .desa-name {
                font-size: 0.9rem;
            }
            
            .desa-details {
                font-size: 0.75rem;
                flex-direction: column;
                gap: 5px;
            }
            
            /* Stats box untuk mobile */
            .stats-box {
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            
            .stats-title {
                font-size: 1.1rem;
            }
            
            /* Chart untuk mobile */
            .chart-container {
                height: 150px;
            }
            
            /* Search box untuk mobile */
            .search-input {
                padding: 12px 15px 12px 45px;
                font-size: 0.9rem;
            }
            
            .search-icon {
                left: 15px;
            }
            
            /* Footer untuk mobile */
            .peta-footer {
                padding: 20px 15px;
            }
            
            .footer-info-item {
                margin: 8px 0;
                padding: 10px 15px;
                font-size: 0.85rem;
            }
            
            .app-version, .last-update {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
            
            /* Detail modal untuk mobile */
            .detail-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .detail-modal .modal-content {
                width: 100%;
                margin: 0;
                max-height: 85vh;
            }
            
            .detail-modal .modal-header {
                padding: 15px 20px;
            }
            
            .detail-modal .modal-body {
                padding: 20px;
            }
            
            .detail-item {
                padding: 12px;
            }
            
            .detail-item-value {
                font-size: 1rem;
            }
            
            /* FIX untuk mencegah zoom pada input di mobile */
            input, select, textarea {
                font-size: 16px;
            }
        }
        
        /* PERBAIKAN UNTUK SMARTPHONE KECIL (576px ke bawah) */
        @media (max-width: 576px) {
            .peta-statistik-title {
                font-size: 1.4rem;
            }
            
            .peta-subtitle {
                font-size: 0.95rem;
            }
            
            .peta-map-container {
                height: 350px;
                min-height: 350px;
            }
            
            #statistikMap {
                height: 350px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .stat-item {
                padding: 15px 10px;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
            
            .control-btn {
                padding: 8px 10px;
                font-size: 0.7rem;
                min-height: 34px;
            }
            
            .control-btn i {
                font-size: 0.8rem;
                margin-right: 3px;
            }
            
            .tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }
            
            .tabs::-webkit-scrollbar {
                display: none;
            }
            
            .tab {
                padding: 10px 8px;
                font-size: 0.8rem;
                min-width: 90px;
            }
            
            .peta-controls {
                gap: 5px;
            }
            
            .desa-list {
                max-height: 200px;
            }
            
            .desa-item {
                padding: 10px 12px;
                min-height: 50px;
            }
            
            .chart-container {
                height: 130px;
            }
            
            /* Perbaikan untuk teks yang terlalu panjang */
            .desa-name, .meta-item, .footer-info-item {
                word-break: break-word;
            }
        }
        
        /* PERBAIKAN UNTUK SMARTPHONE SANGAT KECIL (400px ke bawah) */
        @media (max-width: 400px) {
            .peta-map-container {
                height: 300px;
                min-height: 300px;
            }
            
            #statistikMap {
                height: 300px;
            }
            
            .peta-statistik-header {
                padding: 15px 12px;
            }
            
            .peta-statistik-title {
                font-size: 1.2rem;
            }
            
            .peta-subtitle {
                font-size: 0.9rem;
            }
            
            .meta-item {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .control-btn {
                padding: 6px 8px;
                font-size: 0.65rem;
                min-height: 32px;
            }
            
            .control-btn i {
                font-size: 0.75rem;
                margin-right: 2px;
            }
            
            .tab {
                padding: 8px 6px;
                font-size: 0.75rem;
                min-width: 80px;
            }
            
            .stats-box {
                padding: 15px 12px;
            }
            
            .stats-title {
                font-size: 1rem;
            }
            
            .stat-value {
                font-size: 1.6rem;
            }
            
            .desa-list {
                max-height: 180px;
            }
            
            /* Perbaikan untuk layout vertikal pada kontrol yang sangat kecil */
            .peta-controls {
                flex-direction: column;
                align-items: flex-end;
                gap: 5px;
            }
            
            .control-btn {
                width: auto;
                min-width: 120px;
            }
        }

        /* --- Form Section --- */
        .aduan-section {
            padding: 100px 0;
            background-color: white; 
            position: relative;
        }

        .form-container {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08); 
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .info-panel {
            background: linear-gradient(160deg, var(--primary-dark) 0%, var(--primary) 100%);
            padding: 50px;
            color: white;
            position: relative;
        }

        .info-panel h3 { color: white !important; }
        .info-panel p { color: rgba(255,255,255,0.8); }

        .form-panel {
            padding: 50px;
            background-color: white;
        }

        .form-label {
            color: var(--text-main); 
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .form-control {
            background-color: #f8fafc;
            border: 2px solid #cbd5e1;
            color: #334155;
            padding: 12px 15px;
            border-radius: 10px;
            font-weight: 500;
            min-height: 44px;
        }

        .form-control:focus {
            background-color: white;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(2, 132, 199, 0.1);
            color: #000;
        }
        
        .form-control::placeholder {
            color: #94a3b8;
        }

        .btn-wa {
            background-color: #25D366;
            color: white;
            font-weight: 700;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
            transition: 0.3s;
            min-height: 44px;
        }
        .btn-wa:hover {
            background-color: #1ebc57;
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
            color: white;
        }

        /* --- Peta Section --- */
        .peta-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }

        /* --- Lightbox Modal Styles --- */
        .lightbox-modal .modal-dialog {
            max-width: 95%;
            max-height: 95vh;
            margin: 10px auto;
        }

        .lightbox-modal .modal-content {
            background: rgba(0, 0, 0, 0.9);
            border: none;
            border-radius: 10px;
            overflow: hidden;
        }

        .lightbox-modal .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
        }

        .lightbox-modal .modal-title {
            color: white;
            font-size: 1.2rem;
        }

        .lightbox-modal .btn-close {
            background-color: white;
            opacity: 1;
            padding: 8px;
            border-radius: 50%;
            min-width: 44px;
            min-height: 44px;
        }

        .lightbox-modal .modal-body {
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            max-height: 70vh;
            overflow: hidden;
        }

        .lightbox-modal .lightbox-image {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 5px;
        }

        .lightbox-modal .modal-footer {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lightbox-nav {
            display: flex;
            gap: 10px;
        }

        .lightbox-nav-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            min-width: 44px;
            min-height: 44px;
        }

        .lightbox-nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .lightbox-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .lightbox-zoom-controls {
            display: flex;
            gap: 10px;
        }

        .lightbox-counter {
            color: white;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }

        /* --- Footer --- */
        footer {
            background-color: var(--primary-dark);
            color: #cbd5e1;
            padding-top: 0;
            position: relative;
            margin-top: 50px;
        }

        .footer-wave {
            line-height: 0;
            width: 100%;
            background-color: white; 
        }
        .footer-wave svg {
            display: block;
            width: 100%;
            height: 60px;
            fill: var(--primary-dark);
        }

        .footer-content {
            padding: 60px 0 40px;
        }

        footer h5 {
            color: white;
            font-weight: 700;
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
        }

        footer h5::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -8px;
            width: 40px;
            height: 3px;
            background-color: #f59e0b;
            border-radius: 2px;
        }

        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 0;
            min-height: 44px;
        }

        .footer-links a:hover {
            color: var(--secondary);
            padding-left: 5px;
        }

        /* PERBAIKAN: Kontak Item dengan Icon yang Lebih Terang */
        .contact-item {
            display: flex;
            align-items: start;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .contact-icon {
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f59e0b; /* WARNA ICON DIUBAH MENJADI ORANGE TERANG */
            flex-shrink: 0;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid rgba(245, 158, 11, 0.3);
        }
        
        .contact-icon:hover {
            background: rgba(245, 158, 11, 0.2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
            border-color: #f59e0b;
        }

        .contact-item-content span {
            display: block;
            color: white;
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 1rem;
        }
        
        .contact-item-content small {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .copyright {
            background-color: rgba(0,0,0,0.3);
            padding: 20px 0;
            text-align: center;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
        }

        /* PERBAIKAN TAMBAHAN: Social Media Icons di Footer */
        .social-media-icons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .social-icon {
            background: rgba(255, 255, 255, 0.1);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f59e0b;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .social-icon:hover {
            background: #f59e0b;
            color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }

        /* --- RESPONSIVE MEDIA QUERIES UNTUK BAGIAN LAIN --- */
        @media (max-width: 991px) {
            .hero-section {
                padding-top: 120px;
                text-align: center;
                background-position: left center;
            }
            .hero-overlay {
                background: linear-gradient(to bottom, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.8) 100%);
            }
            .hero-badge {
                margin: 0 auto 20px auto;
            }
            .d-flex.gap-3 {
                justify-content: center;
                flex-wrap: wrap;
            }
            .form-panel {
                padding: 30px 20px;
            }
            .info-panel {
                padding: 30px 20px;
            }
            .gallery-thumbnail-container {
                height: 150px;
            }
            .lightbox-modal .modal-dialog {
                max-width: 98%;
                margin: 5px auto;
            }
            .menu-logo {
                width: 100px;
                height: 100px;
            }
            .info-panel-logo {
                width: 150px;
            }
            .peta-section {
                padding: 60px 0;
            }
        }

        @media (max-width: 768px) {
            .gallery-thumbnail-container {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
                height: 200px;
            }
            .lightbox-modal .modal-footer {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            .lightbox-nav, .lightbox-zoom-controls {
                justify-content: center;
            }
            .menu-logo {
                width: 90px;
                height: 90px;
            }
            .info-panel-logo {
                width: 120px;
            }
            .peta-section {
                padding: 50px 0;
            }
        }

        @media (max-width: 576px) {
            .display-3 {
                font-size: 2.5rem; 
            }
            .slogan-signature {
                font-size: 2rem;
                margin-bottom: 15px;
            }
            .lead {
                font-size: 1rem;
            }
            .hero-section {
                padding-top: 130px; 
                padding-bottom: 50px;
            }
            .navbar-brand div h5 {
                font-size: 1rem;
            }
            .navbar-brand div span {
                font-size: 0.65rem;
            }
            .btn-cta {
                width: 100%; 
                margin-bottom: 10px;
            }
            .btn-outline-primary {
                width: 100%;
            }
            .gallery-thumbnail-container {
                height: 160px;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
            }
            .lightbox-modal .modal-body {
                max-height: 60vh;
            }
            .menu-logo {
                width: 80px;
                height: 80px;
                margin-bottom: 20px;
            }
            .service-card {
                padding: 30px 20px;
            }
            .info-panel-logo {
                width: 100px;
                margin-bottom: 20px;
            }
            .aduan-section {
                padding: 70px 0;
            }
            .form-panel {
                padding: 25px 15px;
            }
            .info-panel {
                padding: 25px 15px;
            }
            
            /* Responsive untuk contact icon di footer */
            .contact-icon {
                width: 44px;
                height: 44px;
                font-size: 1rem;
            }
            
            .contact-item-content span {
                font-size: 0.95rem;
            }
            
            .contact-item-content small {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 400px) {
            .gallery-thumbnail-container {
                height: 140px;
            }
            .menu-logo {
                width: 70px;
                height: 70px;
            }
            .info-panel-logo {
                width: 80px;
            }
        }
        
        /* ============================================ */
        /* PERBAIKAN KHUSUS UNTUK TOUCH SCREEN MOBILE */
        /* ============================================ */
        
        /* Perbaikan untuk elemen yang dapat disentuh */
        .touch-friendly {
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Mencegah highlight biru pada tap di mobile */
        * {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }
        
        /* Perbaikan scroll untuk mobile */
        .mobile-scroll-fix {
            -webkit-overflow-scrolling: touch;
            overflow-y: auto;
        }
        
        /* Perbaikan untuk mencegah zoom pada input di iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Perbaikan untuk peta Leaflet di mobile */
        .leaflet-container {
            font-family: var(--font-body) !important;
        }
        
        .leaflet-control-zoom {
            margin: 10px !important;
        }
        
        .leaflet-control-zoom a {
            width: 34px !important;
            height: 34px !important;
            line-height: 34px !important;
            font-size: 18px !important;
            min-width: 34px !important;
            min-height: 34px !important;
        }
        
        /* Perbaikan untuk marker di mobile */
        .leaflet-marker-icon {
            cursor: pointer !important;
        }
        
        /* Perbaikan untuk popup di mobile */
        .leaflet-popup-content {
            font-family: var(--font-body) !important;
            font-size: 14px !important;
            max-width: 280px !important;
        }
        
        .leaflet-popup-content-wrapper {
            border-radius: 12px !important;
        }
        
        /* Perbaikan untuk menghilangkan delay pada tap di mobile */
        a, button, .btn, .nav-link, .tab, .control-btn, .desa-item {
            touch-action: manipulation;
        }
        
        /* Perbaikan untuk mencegah text selection yang tidak diinginkan */
        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Animasi yang lebih smooth untuk mobile */
        .smooth-transition {
            transition: all 0.2s ease;
        }
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div class="loading hidden" id="loadingScreen">
        <div class="spinner"></div>
        <h2 style="color: var(--primary); margin-bottom: 10px;">Memuat Peta Statistik</h2>
        <p style="color: var(--gray-color); max-width: 400px; text-align: center;">
            Sedang memuat data statistik nelayan Kabupaten Situbondo...
        </p>
    </div>

    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-3" href="#">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Pemerintah Kabupaten Situbondo">
                <div class="brand-text d-flex flex-column">
                    <h5>DINAS PERIKANAN</h5>
                    <span>KAB. SITUBONDO</span>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center gap-2">
                    <li class="nav-item"><a class="nav-link active" href="#home">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link" href="#layanan">Layanan</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://www.dinasperikanansitubondo.com/simatadesa">SIMATA DESA</a></li>
                    <li class="nav-item ms-lg-3">
                        <a href="#aduan" class="btn btn-cta">Hubungi Kami</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="home" class="hero-section">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <div class="row">
                <div class="col-lg-7" data-aos="fade-right">
                    <div class="hero-badge text-nowrap">
                        <i class="fas fa-water"></i> <span>Dinas Perikanan Situbondo</span>
                    </div>
                    
                    <div class="slogan-signature">
                        Pemberdayaan Nelayan
                    </div>
                    <h1 class="display-3 fw-bold mb-4" style="color: var(--text-main);">
                        Dari Hulu ke Hilir <span class="connector-text">untuk</span> <br>
                        <span class="text-orange-gradient">Situbondo Naik Kelas</span>
                    </h1>
                    
                    <p class="lead mb-5" style="color: var(--text-sub); font-weight: 500;">
                        Program kegiatan Bidang Bina Pemberdayaan Nelayan yg merujuk pada rantai nilai perikanan, mulai dari kegiatan penangkapan ikan di laut (hulu) hingga proses pengolahan, distribusi, pemasaran, hingga akhirnya sampai ke konsumen (hilir), yang tujuannya meningkatkan kesejahteraan nelayan melalui data basis  nelayan yang terintegrasi, pemberdayaan, dan dukungan infrastruktur agar nelayan tidak tertinggal dan memiliki perlindungan sosial.
                    </p>
                    <div class="d-flex gap-3">
                        <a href="#layanan" class="btn btn-cta px-4 py-3 shadow btn-pulse-primary">Layanan Kami</a>
                        <a href="https://portaldata.kkp.go.id/" target="_blank" class="btn btn-outline-primary px-4 py-3 rounded-pill fw-bold btn-pulse-outline" style="border-width: 2px;">Portal Data KKP</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="layanan" class="py-5">
        <div class="container py-5">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Menu Layanan</span>
                <h2 class="display-6 mt-2">Akses Program Nelayan</h2>
                <div style="width: 80px; height: 4px; background: #f59e0b; margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Pilih menu di bawah ini untuk mengakses layanan digital dan program bantuan pemerintah.</p>
            </div>

            <div class="row g-4">
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <a href="https://portaldata.kkp.go.id/" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kusuka.png" alt="Logo KUSUKA" class="menu-logo">
                        <h4 class="fw-bold mb-3">Kartu KUSUKA</h4>
                        <p class="text-muted">Akses Portal Data KKP untuk pendaftaran dan cek status identitas pelaku usaha perikanan (KUSUKA).</p>
                        <span class="card-link-text">Buka Portal <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="150">
                     <a href="https://www.dinasperikanansitubondo.com/simata" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMATA" class="menu-logo">
                        <h4 class="fw-bold mb-3">SIMATA</h4>
                        <p class="text-muted">Sistem Manajemen & Pemetaan Data. Monitoring data nelayan dan potensi tangkapan dalam satu peta.</p>
                        <span class="card-link-text">Lihat Peta Data <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- MENU BARU: Peta SIMATA -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="155">
                    <a href="https://www.dinasperikanansitubondo.com/petasimata" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/gambar-petasimata.png" alt="Logo Peta SIMATA" class="menu-logo">
                        <h4 class="fw-bold mb-3">Peta SIMATA</h4>
                        <p class="text-muted">Visualisasi peta interaktif data nelayan terintegrasi. Pantau distribusi dan sebaran nelayan di Kabupaten Situbondo secara real-time.</p>
                        <span class="card-link-text">Lihat Peta Interaktif <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="170">
                    <a href="https://www.dinasperikanansitubondo.com/kilat" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kilat.png" alt="Logo KILAT" class="menu-logo">
                        <h4 class="fw-bold mb-3">KILAT</h4>
                        <p class="text-muted">Kamera Interaktif Lacak Aktifitas Terkini. Aplikasi dokumentasi kegiatan dengan watermark lokasi dan waktu otomatis.</p>
                        <span class="card-link-text">Akses Kamera <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="190">
                    <a href="https://www.dinasperikanansitubondo.com/sismat" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/surat.png" alt="Logo SISMAT" class="menu-logo">
                        <h4 class="fw-bold mb-3">SISMAT</h4>
                        <p class="text-muted">Sistem Manajemen Surat. Layanan administrasi dan persuratan digital dinas perikanan.</p>
                        <span class="card-link-text">Buka Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <a href="https://www.dinasperikanansitubondo.com/barjas" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kapal.png" alt="Logo Bantuan Sarpras" class="menu-logo">
                        <h4 class="fw-bold mb-3">Bantuan Sarpras</h4>
                        <p class="text-muted">Informasi dan pengajuan bantuan sarana prasarana seperti mesin, jaring, dan perahu nelayan.</p>
                        <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="210">
                    <a href="https://www.dinasperikanansitubondo.com/peraturankkp" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/peraturan.png" alt="Logo Peraturan Kemen-KP" class="menu-logo">
                        <h4 class="fw-bold mb-3">Peraturan Kemen-KP</h4>
                        <p class="text-muted">Akses kumpulan peraturan dan kebijakan Kementerian Kelautan dan Perikanan yang berlaku untuk nelayan dan pelaku usaha perikanan.</p>
                        <span class="card-link-text">Lihat Peraturan <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="230">
                    <a href="https://www.dinasperikanansitubondo.com/kegiatan/" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/galeri.png" alt="Logo Galeri" class="menu-logo">
                        <h4 class="fw-bold mb-3">Galeri Kegiatan</h4>
                        <p class="text-muted">Lihat dokumentasi kegiatan lapangan, pelatihan, dan program pemberdayaan nelayan Situbondo.</p>
                        
                        <!-- Grid Thumbnail Galeri dengan Lightbox -->
                        <div class="gallery-thumbnail-container">
                            <!-- Foto 1 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(0)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg" alt="Kegiatan 1" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 2 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(1)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg" alt="Kegiatan 2" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 3 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(2)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg" alt="Kegiatan 3" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 4 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(3)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg" alt="Kegiatan 4" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 5 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(4)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg" alt="Kegiatan 5" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 6 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(5)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg" alt="Kegiatan 6" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 7 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(6)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg" alt="Kegiatan 7" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 8 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(7)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg" alt="Kegiatan 8" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 9 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(8)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg" alt="Kegiatan 9" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                        </div>
                        
                        <span class="card-link-text">Lihat Galeri Lengkap <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="310">
                    <a href="#aduan" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/layanan%20info.png" alt="Logo Layanan Aduan" class="menu-logo">
                        <h4 class="fw-bold mb-3">Layanan Aduan</h4>
                        <p class="text-muted">Sampaikan aspirasi, keluhan, atau permohonan informasi langsung kepada dinas secara online.</p>
                        <span class="card-link-text">Isi Formulir <i class="fas fa-arrow-down"></i></span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Peta Statistik Section -->
    <section id="statistik" class="peta-section">
        <div class="container">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Data Statistik</span>
                <h2 class="display-6 mt-2">Peta Statistik Nelayan Kab. Situbondo</h2>
                <div style="width: 80px; height: 4px; background: #f59e0b; margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</p>
            </div>

            <div class="peta-statistik-container">
                <div class="peta-statistik-header">
                    <div class="header-bg"></div>
                    <div class="header-content">
                        <h1 class="peta-statistik-title"><i class="fas fa-map-marked-alt"></i> Peta Statistik Nelayan Kab. Situbondo</h1>
                        <div class="peta-subtitle">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</div>
                        <div class="metadata">
                            <div class="meta-item"><i class="fas fa-calendar-alt"></i> Terakhir Update: <span id="lastUpdate">9 Desember 2025</span></div>
                            <div class="meta-item"><i class="fas fa-village"></i> Total Desa: <span id="totalDesa">27</span></div>
                            <div class="meta-item"><i class="fas fa-users"></i> Total Penerima: <span id="totalPenerima">393</span></div>
                            <div class="meta-item"><i class="fas fa-box"></i> Total Bantuan: <span id="totalBantuan">424</span> Unit</div>
                            <div class="meta-item"><i class="fas fa-sync-alt"></i> Auto-update: <span id="autoReloadStatus">Aktif</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="peta-content d-flex">
                    <div class="peta-sidebar">
                        <div class="tabs">
                            <div class="tab active" data-tab="stats">Statistik</div>
                            <div class="tab" data-tab="desa">Daftar Desa</div>
                            <div class="tab" data-tab="charts">Grafik</div>
                        </div>
                        
                        <div class="tab-content active" id="stats-tab">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" id="searchDesa" placeholder="Cari desa atau kecamatan...">
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-bar"></i> Ringkasan Statistik</div>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryDesa">27</div>
                                        <div class="stat-label">Desa Terdata</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryPenerima">393</div>
                                        <div class="stat-label">Penerima Bantuan</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryBarang">424</div>
                                        <div class="stat-label">Bantuan Barang</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryUang">0</div>
                                        <div class="stat-label">Bantuan Uang</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-star"></i> Top 5 Desa Penerima</div>
                                <div id="topDesaList">
                                    <!-- Akan diisi oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="desa-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-list"></i> Daftar Desa/Kelurahan</div>
                                <div class="desa-list-header">
                                    <span>Nama Desa</span>
                                    <span>Penerima</span>
                                </div>
                                <div class="desa-list" id="desaList">
                                    <!-- Akan diisi oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="charts-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-pie"></i> Distribusi Bantuan</div>
                                <div class="chart-container">
                                    <canvas id="bantuanChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-line"></i> Tren Tahun Distribusi</div>
                                <div class="chart-container">
                                    <canvas id="tahunChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="peta-map-container">
                        <div id="statistikMap"></div>
                        
                        <div class="peta-controls">
                            <!-- TOMBOL BARU: Cek Detail Data Peta -->
                            <a href="https://www.dinasperikanansitubondo.com/petabantuan" target="_blank" class="control-btn btn-detail-peta" id="detailDataBtn">
                                <i class="fas fa-info-circle"></i> <span class="btn-text">Cek Detail Data Peta</span>
                            </a>
                            <button class="control-btn" id="reloadBtn">
                                <i class="fas fa-sync-alt"></i> <span class="btn-text">Update Data</span>
                            </button>
                            <button class="control-btn" id="resetViewBtn">
                                <i class="fas fa-globe-asia"></i> <span class="btn-text">Reset Peta</span>
                            </button>
                            <button class="control-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i> <span class="btn-text">Layar Penuh</span>
                            </button>
                        </div>
                        
                        <div class="peta-legend">
                            <div class="legend-title"><i class="fas fa-map-pin"></i> Kepadatan Penerima</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--danger-color);"></div>
                                <div class="legend-label">Tinggi ( 50 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--warning-color);"></div>
                                <div class="legend-label">Sedang (20-49 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--success-color);"></div>
                                <div class="legend-label">Rendah ( 19 penerima)</div>
                            </div>
                        </div>
                        
                        <div class="auto-update-info">
                            <i class="fas fa-sync-alt"></i> Data diperbarui setiap <span id="reloadInterval">300</span> detik (5 menit)
                        </div>
                    </div>
                </div>
                
                <div class="peta-footer">
                    <div class="peta-footer-content">
                        <div class="peta-footer-logo">
                            <i class="fas fa-fish"></i>
                            <span>Sistem Bantuan Nelayan Kab. Situbondo</span>
                        </div>
                        <div>
                            <div class="footer-info-item">
                                <i class="fas fa-database"></i> Sumber Data: Dinas Peternakan dan Perikanan Kab. Situbondo
                            </div>
                            <div class="footer-info-item">
                                <i class="fas fa-code"></i> 
                                <span class="app-version"><i class="fas fa-layer-group"></i> Aplikasi Peta Statistik v3.0</span> | 
                                Data terakhir: <span class="last-update" id="footerUpdate">9 Desember 2025 pukul 18.54</span>
                            </div>
                        </div>
                        <div>
                            <div class="footer-info-item">
                                <i class="fas fa-clock"></i> Auto-update: <span id="footerReloadStatus" style="color: #06d6a0; font-weight: bold;">Aktif</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="aduan" class="aduan-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-10">
                    <div class="form-container" data-aos="zoom-in">
                        <div class="row g-0">
                            <div class="col-lg-4 info-panel d-flex flex-column justify-content-center">
                                <!-- LOGO PEMBERDAYAAN NELAYAN DIATAS TEKS -->
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo%20pemberdayaan%20nelayan.png" alt="Logo Pemberdayaan Nelayan" class="info-panel-logo">
                                
                                <h3 class="fw-bold mb-4 text-center">Pusat Bantuan</h3>
                                <p class="mb-4 text-center">Data yang Anda kirimkan akan diteruskan ke sistem WhatsApp Center kami. Privasi pelapor dijamin aman.</p>
                                
                                <div class="mt-4">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-check-circle text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Respon Cepat</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-user-shield text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Data Aman</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <i class="fab fa-whatsapp text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Langsung ke Admin</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-8 form-panel">
                                <h4 class="fw-bold mb-4 text-dark">Formulir Pengaduan</h4>
                                <form id="waForm" onsubmit="kirimKeWA(event)">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="nama" placeholder="Nama Sesuai KTP" required>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label class="form-label">NIK (16 Digit) <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="nik" placeholder="Masukkan NIK" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Nomor WhatsApp <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="whatsapp" placeholder="0812xxxx" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Email <small class="text-muted fw-normal">(Opsional)</small></label>
                                            <input type="email" class="form-control" id="email" placeholder="nama@email.com">
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Alamat Lengkap <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="alamat" rows="2" placeholder="Desa, Kecamatan, Kabupaten..." required></textarea>
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Isi Laporan / Perihal <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="perihal" rows="4" placeholder="Tuliskan detail laporan Anda di sini..." required></textarea>
                                        </div>

                                        <div class="col-12 mt-4">
                                            <button type="submit" class="btn btn-wa">
                                                <i class="fab fa-whatsapp fa-lg"></i> KIRIM SEKARANG
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-wave">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
                <path fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>

        <div class="container footer-content">
            <div class="row gy-5">
                <div class="col-lg-5 col-md-12">
                    <div class="d-flex align-items-center gap-3 mb-4">
                        <i class="fas fa-ship fa-3x text-white"></i> <div>
                            <h4 class="text-white mb-0 fw-bold">DINAS PERIKANAN</h4>
                            <small class="text-white-50" style="letter-spacing: 2px;">KABUPATEN SITUBONDO</small>
                        </div>
                    </div>
                    <p class="pe-lg-5" style="line-height: 1.8;">
                        Berkomitmen untuk memajukan sektor perikanan tangkap dan memberdayakan masyarakat pesisir melalui pelayanan yang transparan, akuntabel, dan inovatif.
                    </p>
                    <div class="social-media-icons">
                        <a href="#" class="social-icon">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fas fa-globe"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <h5>Tautan Cepat</h5>
                    <ul class="list-unstyled footer-links mt-3">
                        <li><a href="#home"><i class="fas fa-chevron-right fa-xs"></i> Beranda</a></li>
                        <li><a href="#layanan"><i class="fas fa-chevron-right fa-xs"></i> Layanan Kami</a></li>
                        <li><a href="#statistik"><i class="fas fa-chevron-right fa-xs"></i> SIMATA</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/kegiatan/" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Dokumentasi Kegiatan</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/peraturankkp" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Peraturan KKP</a></li>
                        <li><a href="https://situbondokab.go.id/" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Pemkab Situbondo</a></li>
                    </ul>
                </div>

                <div class="col-lg-4 col-md-6">
                    <h5>Kontak Kami</h5>
                    <div class="mt-3">
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="contact-item-content">
                                <span>Alamat Kantor</span>
                                <small>Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur 68312</small>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-phone-alt"></i>
                            </div>
                            <div class="contact-item-content">
                                <span>Telepon / WhatsApp</span>
                                <small>0878-6561-4222</small>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="contact-item-content">
                                <span>Jam Pelayanan</span>
                                <small>Senin - Jumat: 08.00 - 15.00 WIB</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="copyright">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 text-md-start mb-2 mb-md-0">
                        &copy; 2025 <strong>Dinas Perikanan Situbondo</strong>. All Rights Reserved.
                    </div>
                    <div class="col-md-6 text-md-end">
                        <small class="text-white-50">Bidang Pemberdayaan Nelayan</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Detail Modal untuk Peta Statistik -->
    <div class="detail-modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detail Desa</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Akan diisi oleh JavaScript -->
            </div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="modal fade lightbox-modal" id="lightboxModal" tabindex="-1" aria-labelledby="lightboxModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lightboxModalLabel">Galeri Kegiatan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="lightboxImage" src="" alt="Kegiatan" class="lightbox-image">
                </div>
                <div class="modal-footer">
                    <div class="lightbox-nav">
                        <button type="button" class="lightbox-nav-btn" id="prevBtn">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="nextBtn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="lightbox-counter">
                        <span id="currentIndex">1</span> / <span id="totalImages">9</span>
                    </div>
                    <div class="lightbox-zoom-controls">
                        <button type="button" class="lightbox-nav-btn" id="zoomInBtn">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="zoomOutBtn">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="resetZoomBtn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS untuk peta -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // ============================================
        // SISTEM PETA STATISTIK NELAYAN - VERSI MOBILE FRIENDLY
        // ============================================
        
        // Inisialisasi variabel global untuk peta statistik
        let statistikMap;
        let statistikMarkers = [];
        let statistikMarkerLayerGroup;
        let dataDesa = [];
        let autoReloadInterval;
        let updateCount = 0;
        let bantuanChart = null;
        let tahunChart = null;
        let isFullscreen = false;
        
        // Konfigurasi aplikasi
        const APP_CONFIG = {
            autoReload: true,
            reloadInterval: 300000, // 300 detik (5 menit)
            showNotifications: true,
            defaultMapZoom: 10,
            situbondoCenter: [-7.7069, 113.6347],
            maxMarkers: 100
        };
        
        // Data contoh untuk peta statistik (akan diganti dengan data sebenarnya dari datapeta.js)
        const SAMPLE_DATA = {
            metadata: {
                lastUpdate: "9 Desember 2025 pukul 23.35",
                totalDesa: 27,
                totalPenerima: 393
            },
            summary: {
                totalBantuanBarang: 424,
                totalBantuanUang: 0
            },
            data: [
                {
                    id: "1",
                    desa: "Panarukan",
                    kecamatan: "Panarukan",
                    jumlahPenerima: 45,
                    totalBantuanBarang: 50,
                    rataBantuan: 1.11,
                    koordinat: { lat: -7.7069, lng: 113.6347 },
                    tahunDistribusi: [
                        { tahun: "2023", jumlah: 20 },
                        { tahun: "2024", jumlah: 25 }
                    ],
                    jenisBantuan: [
                        { jenis: "Jaring", jumlah: 30 },
                        { jenis: "Perahu", jumlah: 5 },
                        { jenis: "Mesin", jumlah: 15 }
                    ],
                    kelompokDistribusi: [
                        { kelompok: "Nelayan Tradisional", jumlah: 30 },
                        { kelompok: "Nelayan Modern", jumlah: 15 }
                    ]
                },
                {
                    id: "2",
                    desa: "Mimbaan",
                    kecamatan: "Panarukan",
                    jumlahPenerima: 35,
                    totalBantuanBarang: 40,
                    rataBantuan: 1.14,
                    koordinat: { lat: -7.7167, lng: 113.6500 },
                    tahunDistribusi: [
                        { tahun: "2023", jumlah: 15 },
                        { tahun: "2024", jumlah: 20 }
                    ],
                    jenisBantuan: [
                        { jenis: "Jaring", jumlah: 25 },
                        { jenis: "Perahu", jumlah: 3 },
                        { jenis: "Mesin", jumlah: 12 }
                    ],
                    kelompokDistribusi: [
                        { kelompok: "Nelayan Tradisional", jumlah: 25 },
                        { kelompok: "Nelayan Modern", jumlah: 10 }
                    ]
                }
            ]
        };
        
        // Fungsi untuk mendeteksi perangkat mobile
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }
        
        // Fungsi untuk menginisialisasi peta statistik
        function initStatistikMap() {
            try {
                // Inisialisasi peta
                statistikMap = L.map('statistikMap').setView(APP_CONFIG.situbondoCenter, APP_CONFIG.defaultMapZoom);
                
                // Tambahkan tile layer (peta dasar)
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 18,
                    minZoom: 8
                }).addTo(statistikMap);
                
                // Tambahkan layer group untuk marker
                statistikMarkerLayerGroup = L.layerGroup().addTo(statistikMap);
                
                // Tambahkan kontrol skala
                L.control.scale({position: 'bottomleft'}).addTo(statistikMap);
                
                // Setup event listeners
                setupEventListeners();
                
                // Load data pertama kali
                loadData();
                
                // Setup auto-update jika diaktifkan
                if (APP_CONFIG.autoReload) {
                    setupAutoUpdate();
                }
                
                // Optimasi untuk mobile
                if (isMobileDevice()) {
                    optimizeForMobile();
                }
            } catch (error) {
                console.error('Error inisialisasi peta:', error);
                showNotification('Gagal menginisialisasi peta. Silakan refresh halaman.', 'error');
            }
        }
        
        // Optimasi untuk perangkat mobile
        function optimizeForMobile() {
            try {
                // Nonaktifkan drag and zoom untuk mobile jika diperlukan
                statistikMap.dragging.enable();
                statistikMap.touchZoom.enable();
                statistikMap.doubleClickZoom.enable();
                statistikMap.scrollWheelZoom.enable();
                
                // Atur zoom yang lebih sesuai untuk mobile
                statistikMap.setZoom(APP_CONFIG.defaultMapZoom - 1);
                
                // Perbaikan untuk tampilan mobile
                const mapContainer = document.getElementById('statistikMap');
                if (mapContainer) {
                    mapContainer.style.height = '350px';
                }
                
                // Sembunyikan teks tombol di mobile untuk menghemat ruang
                const btnTexts = document.querySelectorAll('.btn-text');
                btnTexts.forEach(text => {
                    if (window.innerWidth <= 400) {
                        text.style.display = 'none';
                    }
                });
            } catch (error) {
                console.error('Error optimizing for mobile:', error);
            }
        }
        
        // Fungsi untuk setup event listeners peta statistik
        function setupEventListeners() {
            try {
                // Tombol update
                document.getElementById('reloadBtn').addEventListener('click', updateData);
                
                // Tombol reset view
                document.getElementById('resetViewBtn').addEventListener('click', resetView);
                
                // Tombol fullscreen
                document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
                
                // Tabs
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        // Hapus class active dari semua tab
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        // Tambah class active ke tab yang diklik
                        this.classList.add('active');
                        
                        // Tampilkan konten tab yang sesuai
                        const tabId = this.getAttribute('data-tab');
                        const tabContent = document.getElementById(`${tabId}-tab`);
                        if (tabContent) {
                            tabContent.classList.add('active');
                        }
                    });
                });
                
                // Pencarian desa
                const searchInput = document.getElementById('searchDesa');
                if (searchInput) {
                    searchInput.addEventListener('input', function(e) {
                        filterDesaList(e.target.value);
                    });
                }
                
                // Modal close
                const modalClose = document.getElementById('modalClose');
                if (modalClose) {
                    modalClose.addEventListener('click', closeModal);
                }
                
                // Close modal dengan klik di luar
                const detailModal = document.getElementById('detailModal');
                if (detailModal) {
                    detailModal.addEventListener('click', function(e) {
                        if (e.target === this) {
                            closeModal();
                        }
                    });
                }
                
                // Close modal dengan ESC
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        closeModal();
                    }
                });
                
                // Fullscreen change event
                document.addEventListener('fullscreenchange', handleFullscreenChange);
                document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
                document.addEventListener('mozfullscreenchange', handleFullscreenChange);
                document.addEventListener('MSFullscreenChange', handleFullscreenChange);
                
                // Touch events untuk mobile
                setupTouchEvents();
            } catch (error) {
                console.error('Error setup event listeners:', error);
            }
        }
        
        // Setup touch events untuk mobile
        function setupTouchEvents() {
            // Mencegah zoom halaman saat berinteraksi dengan peta
            const petaContainer = document.querySelector('.peta-map-container');
            if (petaContainer) {
                petaContainer.addEventListener('touchstart', function(e) {
                    if (e.touches.length > 1) {
                        e.preventDefault();
                    }
                }, { passive: false });
            }
            
            // Mencegah highlight biru pada tap
            document.addEventListener('touchstart', function() {}, { passive: true });
        }
        
        // Fungsi untuk setup auto-update
        function setupAutoUpdate() {
            try {
                // Update UI untuk menunjukkan auto-update aktif
                const autoReloadStatus = document.getElementById('autoReloadStatus');
                const footerReloadStatus = document.getElementById('footerReloadStatus');
                const reloadInterval = document.getElementById('reloadInterval');
                
                if (autoReloadStatus) autoReloadStatus.textContent = 'Aktif';
                if (footerReloadStatus) footerReloadStatus.textContent = 'Aktif';
                if (reloadInterval) reloadInterval.textContent = APP_CONFIG.reloadInterval / 1000;
                
                // Clear interval sebelumnya jika ada
                if (autoReloadInterval) {
                    clearInterval(autoReloadInterval);
                }
                
                // Setup interval untuk auto-update
                autoReloadInterval = setInterval(() => {
                    try {
                        updateData();
                        updateCount++;
                        
                        // Tampilkan notifikasi setiap 5 update
                        if (updateCount % 5 === 0 && APP_CONFIG.showNotifications) {
                            showNotification(`Data telah diperbarui ${updateCount} kali`, 'info');
                        }
                    } catch (error) {
                        console.error('Error dalam auto-update:', error);
                    }
                }, APP_CONFIG.reloadInterval);
                
                // Tampilkan notifikasi
                if (APP_CONFIG.showNotifications) {
                    showNotification(`Auto-update diaktifkan. Data akan diperbarui setiap ${APP_CONFIG.reloadInterval/1000} detik.`, 'info');
                }
            } catch (error) {
                console.error('Error setup auto-update:', error);
            }
        }
        
        // Fungsi untuk memuat data
        function loadData() {
            // Tampilkan loading
            showLoading(true);
            
            // Gunakan data sample sebagai fallback
            setTimeout(() => {
                processData(SAMPLE_DATA);
                showLoading(false);
                
                // Coba load data dari file jika ada
                loadDataFile();
            }, 1000);
        }
        
        // Fungsi untuk load data file
        function loadDataFile() {
            try {
                // Coba load dari datapeta.js
                if (typeof DATA_PETA_STATISTIK !== 'undefined') {
                    processData(DATA_PETA_STATISTIK);
                    return;
                }
                
                // Jika tidak ada, coba load dari file
                const script = document.createElement('script');
                script.src = 'datapeta.js';
                script.onload = function() {
                    if (typeof DATA_PETA_STATISTIK !== 'undefined') {
                        processData(DATA_PETA_STATISTIK);
                    }
                };
                script.onerror = function() {
                    console.log('File datapeta.js tidak ditemukan, menggunakan data sample');
                };
                document.head.appendChild(script);
            } catch (error) {
                console.error('Error loading data file:', error);
            }
        }
        
        // Fungsi untuk memproses data
        function processData(data) {
            try {
                if (!data || !Array.isArray(data.data)) {
                    console.log('Menggunakan data sample');
                    data = SAMPLE_DATA;
                }
                
                dataDesa = data.data || [];
                
                // Update informasi metadata
                updateElementText('lastUpdate', data.metadata?.lastUpdate || '9 Desember 2025');
                updateElementText('totalDesa', data.metadata?.totalDesa || '27');
                updateElementText('totalPenerima', data.metadata?.totalPenerima || '393');
                updateElementText('totalBantuan', data.summary?.totalBantuanBarang || '424');
                updateElementText('footerUpdate', data.metadata?.lastUpdate || '9 Desember 2025 pukul 23.35');
                
                // Update ringkasan statistik
                updateElementText('summaryDesa', data.metadata?.totalDesa || '27');
                updateElementText('summaryPenerima', data.metadata?.totalPenerima || '393');
                updateElementText('summaryBarang', data.summary?.totalBantuanBarang || '424');
                updateElementText('summaryUang', data.summary?.totalBantuanUang || '0');
                
                // Tampilkan desa terbanyak penerima
                displayTopDesa(dataDesa);
                
                // Tampilkan daftar desa
                displayDesaList(dataDesa);
                
                // Tampilkan marker di peta
                displayMapMarkers(dataDesa);
                
                // Update charts
                updateCharts(dataDesa);
                
                // Tampilkan notifikasi sukses
                if (APP_CONFIG.showNotifications) {
                    showNotification('Data berhasil dimuat', 'success');
                }
            } catch (error) {
                console.error('Error processing data:', error);
                showNotification('Terjadi kesalahan saat memproses data.', 'error');
            }
        }
        
        // Helper function untuk update teks elemen
        function updateElementText(elementId, text) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = text;
            }
        }
        
        // Fungsi untuk menampilkan top 5 desa
        function displayTopDesa(desaData) {
            try {
                const topDesaList = document.getElementById('topDesaList');
                if (!topDesaList) return;
                
                topDesaList.innerHTML = '';
                
                if (!Array.isArray(desaData) || desaData.length === 0) {
                    topDesaList.innerHTML = '<p style="text-align: center; color: var(--gray-color); padding: 20px;">Data tidak tersedia</p>';
                    return;
                }
                
                // Urutkan dan ambil 5 teratas
                const sortedDesa = [...desaData]
                    .sort((a, b) => (b.jumlahPenerima || 0) - (a.jumlahPenerima || 0))
                    .slice(0, 5);
                
                sortedDesa.forEach((desa, index) => {
                    const desaItem = document.createElement('div');
                    desaItem.className = 'desa-item';
                    
                    let rankBadge = '';
                    if (index === 0) rankBadge = '<span style="background: gold; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;"><i class="fas fa-crown"></i> 1</span>';
                    else if (index === 1) rankBadge = '<span style="background: silver; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">2</span>';
                    else if (index === 2) rankBadge = '<span style="background: #cd7f32; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">3</span>';
                    else rankBadge = `<span style="background: var(--primary); color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">${index + 1}</span>`;
                    
                    desaItem.innerHTML = `
                        <div>
                            <div class="desa-name">${rankBadge} ${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'}</div>
                            <div class="desa-details">
                                <span><i class="fas fa-users"></i> ${desa.jumlahPenerima || 0} Penerima</span>
                                <span><i class="fas fa-box"></i> ${desa.totalBantuanBarang || 0} Unit</span>
                            </div>
                        </div>
                        <div>
                            <button class="control-btn" style="padding: 8px 12px; font-size: 0.9rem;" data-id="${desa.id || ''}">
                                <i class="fas fa-info-circle"></i> Detail
                            </button>
                        </div>
                    `;
                    
                    // Event untuk zoom ke desa
                    desaItem.addEventListener('click', function(e) {
                        if (!e.target.closest('button')) {
                            zoomToDesa(desa.id);
                        }
                    });
                    
                    // Event untuk button detail
                    const detailBtn = desaItem.querySelector('button');
                    detailBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        showDesaDetail(desa.id);
                    });
                    
                    topDesaList.appendChild(desaItem);
                });
            } catch (error) {
                console.error('Error displaying top desa:', error);
            }
        }
        
        // Fungsi untuk menampilkan daftar desa
        function displayDesaList(desaData) {
            try {
                const desaList = document.getElementById('desaList');
                if (!desaList) return;
                
                desaList.innerHTML = '';
                
                if (!Array.isArray(desaData) || desaData.length === 0) {
                    desaList.innerHTML = '<div class="desa-item" style="justify-content: center;"><span>Data tidak tersedia</span></div>';
                    return;
                }
                
                // Urutkan berdasarkan jumlah penerima
                const sortedDesa = [...desaData].sort((a, b) => (b.jumlahPenerima || 0) - (a.jumlahPenerima || 0));
                
                sortedDesa.forEach(desa => {
                    const desaItem = document.createElement('div');
                    desaItem.className = 'desa-item';
                    desaItem.dataset.id = desa.id || '';
                    
                    // Format tahun distribusi
                    let tahunText = 'N/A';
                    if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                        tahunText = desa.tahunDistribusi.map(t => t.tahun).filter(t => t).join(', ');
                    }
                    
                    desaItem.innerHTML = `
                        <div>
                            <div class="desa-name">${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'}</div>
                            <div class="desa-details">
                                <span><i class="fas fa-calendar"></i> ${tahunText}</span>
                            </div>
                        </div>
                        <div>
                            <span style="background: ${getColorByPenerima(desa.jumlahPenerima || 0)}; color: white; padding: 5px 12px; border-radius: 20px; font-weight: bold;">
                                ${desa.jumlahPenerima || 0}
                            </span>
                        </div>
                    `;
                    
                    // Event untuk zoom ke desa
                    desaItem.addEventListener('click', function() {
                        zoomToDesa(desa.id);
                    });
                    
                    desaList.appendChild(desaItem);
                });
            } catch (error) {
                console.error('Error displaying desa list:', error);
            }
        }
        
        // Fungsi untuk filter daftar desa
        function filterDesaList(query) {
            try {
                const desaItems = document.querySelectorAll('#desaList .desa-item');
                const lowerQuery = query.toLowerCase().trim();
                
                desaItems.forEach(item => {
                    const desaName = item.querySelector('.desa-name')?.textContent.toLowerCase() || '';
                    if (desaName.includes(lowerQuery) || query === '') {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            } catch (error) {
                console.error('Error filtering desa list:', error);
            }
        }
        
        // Fungsi untuk menampilkan marker di peta
        function displayMapMarkers(desaData) {
            try {
                // Hapus marker lama
                if (statistikMarkerLayerGroup) {
                    statistikMarkerLayerGroup.clearLayers();
                }
                statistikMarkers = [];
                
                if (!Array.isArray(desaData) || desaData.length === 0) return;
                
                // Batasi jumlah marker
                const displayData = desaData.slice(0, APP_CONFIG.maxMarkers);
                
                displayData.forEach(desa => {
                    // Validasi koordinat
                    if (!desa.koordinat || !desa.koordinat.lat || !desa.koordinat.lng) {
                        return;
                    }
                    
                    // Warna marker berdasarkan jumlah penerima
                    const markerColor = getColorByPenerima(desa.jumlahPenerima || 0);
                    
                    // Buat custom icon
                    const markerIcon = L.divIcon({
                        html: `<div style="
                            background: ${markerColor};
                            width: 32px;
                            height: 32px;
                            border-radius: 50%;
                            border: 3px solid white;
                            box-shadow: 0 0 15px rgba(0,0,0,0.3);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-weight: bold;
                            font-size: 12px;
                            cursor: pointer;
                            font-family: var(--font-head);
                            transition: all 0.3s ease;
                        ">${desa.jumlahPenerima || 0}</div>`,
                        className: 'custom-marker',
                        iconSize: [35, 35],
                        iconAnchor: [17.5, 17.5]
                    });
                    
                    // Buat marker
                    const marker = L.marker([desa.koordinat.lat, desa.koordinat.lng], {
                        icon: markerIcon,
                        title: `${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'} - ${desa.jumlahPenerima || 0} penerima`
                    });
                    
                    // Tambahkan popup
                    const popupContent = createPopupContent(desa);
                    marker.bindPopup(popupContent);
                    
                    // Event click untuk highlight
                    marker.on('click', function() {
                        highlightDesa(desa.id);
                    });
                    
                    // Tambahkan ke peta
                    if (statistikMarkerLayerGroup) {
                        marker.addTo(statistikMarkerLayerGroup);
                    }
                    
                    // Simpan reference
                    statistikMarkers.push({
                        id: desa.id || '',
                        marker: marker,
                        desa: desa
                    });
                });
                
                // Fit bounds jika ada marker
                if (statistikMarkers.length > 0 && statistikMap) {
                    const markerBounds = L.latLngBounds(statistikMarkers.map(m => {
                        if (m.marker && m.marker.getLatLng) {
                            return m.marker.getLatLng();
                        }
                        return APP_CONFIG.situbondoCenter;
                    }));
                    
                    if (markerBounds.isValid()) {
                        // Atur zoom yang berbeda untuk mobile
                        const maxZoom = isMobileDevice() ? 11 : 12;
                        statistikMap.fitBounds(markerBounds, { padding: [50, 50], maxZoom: maxZoom });
                    }
                }
            } catch (error) {
                console.error('Error displaying map markers:', error);
            }
        }
        
        // Fungsi untuk membuat konten popup
        function createPopupContent(desa) {
            const desaName = desa.desa || 'N/A';
            const kecamatan = desa.kecamatan || 'N/A';
            const jumlahPenerima = desa.jumlahPenerima || 0;
            const totalBantuanBarang = desa.totalBantuanBarang || 0;
            
            return `
                <div style="max-width: 300px;">
                    <h3 style="margin: 0 0 10px 0; color: var(--primary); font-family: var(--font-head); font-size: ${isMobileDevice() ? '1.1rem' : '1.2rem'};">${desaName}, ${kecamatan}</h3>
                    <p><strong><i class="fas fa-users" style="color: var(--accent);"></i> Jumlah Penerima:</strong> ${jumlahPenerima} orang</p>
                    <p><strong><i class="fas fa-box" style="color: #f59e0b;"></i> Total Bantuan Barang:</strong> ${totalBantuanBarang} unit</p>
                    <hr style="margin: 15px 0;">
                    <div style="text-align: center;">
                        <button onclick="window.showDesaDetail('${desa.id || ''}')" style="
                            background: linear-gradient(135deg, var(--accent), var(--primary));
                            color: white;
                            border: none;
                            padding: 10px 18px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: bold;
                            width: 100%;
                            font-family: var(--font-head);
                            transition: all 0.3s ease;
                            font-size: ${isMobileDevice() ? '0.9rem' : '1rem'};
                            min-height: 44px;
                        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(25, 118, 210, 0.3)'" 
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                            <i class="fas fa-info-circle"></i> Lihat Detail Lengkap
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Fungsi untuk mendapatkan warna berdasarkan jumlah penerima
        function getColorByPenerima(jumlah) {
            if (jumlah >= 50) return 'var(--danger-color)';
            if (jumlah >= 20) return 'var(--warning-color)';
            return 'var(--success-color)';
        }
        
        // Fungsi untuk zoom ke desa
        function zoomToDesa(desaId) {
            try {
                const selectedMarker = statistikMarkers.find(m => m.id === desaId);
                if (selectedMarker && selectedMarker.marker && statistikMap) {
                    const zoomLevel = isMobileDevice() ? 12 : 13;
                    statistikMap.setView(selectedMarker.marker.getLatLng(), zoomLevel);
                    selectedMarker.marker.openPopup();
                    highlightDesa(desaId);
                }
            } catch (error) {
                console.error('Error zooming to desa:', error);
            }
        }
        
        // Fungsi untuk highlight desa
        function highlightDesa(desaId) {
            try {
                // Reset semua marker
                statistikMarkers.forEach(m => {
                    if (m.marker && m.marker.getElement) {
                        const markerEl = m.marker.getElement();
                        if (markerEl) {
                            markerEl.style.transform = 'scale(1)';
                            markerEl.style.zIndex = '1';
                        }
                    }
                });
                
                // Highlight marker yang dipilih
                const selectedMarker = statistikMarkers.find(m => m.id === desaId);
                if (selectedMarker && selectedMarker.marker && selectedMarker.marker.getElement) {
                    const markerEl = selectedMarker.marker.getElement();
                    if (markerEl) {
                        markerEl.style.transform = 'scale(1.4)';
                        markerEl.style.zIndex = '1000';
                        markerEl.style.boxShadow = '0 0 20px rgba(0,0,0,0.5)';
                    }
                    
                    // Highlight di daftar desa
                    highlightDesaListItem(desaId);
                }
            } catch (error) {
                console.error('Error highlighting desa:', error);
            }
        }
        
        // Fungsi untuk highlight item di daftar desa
        function highlightDesaListItem(desaId) {
            try {
                // Hapus class active dari semua item
                const desaItems = document.querySelectorAll('.desa-item');
                desaItems.forEach(item => {
                    item.classList.remove('active');
                });
                
                // Tambahkan class active ke item yang dipilih
                const selectedItem = document.querySelector(`.desa-item[data-id="${desaId}"]`);
                if (selectedItem) {
                    selectedItem.classList.add('active');
                    selectedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            } catch (error) {
                console.error('Error highlighting desa list item:', error);
            }
        }
        
        // Fungsi untuk menampilkan detail desa
        function showDesaDetail(desaId) {
            try {
                const desaData = dataDesa.find(d => d.id === desaId);
                if (!desaData) {
                    showNotification('Data desa tidak ditemukan.', 'error');
                    return;
                }
                
                const modalTitle = document.getElementById('modalTitle');
                if (modalTitle) {
                    modalTitle.textContent = `${desaData.desa || 'N/A'}, ${desaData.kecamatan || 'N/A'}`;
                }
                
                // Buat konten modal
                let modalHtml = `
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-item-title">Jumlah Penerima</div>
                            <div class="detail-item-value">${desaData.jumlahPenerima || 0} orang</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">Total Bantuan Barang</div>
                            <div class="detail-item-value">${desaData.totalBantuanBarang || 0} unit</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">Rata-rata Bantuan</div>
                            <div class="detail-item-value">${desaData.rataBantuan ? desaData.rataBantuan.toFixed(2) : '0.00'} unit/orang</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('modalBody').innerHTML = modalHtml;
                document.getElementById('detailModal').classList.add('active');
            } catch (error) {
                console.error('Error showing desa detail:', error);
                showNotification('Terjadi kesalahan saat menampilkan detail desa.', 'error');
            }
        }
        
        // Fungsi untuk menutup modal
        function closeModal() {
            try {
                document.getElementById('detailModal').classList.remove('active');
            } catch (error) {
                console.error('Error closing modal:', error);
            }
        }
        
        // Fungsi untuk update data
        function updateData() {
            try {
                showLoading(true);
                setTimeout(() => {
                    loadData();
                    showNotification('Data berhasil diperbarui', 'success');
                }, 1000);
            } catch (error) {
                console.error('Error updating data:', error);
                showLoading(false);
                showNotification('Gagal memperbarui data.', 'error');
            }
        }
        
        // Fungsi untuk reset view peta
        function resetView() {
            try {
                if (statistikMap) {
                    const zoomLevel = isMobileDevice() ? APP_CONFIG.defaultMapZoom - 1 : APP_CONFIG.defaultMapZoom;
                    statistikMap.setView(APP_CONFIG.situbondoCenter, zoomLevel);
                }
                
                // Reset highlight
                const desaItems = document.querySelectorAll('.desa-item');
                desaItems.forEach(item => {
                    item.classList.remove('active');
                });
                
                // Reset marker
                statistikMarkers.forEach(m => {
                    if (m.marker && m.marker.getElement) {
                        const markerEl = m.marker.getElement();
                        if (markerEl) {
                            markerEl.style.transform = 'scale(1)';
                            markerEl.style.zIndex = '1';
                        }
                        if (m.marker.closePopup) {
                            m.marker.closePopup();
                        }
                    }
                });
            } catch (error) {
                console.error('Error resetting view:', error);
            }
        }
        
        // Fungsi untuk toggle fullscreen
        function toggleFullscreen() {
            try {
                const container = document.querySelector('.peta-statistik-container');
                if (!container) return;
                
                if (!isFullscreen) {
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) {
                        container.webkitRequestFullscreen();
                    } else if (container.mozRequestFullScreen) {
                        container.mozRequestFullScreen();
                    } else if (container.msRequestFullscreen) {
                        container.msRequestFullscreen();
                    }
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            } catch (error) {
                console.error('Error toggling fullscreen:', error);
            }
        }
        
        // Fungsi untuk handle fullscreen change
        function handleFullscreenChange() {
            try {
                isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || 
                                document.mozFullScreenElement || document.msFullscreenElement);
                
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                if (fullscreenBtn) {
                    if (isFullscreen) {
                        fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i> <span class="btn-text">Keluar Layar Penuh</span>';
                    } else {
                        fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i> <span class="btn-text">Layar Penuh</span>';
                    }
                }
            } catch (error) {
                console.error('Error handling fullscreen change:', error);
            }
        }
        
        // Fungsi untuk update charts
        function updateCharts(desaData) {
            try {
                // Data untuk chart distribusi bantuan
                const bantuanLabels = ['Tinggi (50)', 'Sedang (20-49)', 'Rendah (19)'];
                const bantuanCounts = [0, 0, 0];
                
                if (Array.isArray(desaData)) {
                    desaData.forEach(desa => {
                        const jumlah = desa.jumlahPenerima || 0;
                        if (jumlah >= 50) bantuanCounts[0]++;
                        else if (jumlah >= 20) bantuanCounts[1]++;
                        else bantuanCounts[2]++;
                    });
                }
                
                // Hancurkan chart lama jika ada
                if (bantuanChart) bantuanChart.destroy();
                if (tahunChart) tahunChart.destroy();
                
                // Buat chart distribusi bantuan
                const bantuanCtx = document.getElementById('bantuanChart');
                if (bantuanCtx) {
                    bantuanChart = new Chart(bantuanCtx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: bantuanLabels,
                            datasets: [{
                                data: bantuanCounts,
                                backgroundColor: ['#ff6b6b', '#ffd166', '#06d6a0'],
                                borderWidth: 3,
                                borderColor: 'white',
                                hoverBorderWidth: 4,
                                hoverBorderColor: '#f1f5f9'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: '#475569',
                                        font: {
                                            family: 'var(--font-body)',
                                            size: isMobileDevice() ? 10 : 12,
                                            weight: '600'
                                        },
                                        padding: 15
                                    }
                                }
                            },
                            cutout: '65%'
                        }
                    });
                }
                
                // Buat chart tahun distribusi sederhana
                const tahunCtx = document.getElementById('tahunChart');
                if (tahunCtx) {
                    tahunChart = new Chart(tahunCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['2023', '2024', '2025'],
                            datasets: [{
                                label: 'Jumlah Penerima',
                                data: [150, 200, 250],
                                backgroundColor: 'rgba(25, 118, 210, 0.8)',
                                borderColor: '#1976d2',
                                borderWidth: 2,
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 50
                                    }
                                }
                            }
                        }
                    });
                }
            } catch (error) {
                console.error('Error updating charts:', error);
            }
        }
        
        // Fungsi untuk menampilkan loading
        function showLoading(show) {
            try {
                const loadingScreen = document.getElementById('loadingScreen');
                if (!loadingScreen) return;
                
                if (show) {
                    loadingScreen.classList.remove('hidden');
                } else {
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                    }, 500);
                }
            } catch (error) {
                console.error('Error showing loading:', error);
            }
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type = 'info') {
            try {
                if (!APP_CONFIG.showNotifications) return;
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                
                let icon = 'info-circle';
                if (type === 'success') icon = 'check-circle';
                else if (type === 'error') icon = 'exclamation-circle';
                else if (type === 'warning') icon = 'exclamation-triangle';
                
                notification.innerHTML = `<i class="fas fa-${icon}"></i><span>${message}</span>`;
                
                // Style berdasarkan type
                if (type === 'success') {
                    notification.style.background = 'linear-gradient(135deg, #06d6a0, #059669)';
                } else if (type === 'error') {
                    notification.style.background = 'linear-gradient(135deg, #ff6b6b, #dc2626)';
                } else if (type === 'warning') {
                    notification.style.background = 'linear-gradient(135deg, #ffd166, #f59e0b)';
                } else {
                    notification.style.background = 'linear-gradient(135deg, var(--accent), var(--primary))';
                }
                notification.style.color = 'white';
                
                // Posisi notifikasi berbeda untuk mobile
                if (isMobileDevice()) {
                    notification.style.top = '15px';
                    notification.style.right = '15px';
                    notification.style.left = '15px';
                    notification.style.maxWidth = 'none';
                }
                
                document.body.appendChild(notification);
                
                // Hapus setelah 4 detik
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 4000);
            } catch (error) {
                console.error('Error showing notification:', error);
            }
        }
        
        // ============================================
        // SISTEM WEBSITE UTAMA
        // ============================================
        
        // Init Animation
        AOS.init({
            once: true,
            offset: 100,
            duration: 800,
        });

        // Script Kirim ke WhatsApp
        function kirimKeWA(e) {
            e.preventDefault();

            try {
                let nama = document.getElementById('nama').value.trim();
                let nik = document.getElementById('nik').value.trim();
                let wa = document.getElementById('whatsapp').value.trim();
                let email = document.getElementById('email').value.trim() || '-';
                let alamat = document.getElementById('alamat').value.trim();
                let perihal = document.getElementById('perihal').value.trim();

                // Validasi
                if (!nama || !nik || !wa || !alamat || !perihal) {
                    showNotification('Harap isi semua field yang wajib diisi!', 'error');
                    return;
                }

                let targetNumber = "6287865614222"; 

                let pesan = `*LAPORAN PENGADUAN NELAYAN*%0A` +
                            `--------------------------------%0A` +
                            `*Nama:* ${nama}%0A` +
                            `*NIK:* ${nik}%0A` +
                            `*Alamat:* ${alamat}%0A` +
                            `*No. WA:* ${wa}%0A` +
                            `*Email:* ${email}%0A` +
                            `--------------------------------%0A` +
                            `*Perihal / Isi Laporan:*%0A` +
                            `${perihal}`;

                let url = `https://api.whatsapp.com/send?phone=${targetNumber}&text=${pesan}`;
                window.open(url, '_blank');
                
                // Reset form
                document.getElementById('waForm').reset();
                showNotification('Formulir berhasil dikirim!', 'success');
            } catch (error) {
                console.error('Error sending WhatsApp message:', error);
                showNotification('Terjadi kesalahan saat mengirim formulir.', 'error');
            }
        }

        // Efek Navbar saat scroll
        window.addEventListener('scroll', function() {
            try {
                const nav = document.getElementById('mainNav');
                if (!nav) return;
                
                if (window.scrollY > 50) {
                    nav.style.boxShadow = "0 10px 30px rgba(0,0,0,0.1)";
                    nav.style.background = "rgba(255, 255, 255, 0.98)";
                } else {
                    nav.style.boxShadow = "0 4px 20px rgba(0,0,0,0.05)";
                    nav.style.background = "rgba(255, 255, 255, 0.95)";
                }
            } catch (error) {
                console.error('Error in scroll handler:', error);
            }
        });

        // Lightbox functionality
        const photoUrls = [
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg'
        ];

        let currentIndex = 0;
        let zoomLevel = 1;
        const maxZoom = 3;
        const minZoom = 1;
        const zoomStep = 0.2;

        function openLightbox(index) {
            try {
                if (index < 0 || index >= photoUrls.length) return;
                
                currentIndex = index;
                updateLightbox();
                const lightboxModal = new bootstrap.Modal(document.getElementById('lightboxModal'));
                lightboxModal.show();
            } catch (error) {
                console.error('Error opening lightbox:', error);
            }
        }

        function updateLightbox() {
            try {
                const lightboxImage = document.getElementById('lightboxImage');
                const currentIndexElement = document.getElementById('currentIndex');
                const totalImagesElement = document.getElementById('totalImages');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (!lightboxImage) return;
                
                zoomLevel = 1;
                lightboxImage.style.transform = `scale(${zoomLevel})`;
                
                lightboxImage.src = photoUrls[currentIndex];
                lightboxImage.alt = `Kegiatan ${currentIndex + 1}`;
                
                if (currentIndexElement) currentIndexElement.textContent = currentIndex + 1;
                if (totalImagesElement) totalImagesElement.textContent = photoUrls.length;
                
                if (prevBtn) prevBtn.disabled = currentIndex === 0;
                if (nextBtn) nextBtn.disabled = currentIndex === photoUrls.length - 1;
                
                const modalLabel = document.getElementById('lightboxModalLabel');
                if (modalLabel) modalLabel.textContent = `Galeri Kegiatan - Foto ${currentIndex + 1}`;
            } catch (error) {
                console.error('Error updating lightbox:', error);
            }
        }

        function navigateLightbox(direction) {
            try {
                if (direction === 'prev' && currentIndex > 0) {
                    currentIndex--;
                } else if (direction === 'next' && currentIndex < photoUrls.length - 1) {
                    currentIndex++;
                }
                updateLightbox();
            } catch (error) {
                console.error('Error navigating lightbox:', error);
            }
        }

        function zoomImage(action) {
            try {
                const lightboxImage = document.getElementById('lightboxImage');
                if (!lightboxImage) return;
                
                if (action === 'in' && zoomLevel < maxZoom) {
                    zoomLevel += zoomStep;
                } else if (action === 'out' && zoomLevel > minZoom) {
                    zoomLevel -= zoomStep;
                } else if (action === 'reset') {
                    zoomLevel = 1;
                }
                
                zoomLevel = Math.max(minZoom, Math.min(maxZoom, zoomLevel));
                lightboxImage.style.transform = `scale(${zoomLevel})`;
                lightboxImage.style.transition = 'transform 0.3s ease';
            } catch (error) {
                console.error('Error zooming image:', error);
            }
        }

        // Smooth scroll untuk navigasi
        function setupSmoothScroll() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href === '#') return;
                    
                    const targetElement = document.querySelector(href);
                    if (targetElement) {
                        e.preventDefault();
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // Update active nav link
                        document.querySelectorAll('.nav-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        this.classList.add('active');
                    }
                });
            });
        }

        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Inisialisasi peta statistik
                initStatistikMap();
                
                // Setup smooth scroll
                setupSmoothScroll();
                
                // Navigation buttons untuk lightbox
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (prevBtn) {
                    prevBtn.addEventListener('click', () => navigateLightbox('prev'));
                }
                
                if (nextBtn) {
                    nextBtn.addEventListener('click', () => navigateLightbox('next'));
                }
                
                // Zoom buttons untuk lightbox
                const zoomInBtn = document.getElementById('zoomInBtn');
                const zoomOutBtn = document.getElementById('zoomOutBtn');
                const resetZoomBtn = document.getElementById('resetZoomBtn');
                
                if (zoomInBtn) {
                    zoomInBtn.addEventListener('click', () => zoomImage('in'));
                }
                
                if (zoomOutBtn) {
                    zoomOutBtn.addEventListener('click', () => zoomImage('out'));
                }
                
                if (resetZoomBtn) {
                    resetZoomBtn.addEventListener('click', () => zoomImage('reset'));
                }
                
                // Keyboard navigation untuk lightbox
                document.addEventListener('keydown', function(e) {
                    const lightboxModal = document.getElementById('lightboxModal');
                    if (lightboxModal && lightboxModal.classList.contains('show')) {
                        if (e.key === 'ArrowLeft') {
                            navigateLightbox('prev');
                        } else if (e.key === 'ArrowRight') {
                            navigateLightbox('next');
                        } else if (e.key === 'Escape') {
                            const modal = bootstrap.Modal.getInstance(lightboxModal);
                            if (modal) modal.hide();
                        } else if (e.key === '+' || e.key === '=') {
                            zoomImage('in');
                            e.preventDefault();
                        } else if (e.key === '-' || e.key === '_') {
                            zoomImage('out');
                            e.preventDefault();
                        } else if (e.key === '0') {
                            zoomImage('reset');
                        }
                    }
                });
                
                // Tampilkan pesan selamat datang
                setTimeout(() => {
                    showNotification('Website Pemberdayaan Nelayan Situbondo dimuat', 'success');
                }, 1500);
                
                // Optimasi untuk resize window
                window.addEventListener('resize', function() {
                    if (statistikMap) {
                        setTimeout(() => {
                            statistikMap.invalidateSize();
                        }, 300);
                    }
                });
                
            } catch (error) {
                console.error('Error in DOMContentLoaded:', error);
                showNotification('Terjadi kesalahan saat memuat halaman.', 'error');
            }
        });
        
        // Ekspos fungsi ke global scope
        window.showDesaDetail = showDesaDetail;
        window.zoomToDesa = zoomToDesa;
        window.closeModal = closeModal;
        window.openLightbox = openLightbox;
    </script>
</body>
</html>
