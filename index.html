<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Refresh otomatis setiap 15 menit (900 detik) -->
    <meta http-equiv="refresh" content="900">
    
    <title>Bidang Pemberdayaan Nelayan - Dinas Peternakan dan Perikanan Situbondo</title>
    <meta name="description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Peternakan dan Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMPADAN TANGKAP, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta name="keywords" content="Dinas Peternakan dan Perikanan Situbondo, SIMPADAN TANGKAP Situbondo, Peta Nelayan, Pemberdayaan Nelayan, Kartu KUSUKA, Bantuan Kapal, Pengaduan Nelayan, Layanan Nelayan">
    <meta name="author" content="Dinas Peternakan dan Perikanan Situbondo">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#f59e0b">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.dinasperikanansitubondo.com/">
    <meta property="og:title" content="Bidang Pemberdayaan Nelayan - Dinas Peternakan dan Perikanan Situbondo">
    <meta property="og:description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Peternakan dan Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMPADAN TANGKAP, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">
    <meta property="og:image:secure_url" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Dinas Peternakan dan Perikanan Situbondo">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.dinasperikanansitubondo.com/">
    <meta name="twitter:title" content="Bidang Pemberdayaan Nelayan - Dinas Peternakan dan Perikanan Situbondo">
    <meta name="twitter:description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Peternakan dan Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMPADAN TANGKAP, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS untuk peta -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Chart.js untuk statistik -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Satisfy&display=swap" rel="stylesheet">
    
    <!-- Font Awesome & AOS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Style utama -->
    <style>
        :root {
            --primary: #f59e0b;
            --primary-dark: #d97706;
            --secondary: #1e3a8a;
            --accent: #f97316;
            --success: #10b981;
            --warning: #fbbf24;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #9ca3af;
            --font-head: 'Outfit', sans-serif;
            --font-body: 'Plus Jakarta Sans', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            color: var(--dark);
            background: var(--light);
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-head);
        }

        /* Loading Screen */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease, visibility 0.5s;
        }

        .loading.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Navbar */
        .navbar {
            padding: 1rem 0;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .navbar .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .brand-logo {
            height: 60px;
            width: auto;
            transition: transform 0.3s;
        }

        .naik-kelas-logo {
            height: 50px;
            width: auto;
            margin-left: 15px;
        }

        .brand-text {
            line-height: 1.2;
            margin-left: 10px;
        }

        .brand-line-1 {
            color: var(--secondary);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .brand-line-2 {
            color: var(--primary);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 700;
        }

        .brand-line-3 {
            color: var(--gray);
            font-size: 0.75rem;
            letter-spacing: 1px;
        }

        .nav-link {
            color: var(--dark) !important;
            font-weight: 600;
            padding: 0.5rem 1rem !important;
            transition: all 0.3s;
            border-radius: 30px;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--primary) !important;
            background: rgba(245, 158, 11, 0.1);
        }

        .btn-cta {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            border: none;
            padding: 0.6rem 1.8rem;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(249,115,22,0.3);
        }

        .btn-cta:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(249,115,22,0.4);
            color: white;
        }

        /* Hero Section */
        .hero-section {
            position: relative;
            min-height: 100vh;
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #fff5e6, #ffffff);
            padding: 120px 0 80px;
            overflow: hidden;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0MCIgaGVpZ2h0PSI3NjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiIGlkPSJhIj48c3RvcCBzdG9wLWNvbG9yPSIjRkY5RjQzIiBvZmZzZXQ9IjAlIi8+PHN0b3Agc3RvcC1jb2xvcj0iI0ZGQzEwNyIgb2Zmc2V0PSIxMDAlIi8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHBhdGggZD0iTTAgMGwxNDQwIDI2MEwwIDUyMHoiIGZpbGw9InVybCgjYSkiIGZpbGwtb3BhY2l0eT0iMC4wNSIvPjwvc3ZnPg==') no-repeat bottom;
            background-size: cover;
            opacity: 0.3;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .bupati-photo-container {
            text-align: center;
        }

        .bupati-photo {
            max-width: 100%;
            height: auto;
            border-radius: 30px;
            box-shadow: 0 30px 50px rgba(0,0,0,0.15);
            border: 5px solid white;
            transform: rotate(2deg);
            transition: transform 0.3s;
        }

        .bupati-photo:hover {
            transform: rotate(0deg) scale(1.02);
        }

        .slogan-signature {
            font-family: 'Satisfy', cursive;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .text-orange-gradient {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .connector-text {
            font-size: 1.8rem;
            font-weight: 300;
            color: var(--gray);
        }

        .btn-pulse-primary {
            animation: pulse-primary 2s infinite;
        }

        @keyframes pulse-primary {
            0% { box-shadow: 0 0 0 0 rgba(249,115,22,0.7); }
            70% { box-shadow: 0 0 0 10px rgba(249,115,22,0); }
            100% { box-shadow: 0 0 0 0 rgba(249,115,22,0); }
        }

        /* Section Header */
        .section-header .text-primary {
            color: var(--primary) !important;
            letter-spacing: 2px;
            font-size: 0.9rem;
        }

        /* Layanan Cards */
        .service-card {
            display: block;
            background: white;
            border-radius: 25px;
            padding: 30px 25px;
            text-decoration: none;
            color: inherit;
            box-shadow: 0 15px 30px rgba(0,0,0,0.05);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.5);
            height: 100%;
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 50px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(30deg);
            transition: all 0.6s;
        }

        .service-card:hover::before {
            left: 100%;
        }

        .menu-logo {
            height: 80px;
            width: auto;
            margin-bottom: 20px;
        }

        .card-link-text {
            color: var(--primary);
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
        }

        /* Share Buttons */
        .share-btn-container {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .share-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--primary);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .share-btn:hover {
            transform: scale(1.1);
            background: var(--primary);
            color: white;
        }

        /* Galeri Thumbnail */
        .gallery-thumbnail-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 15px 0;
        }

        .gallery-thumbnail-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .gallery-thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .gallery-thumbnail-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .gallery-thumbnail-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-overlay i {
            color: white;
            font-size: 1.5rem;
        }

        /* Peta Statistik */
        .peta-section {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            padding: 80px 0;
        }

        .peta-statistik-container {
            background: white;
            border-radius: 30px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .peta-statistik-header {
            background: linear-gradient(135deg, var(--secondary), #0f2b5e);
            color: white;
            padding: 25px;
        }

        .peta-statistik-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .peta-subtitle {
            opacity: 0.9;
            font-size: 1rem;
            margin-top: 5px;
        }

        .metadata {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 15px;
        }

        .meta-item {
            background: rgba(255,255,255,0.15);
            padding: 8px 15px;
            border-radius: 30px;
            font-size: 0.9rem;
        }

        .peta-content {
            display: flex;
            flex-direction: row;
            min-height: 600px;
        }

        .peta-sidebar {
            width: 350px;
            background: white;
            border-right: 1px solid #e2e8f0;
            overflow-y: auto;
        }

        .peta-map-container {
            flex: 1;
            position: relative;
        }

        #statistikMap {
            width: 100%;
            height: 100%;
            min-height: 500px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            transition: all 0.3s;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            font-size: 0.95rem;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
        }

        .stats-box {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .stats-title {
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--secondary);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #64748b;
        }

        .desa-list-header {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            font-weight: 600;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 10px;
        }

        .desa-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .desa-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: background 0.2s;
        }

        .desa-item:hover,
        .desa-item.active {
            background: #fff7ed;
        }

        .desa-name {
            font-weight: 600;
        }

        .desa-details {
            font-size: 0.8rem;
            color: #64748b;
            display: flex;
            gap: 10px;
            margin-top: 3px;
        }

        .peta-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .control-btn {
            background: white;
            border: none;
            padding: 12px 16px;
            border-radius: 50px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-weight: 600;
            color: var(--secondary);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateX(-5px);
        }

        .peta-legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .legend-title {
            font-weight: 700;
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .auto-update-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 30px;
            font-size: 0.8rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .peta-footer {
            background: #f8fafc;
            padding: 20px;
            border-top: 1px solid #e2e8f0;
        }

        /* Aduan Section */
        .aduan-section {
            padding: 80px 0;
            background: white;
        }

        .form-container {
            background: linear-gradient(145deg, #ffffff, #fff9f0);
            border-radius: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.5);
        }

        .info-panel {
            background: linear-gradient(135deg, var(--secondary), #0f2b5e);
            color: white;
            padding: 50px 30px;
        }

        .info-panel-logo {
            max-width: 120px;
            margin: 0 auto 20px;
            display: block;
        }

        .form-panel {
            padding: 50px;
            background: white;
        }

        .btn-wa {
            background: #25D366;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 700;
            width: 100%;
            transition: all 0.3s;
        }

        .btn-wa:hover {
            background: #128C7E;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(37,211,102,0.3);
            color: white;
        }

        /* Lokasi Section */
        .lokasi-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .lokasi-info {
            background: white;
            padding: 35px 30px;
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .lokasi-info h4 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .lokasi-info p {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #4b5563;
        }

        .lokasi-info i {
            width: 25px;
            color: var(--primary);
        }

        .lokasi-map-container {
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 30px 60px rgba(0,0,0,0.15);
            border: 5px solid white;
            transition: transform 0.3s ease;
            background: #f0f0f0;
            height: 400px;
        }

        .lokasi-map-container:hover {
            transform: translateY(-5px);
        }

        #leafletMap {
            height: 100%;
            width: 100%;
            z-index: 1;
        }

        /* Footer */
        footer {
            background: var(--secondary);
            color: white;
            position: relative;
        }

        .footer-wave {
            position: absolute;
            top: -100px;
            left: 0;
            width: 100%;
            overflow: hidden;
            line-height: 0;
        }

        .footer-wave svg {
            position: relative;
            display: block;
            width: calc(100% + 1.3px);
            height: 100px;
            fill: var(--secondary);
        }

        .footer-content {
            padding: 60px 0 30px;
            position: relative;
        }

        .footer-brand-line-1, .footer-brand-line-2 {
            letter-spacing: 2px;
        }

        .social-media-icons {
            margin-top: 25px;
        }

        .social-icon {
            display: inline-flex;
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            transition: all 0.3s;
            color: white;
            text-decoration: none;
        }

        .social-icon:hover {
            background: var(--primary);
            transform: translateY(-5px);
            color: white;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
        }

        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(5px);
        }

        .contact-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .contact-icon {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .contact-item-content {
            flex: 1;
        }

        .contact-item-content span {
            display: block;
            font-weight: 600;
        }

        .contact-item-content small {
            opacity: 0.8;
        }

        .clickable {
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px 12px;
            border-radius: 12px;
        }

        .clickable:hover {
            background: rgba(255,255,255,0.1);
        }

        .copyright {
            background: rgba(0,0,0,0.2);
            padding: 20px 0;
        }

        /* Modal Detail */
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            z-index: 100000;
            display: flex;
            align-items: center;
            justify-content: center;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s;
        }

        .detail-modal.active {
            visibility: visible;
            opacity: 1;
        }

        .modal-content {
            background: white;
            border-radius: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 25px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .detail-item {
            background: #f8fafc;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }

        .detail-item-title {
            font-size: 0.9rem;
            color: #64748b;
        }

        .detail-item-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Lightbox */
        .lightbox-modal .modal-content {
            background: transparent;
            border: none;
        }

        .lightbox-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
            transition: transform 0.3s;
        }

        .lightbox-nav {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .lightbox-nav-btn {
            background: rgba(255,255,255,0.8);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lightbox-nav-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        .lightbox-counter {
            color: white;
            text-align: center;
            margin-top: 10px;
        }

        .lightbox-zoom-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        /* Welcome Notification */
        .welcome-notification {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 1000000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            animation: fadeIn 0.4s forwards;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        .welcome-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 40px;
            padding: 50px 40px;
            max-width: 650px;
            width: 100%;
            box-shadow: 0 40px 80px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255,255,255,0.2) inset;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.5);
            transform: scale(0.95);
            animation: scaleIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        @keyframes scaleIn {
            to { transform: scale(1); }
        }
        .welcome-icon {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #f97316, #f59e0b);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            color: white;
            font-size: 3rem;
            box-shadow: 0 15px 30px rgba(249,115,22,0.3);
        }
        .welcome-card h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 15px;
            letter-spacing: -0.5px;
        }
        .welcome-card p {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 35px;
            line-height: 1.6;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        .welcome-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .btn-welcome-secondary {
            background: transparent;
            border: 2px solid #f97316;
            color: #f97316;
            padding: 14px 36px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(249,115,22,0.1);
        }
        .btn-welcome-secondary:hover {
            background: #f97316;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(249,115,22,0.3);
        }
        .btn-welcome-primary {
            background: linear-gradient(135deg, #f97316, #f59e0b);
            border: none;
            color: white;
            padding: 14px 36px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 8px 20px rgba(249,115,22,0.3);
        }
        .btn-welcome-primary:hover {
            background: linear-gradient(135deg, #ea580c, #d97706);
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(249,115,22,0.4);
        }

        /* Audio Player Container */
        #audioPlayerContainer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(145deg, #ffffff, #fef3e2);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2), 0 0 0 1px rgba(249,115,22,0.2) inset;
            padding: 20px;
            display: none;
            z-index: 10000;
            border: none;
            max-width: 360px;
            width: calc(100% - 40px);
            box-sizing: border-box;
            backdrop-filter: blur(10px);
        }
        #audioPlayerContainer .audio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        #audioPlayerContainer .audio-title {
            font-weight: 700;
            color: #1e3a8a;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        #audioPlayerContainer .audio-title i {
            color: #f97316;
            font-size: 1.3rem;
        }
        #audioPlayerContainer .close-btn button {
            border: none;
            background: rgba(0,0,0,0.05);
            cursor: pointer;
            color: #6b7280;
            font-size: 1.2rem;
            padding: 6px 10px;
            border-radius: 50px;
            transition: 0.2s;
        }
        #audioPlayerContainer .close-btn button:hover {
            background: #f97316;
            color: white;
        }
        #audioPlayerContainer audio {
            width: 100%;
            height: auto;
            border-radius: 50px;
            outline: none;
            background: #f1f5f9;
        }

        /* Responsif */
        @media (max-width: 992px) {
            .peta-content {
                flex-direction: column;
            }
            .peta-sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
            #statistikMap {
                min-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 100px 0 50px;
            }
            .bupati-photo {
                max-width: 80%;
                margin-bottom: 30px;
            }
            .slogan-signature {
                font-size: 1.5rem;
            }
            .display-3 {
                font-size: 2rem;
            }
            .connector-text {
                font-size: 1.3rem;
            }
            .form-panel {
                padding: 30px 20px;
            }
            .info-panel {
                padding: 30px 20px;
            }
            .lokasi-map-container {
                height: 300px;
            }
            .peta-statistik-title {
                font-size: 1.4rem;
            }
            .metadata {
                gap: 10px;
            }
            .meta-item {
                width: 100%;
            }
            .welcome-card {
                padding: 30px 20px;
            }
            .welcome-icon {
                width: 70px;
                height: 70px;
                font-size: 2.5rem;
            }
            .welcome-card h2 {
                font-size: 1.8rem;
            }
            .welcome-card p {
                font-size: 1rem;
            }
            .btn-welcome-secondary, .btn-welcome-primary {
                padding: 10px 24px;
                font-size: 0.95rem;
            }
            #audioPlayerContainer {
                left: 10px;
                right: 10px;
                bottom: 10px;
                width: auto;
                max-width: none;
            }
        }
    </style>
</head>
<body>

    <!-- Welcome Notification Modal -->
    <div id="welcomeNotification" class="welcome-notification" style="display: none;">
        <div class="welcome-card">
            <div class="welcome-icon">
                <i class="fas fa-ship"></i>
            </div>
            <h2>Selamat Datang di Website Resmi</h2>
            <p>
                Dinas Peternakan dan Perikanan Kabupaten Situbondo<br>
                <strong>“Dari Hulu ke Hilir untuk Situbondo Naik Kelas”</strong>
            </p>
            <p style="font-size: 1rem; margin-bottom: 25px;">
                Akses berbagai layanan digital: KUSUKA, SIMPADAN TANGKAP, KILAT, Bantuan Sarpras, 
                Galeri Kegiatan, dan Pengaduan Nelayan. Putar audio untuk penjelasan singkat tentang fitur website.
            </p>
            <div class="welcome-buttons">
                <button id="laterButton" class="btn-welcome-secondary"><i class="fas fa-clock"></i> Nanti Saja</button>
                <button id="playAudioButton" class="btn-welcome-primary"><i class="fas fa-play"></i> Putar Audio</button>
            </div>
        </div>
    </div>

    <!-- Audio Player Container -->
    <div id="audioPlayerContainer">
        <div class="audio-header">
            <span class="audio-title"><i class="fas fa-headphones"></i> Informasi Website Utama</span>
            <div class="close-btn">
                <button onclick="closeAudioPlayer()"><i class="fas fa-times"></i></button>
            </div>
        </div>
        <audio id="audioPlayer" controls preload="none">
            <source src="https://od.lk/s/MzVfNjY1MDMxNjBf/profil-website.mp3" type="audio/mpeg">
            Browser Anda tidak mendukung pemutar audio.
        </audio>
    </div>

    <!-- Loading Screen -->
    <div class="loading hidden" id="loadingScreen">
        <div class="spinner"></div>
        <h2 style="color: var(--primary); margin-bottom: 10px;">Memuat Peta Statistik</h2>
        <p style="color: var(--gray-color); max-width: 400px; text-align: center;">
            Sedang memuat data statistik nelayan Kabupaten Situbondo...
        </p>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-3" href="#">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Pemerintah Kabupaten Situbondo" class="brand-logo">
                <div class="brand-text d-flex flex-column">
                    <h5 class="brand-line-1">DINAS PETERNAKAN</h5>
                    <h5 class="brand-line-2">DAN PERIKANAN</h5>
                    <span class="brand-line-3">KABUPATEN SITUBONDO</span>
                </div>
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/naikkelas.png" alt="Situbondo Naik Kelas" class="naik-kelas-logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center gap-2">
                    <li class="nav-item"><a class="nav-link active" href="#home">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link" href="#layanan">Layanan</a></li>
                    <li class="nav-item"><a class="nav-link" href="#lokasi">Lokasi</a></li>
                    <li class="nav-item ms-lg-3">
                        <a href="#aduan" class="btn btn-cta">Hubungi Kami</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <div class="row align-items-center">
                <div class="col-lg-5" data-aos="fade-right">
                    <div class="bupati-photo-container">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/bupati-wabup-2026.png" alt="Bupati dan Wakil Bupati Situbondo" class="bupati-photo">
                    </div>
                </div>
                
                <div class="col-lg-7" data-aos="fade-left">
                    <div class="slogan-signature">
                        Pemberdayaan Nelayan
                    </div>
                    <h1 class="display-3 fw-bold mb-4" style="color: var(--text-main);">
                        Dari Hulu ke Hilir <span class="connector-text">untuk</span> <br>
                        <span class="text-orange-gradient">Situbondo Naik Kelas</span>
                    </h1>
                    
                    <p class="lead mb-5" style="color: var(--text-sub); font-weight: 500;">
                        Program kegiatan Bidang Bina Pemberdayaan Nelayan yg merujuk pada rantai nilai perikanan, mulai dari kegiatan penangkapan ikan di laut (hulu) hingga proses pengolahan, distribusi, pemasaran, hingga akhirnya sampai ke konsumen (hilir), yang tujuannya meningkatkan kesejahteraan nelayan melalui data basis nelayan yang terintegrasi, pemberdayaan, dan dukungan infrastruktur agar nelayan tidak tertinggal dan memiliki perlindungan sosial.
                    </p>
                    <div class="d-flex gap-3">
                        <a href="#layanan" class="btn btn-cta px-4 py-3 shadow btn-pulse-primary">Layanan Kami</a>
                        <a href="https://portaldata.kkp.go.id/" target="_blank" class="btn btn-outline-primary px-4 py-3 rounded-pill fw-bold btn-pulse-outline" style="border-width: 2px;">Portal Data KKP</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Layanan Section -->
    <section id="layanan" class="py-5">
        <div class="container py-5">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Menu Layanan</span>
                <h2 class="display-6 mt-2">Akses Program Nelayan</h2>
                <div style="width: 80px; height: 4px; background: var(--primary); margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Pilih menu di bawah ini untuk mengakses layanan digital dan program bantuan pemerintah.</p>
            </div>

            <div class="row g-4">
                <!-- Kartu KUSUKA -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <a href="https://portaldata.kkp.go.id/" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://portaldata.kkp.go.id/" data-title="Kartu KUSUKA - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://portaldata.kkp.go.id/" data-title="Kartu KUSUKA - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kusuka.png" alt="Logo KUSUKA" class="menu-logo">
                        <h4 class="fw-bold mb-3">Kartu KUSUKA</h4>
                        <p class="text-muted">Akses Portal Data KKP untuk pendaftaran dan cek status identitas pelaku usaha perikanan (KUSUKA).</p>
                        <span class="card-link-text">Buka Portal <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- SIMPADAN TANGKAP -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="150">
                    <a href="https://www.dinasperikanansitubondo.com/simpadan/peta" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/simpadan" data-title="SIMPADAN TANGKAP - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/simpadan" data-title="SIMPADAN TANGKAP - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMPADAN TANGKAP" class="menu-logo">
                        <h4 class="fw-bold mb-3">SIMPADAN TANGKAP</h4>
                        <p class="text-muted">Sistem Manajemen & Pemetaan Data Pemberdayaan Nelayan Tangkap.</p>
                        <span class="card-link-text">Lihat Peta Data <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- KILAT -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="170">
                    <a href="https://www.dinasperikanansitubondo.com/kilat" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/kilat" data-title="KILAT - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/kilat" data-title="KILAT - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kilat.png" alt="Logo KILAT" class="menu-logo">
                        <h4 class="fw-bold mb-3">KILAT</h4>
                        <p class="text-muted">Kamera Interaktif Lacak Aktifitas Terkini. Aplikasi dokumentasi kegiatan dengan watermark lokasi dan waktu otomatis.</p>
                        <span class="card-link-text">Akses Kamera <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- Bantuan Sarpras -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <a href="https://www.dinasperikanansitubondo.com/barjas" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/barjas" data-title="Bantuan Sarpras - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/barjas" data-title="Bantuan Sarpras - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kapal.png" alt="Logo Bantuan Sarpras" class="menu-logo">
                        <h4 class="fw-bold mb-3">Bantuan Sarpras</h4>
                        <p class="text-muted">Informasi dan pengajuan bantuan sarana prasarana seperti mesin, jaring, dan perahu nelayan.</p>
                        <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- Peraturan KKP -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="210">
                    <a href="https://www.dinasperikanansitubondo.com/peraturankkp" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/peraturankkp" data-title="Peraturan Kemen-KP - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/peraturankkp" data-title="Peraturan Kemen-KP - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/peraturan.png" alt="Logo Peraturan Kemen-KP" class="menu-logo">
                        <h4 class="fw-bold mb-3">Peraturan Kemen-KP</h4>
                        <p class="text-muted">Akses kumpulan peraturan dan kebijakan Kementerian Kelautan dan Perikanan yang berlaku untuk nelayan dan pelaku usaha perikanan.</p>
                        <span class="card-link-text">Lihat Peraturan <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- UMKM Situbondo -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="240">
                    <a href="https://www.dinasperikanansitubondo.com/umkm" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/umkm" data-title="UMKM Situbondo - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/umkm" data-title="UMKM Situbondo - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://github.com/anekamarket/my.id/blob/main/LOGO%20UMKM%20SITUBONDO.png?raw=true" alt="Logo UMKM Situbondo" class="menu-logo">
                        <h4 class="fw-bold mb-3">UMKM Situbondo</h4>
                        <p class="text-muted">Layanan gratis untuk seluruh UMKM Situbondo, prioritas masyarakat pesisir. Dukungan pengembangan usaha mikro, kecil, dan menengah di bidang perikanan.</p>
                        <span class="card-link-text">Akses Layanan <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- AIR - Aplikasi Inovasi Rakyat -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="250">
                    <a href="https://www.aplikasiusaha.com/gratis" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.aplikasiusaha.com/gratis" data-title="AIR Aplikasi Inovasi Rakyat - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.aplikasiusaha.com/gratis" data-title="AIR Aplikasi Inovasi Rakyat - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo-air.png" alt="Logo AIR Aplikasi Inovasi Rakyat" class="menu-logo">
                        <h4 class="fw-bold mb-3">APLIKASI INOVASI RAKYAT</h4>
                        <p class="text-muted">Aplikasi gratis premium untuk masyarakat UMKM. Akses fitur manajemen usaha, pemasaran digital, dan pembukuan terintegrasi. Dukung digitalisasi usaha Anda.</p>
                        <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- Aplikasi UMKM LINK -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="260">
                    <a href="https://www.aplikasiusaha.com/umkm" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.aplikasiusaha.com/umkm" data-title="APLIKASI UMKM LINK - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.aplikasiusaha.com/umkm" data-title="APLIKASI UMKM LINK - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/umkm-link.png" alt="Logo UMKM LINK" class="menu-logo">
                        <h4 class="fw-bold mb-3">APLIKASI UMKM LINK</h4>
                        <p class="text-muted">Sistem kasir digital terintegrasi untuk pencatatan transaksi dan manajemen keuangan UMKM. Akses dengan kredensial: <strong>Username: admin</strong>, <strong>Password: Situbondo-Naik-Kelas</strong>.</p>
                        <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- Galeri Kegiatan -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="230">
                    <a href="https://www.dinasperikanansitubondo.com/kegiatan/" target="_blank" class="service-card">
                        <div class="share-btn-container">
                            <button class="share-btn share-btn-copy" data-url="https://www.dinasperikanansitubondo.com/kegiatan/" data-title="Galeri Kegiatan - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Salin Link">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="share-btn share-btn-whatsapp" data-url="https://www.dinasperikanansitubondo.com/kegiatan/" data-title="Galeri Kegiatan - Dinas Peternakan dan Perikanan Situbondo" data-tooltip="Bagikan via WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/galeri.png" alt="Logo Galeri" class="menu-logo">
                        <h4 class="fw-bold mb-3">Galeri Kegiatan</h4>
                        <p class="text-muted">Lihat dokumentasi kegiatan lapangan, pelatihan, dan program pemberdayaan nelayan Situbondo.</p>
                        
                        <!-- Grid Thumbnail Galeri -->
                        <div class="gallery-thumbnail-container">
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(0)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg" alt="Kegiatan 1" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(1)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg" alt="Kegiatan 2" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(2)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg" alt="Kegiatan 3" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(3)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg" alt="Kegiatan 4" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(4)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg" alt="Kegiatan 5" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(5)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg" alt="Kegiatan 6" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(6)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg" alt="Kegiatan 7" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(7)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg" alt="Kegiatan 8" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(8)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg" alt="Kegiatan 9" loading="lazy">
                                <div class="gallery-overlay"><i class="fas fa-search-plus"></i></div>
                            </div>
                        </div>
                        
                        <span class="card-link-text">Lihat Galeri Lengkap <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <!-- Layanan Aduan -->
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="330">
                    <a href="#aduan" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/layanan%20info.png" alt="Logo Layanan Aduan" class="menu-logo">
                        <h4 class="fw-bold mb-3">Layanan Aduan</h4>
                        <p class="text-muted">Sampaikan aspirasi, keluhan, atau permohonan informasi langsung kepada dinas secara online.</p>
                        <span class="card-link-text">Isi Formulir <i class="fas fa-arrow-down"></i></span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Peta Statistik Section -->
    <section id="statistik" class="peta-section">
        <div class="container">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Data Statistik</span>
                <h2 class="display-6 mt-2">Peta Data Bantuan Nelayan Kabupaten Situbondo</h2>
                <div style="width: 80px; height: 4px; background: var(--primary); margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</p>
            </div>

            <div class="peta-statistik-container">
                <div class="peta-statistik-header">
                    <div class="header-content">
                        <h1 class="peta-statistik-title"><i class="fas fa-map-marked-alt"></i> Statistik Data Bantuan Nelayan Kabupaten Situbondo</h1>
                        <div class="peta-subtitle">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</div>
                        <div class="metadata">
                            <div class="meta-item"><i class="fas fa-calendar-alt"></i> Terakhir Update: <span id="lastUpdate">9 Desember 2025</span></div>
                            <div class="meta-item"><i class="fas fa-village"></i> Total Desa: <span id="totalDesa">27</span></div>
                            <div class="meta-item"><i class="fas fa-users"></i> Total Penerima: <span id="totalPenerima">393</span></div>
                            <div class="meta-item"><i class="fas fa-box"></i> Total Bantuan: <span id="totalBantuan">424</span> Unit</div>
                            <div class="meta-item"><i class="fas fa-sync-alt"></i> Auto-update: <span id="autoReloadStatus">Aktif</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="peta-content d-flex">
                    <div class="peta-sidebar">
                        <div class="tabs">
                            <div class="tab active" data-tab="stats">Statistik</div>
                            <div class="tab" data-tab="desa">Daftar Desa</div>
                            <div class="tab" data-tab="charts">Grafik</div>
                        </div>
                        
                        <div class="tab-content active" id="stats-tab">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" id="searchDesa" placeholder="Cari desa atau kecamatan...">
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-bar"></i> Ringkasan Statistik</div>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryDesa">27</div>
                                        <div class="stat-label">Desa Terdata</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryPenerima">393</div>
                                        <div class="stat-label">Penerima Bantuan</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryBarang">424</div>
                                        <div class="stat-label">Bantuan Barang</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryUang">0</div>
                                        <div class="stat-label">Bantuan Uang</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-star"></i> Top 5 Desa Penerima</div>
                                <div id="topDesaList"></div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="desa-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-list"></i> Daftar Desa/Kelurahan</div>
                                <div class="desa-list-header">
                                    <span>Nama Desa</span>
                                    <span>Penerima</span>
                                </div>
                                <div class="desa-list" id="desaList"></div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="charts-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-pie"></i> Distribusi Bantuan</div>
                                <div class="chart-container">
                                    <canvas id="bantuanChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-line"></i> Tren Tahun Distribusi</div>
                                <div class="chart-container">
                                    <canvas id="tahunChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="peta-map-container">
                        <div id="statistikMap"></div>
                        
                        <div class="peta-controls">
                            <a href="https://www.dinasperikanansitubondo.com/petabantuan" target="_blank" class="control-btn btn-detail-peta" id="detailDataBtn">
                                <i class="fas fa-info-circle"></i> <span class="btn-text">Cek Detail Data Peta</span>
                            </a>
                            <button class="control-btn btn-reload-data" id="reloadDataBtn">
                                <i class="fas fa-download"></i> <span class="btn-text">Reload Data</span>
                            </button>
                            <button class="control-btn" id="reloadBtn">
                                <i class="fas fa-sync-alt"></i> <span class="btn-text">Update Data</span>
                            </button>
                            <button class="control-btn" id="resetViewBtn">
                                <i class="fas fa-globe-asia"></i> <span class="btn-text">Reset Peta</span>
                            </button>
                            <button class="control-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i> <span class="btn-text">Layar Penuh</span>
                            </button>
                        </div>
                        
                        <div class="peta-legend">
                            <div class="legend-title"><i class="fas fa-map-pin"></i> Kepadatan Penerima</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--danger-color);"></div>
                                <div class="legend-label">Tinggi (≥ 50 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--warning-color);"></div>
                                <div class="legend-label">Sedang (20-49 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--success-color);"></div>
                                <div class="legend-label">Rendah (≤ 19 penerima)</div>
                            </div>
                        </div>
                        
                        <div class="auto-update-info">
                            <i class="fas fa-sync-alt"></i> Data diperbarui setiap <span id="reloadInterval">300</span> detik (5 menit)
                        </div>
                    </div>
                </div>
                
                <div class="peta-footer">
                    <div class="peta-footer-content">
                        <div class="peta-footer-logo">
                            <i class="fas fa-ship"></i> Dinas Peternakan dan Perikanan Situbondo
                        </div>
                        <div class="footer-info">
                            <div class="footer-info-item">
                                <i class="fas fa-map-marker-alt"></i> Data Center: Jl. PB Sudirman No.77 C, Situbondo
                            </div>
                            <div class="footer-info-item">
                                <i class="fas fa-clock"></i> Terakhir Update: <span id="footerUpdate">9 Desember 2025 pukul 23.35</span>
                            </div>
                            <div class="footer-info-item">
                                <i class="fas fa-clock"></i> Auto-update: <span id="footerReloadStatus" style="color: #06d6a0; font-weight: bold;">Aktif</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Aduan Section -->
    <section id="aduan" class="aduan-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-10">
                    <div class="form-container" data-aos="zoom-in">
                        <div class="row g-0">
                            <div class="col-lg-4 info-panel d-flex flex-column justify-content-center">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo%20pemberdayaan%20nelayan.png" alt="Logo Pemberdayaan Nelayan" class="info-panel-logo">
                                
                                <h3 class="fw-bold mb-4 text-center">Pusat Bantuan</h3>
                                <p class="mb-4 text-center">Data yang Anda kirimkan akan diteruskan ke sistem WhatsApp Center kami. Privasi pelapor dijamin aman.</p>
                                
                                <div class="mt-4">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-check-circle text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Respon Cepat</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-user-shield text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Data Aman</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <i class="fab fa-whatsapp text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Langsung ke Admin</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-8 form-panel">
                                <h4 class="fw-bold mb-4 text-dark">Formulir Pengaduan</h4>
                                <form id="waForm" onsubmit="kirimKeWA(event)">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="nama" placeholder="Nama Sesuai KTP" required>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label class="form-label">NIK (16 Digit) <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="nik" placeholder="Masukkan NIK" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Nomor WhatsApp <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="whatsapp" placeholder="0812xxxx" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Email <small class="text-muted fw-normal">(Opsional)</small></label>
                                            <input type="email" class="form-control" id="email" placeholder="nama@email.com">
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Alamat Lengkap <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="alamat" rows="2" placeholder="Desa, Kecamatan, Kabupaten..." required></textarea>
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Isi Laporan / Perihal <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="perihal" rows="4" placeholder="Tuliskan detail laporan Anda di sini..." required></textarea>
                                        </div>

                                        <div class="col-12 mt-4">
                                            <button type="submit" class="btn btn-wa">
                                                <i class="fab fa-whatsapp fa-lg"></i> KIRIM SEKARANG
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Lokasi Kami dengan Peta Leaflet -->
    <section id="lokasi" class="lokasi-section">
        <div class="container">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Lokasi Kami</span>
                <h2 class="display-6 mt-2">Kunjungi Kantor Kami</h2>
                <div style="width: 80px; height: 4px; background: var(--primary); margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Dinas Peternakan dan Perikanan Kabupaten Situbondo siap melayani Anda.</p>
            </div>

            <div class="row align-items-center g-5">
                <div class="col-lg-6" data-aos="fade-right">
                    <div class="lokasi-info">
                        <h4 class="fw-bold"><i class="fas fa-map-pin me-2 text-primary"></i>Alamat Kantor</h4>
                        <p><i class="fas fa-map-marker-alt me-2 text-primary"></i> Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur 68312</p>
                        <p><i class="fas fa-phone-alt me-2 text-primary"></i> 0878-6561-4222</p>
                        <p><i class="fas fa-clock me-2 text-primary"></i> Senin - Jumat: 08.00 - 15.00 WIB</p>
                        <div class="mt-4">
                            <a href="https://www.google.com/maps/dir/?api=1&destination=-7.7069,113.6347" target="_blank" class="btn btn-cta btn-pulse-primary" id="routeBtn">
                                <i class="fas fa-route me-2"></i>Dapatkan Rute (Google Maps)
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6" data-aos="fade-left">
                    <div class="lokasi-map-container">
                        <div id="leafletMap"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-wave">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
                <path fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>

        <div class="container footer-content">
            <div class="row gy-5">
                <div class="col-lg-5 col-md-12">
                    <div class="d-flex align-items-center gap-3 mb-4 footer-brand">
                        <i class="fas fa-ship fa-3x text-white"></i> 
                        <div>
                            <h4 class="text-white mb-0 fw-bold footer-brand-line-1">DINAS PETERNAKAN</h4>
                            <h4 class="text-white mb-0 fw-bold footer-brand-line-2">DAN PERIKANAN</h4>
                            <small class="text-white" style="letter-spacing: 2px;">KABUPATEN SITUBONDO</small>
                        </div>
                    </div>
                    <p class="pe-lg-5" style="line-height: 1.8; color: rgba(255, 255, 255, 0.9);">
                        Berkomitmen untuk memajukan sektor perikanan tangkap dan memberdayakan masyarakat pesisir melalui pelayanan yang transparan, akuntabel, dan inovatif.
                    </p>
                    <div class="social-media-icons">
                        <a href="https://dinasperikanansitubondo.com/kegiatan/" target="_blank" class="social-icon">
                            <i class="fas fa-globe text-white"></i>
                        </a>
                        <a href="https://youtube.com/@disnakan" target="_blank" class="social-icon">
                            <i class="fab fa-youtube text-white"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <h5 class="text-white">Tautan Cepat</h5>
                    <ul class="list-unstyled footer-links mt-3">
                        <li><a href="#home"><i class="fas fa-chevron-right fa-xs text-white"></i> Beranda</a></li>
                        <li><a href="#layanan"><i class="fas fa-chevron-right fa-xs text-white"></i> Layanan Kami</a></li>
                        <li><a href="#statistik"><i class="fas fa-chevron-right fa-xs text-white"></i> SIMPADAN TANGKAP</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/kegiatan/" target="_blank"><i class="fas fa-chevron-right fa-xs text-white"></i> Dokumentasi Kegiatan</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/peraturankkp" target="_blank"><i class="fas fa-chevron-right fa-xs text-white"></i> Peraturan KKP</a></li>
                        <li><a href="https://situbondokab.go.id/" target="_blank"><i class="fas fa-chevron-right fa-xs text-white"></i> Pemkab Situbondo</a></li>
                    </ul>
                </div>

                <div class="col-lg-4 col-md-6">
                    <h5 class="text-white">Kontak Kami</h5>
                    <div class="mt-3">
                        <div class="contact-item clickable" id="alamatKantor">
                            <div class="contact-icon">
                                <i class="fas fa-map-marker-alt text-white"></i>
                            </div>
                            <div class="contact-item-content">
                                <span class="text-white">Alamat Kantor</span>
                                <small class="text-white" style="opacity: 0.9;">Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur 68312</small>
                            </div>
                        </div>
                        <div class="contact-item clickable" id="whatsappContact">
                            <div class="contact-icon">
                                <i class="fas fa-phone-alt text-white"></i>
                            </div>
                            <div class="contact-item-content">
                                <span class="text-white">Telepon / WhatsApp</span>
                                <small class="text-white" style="opacity: 0.9;">0878-6561-4222</small>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-clock text-white"></i>
                            </div>
                            <div class="contact-item-content">
                                <span class="text-white">Jam Pelayanan</span>
                                <small class="text-white" style="opacity: 0.9;">Senin - Jumat: 08.00 - 15.00 WIB</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="copyright">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 text-md-start mb-2 mb-md-0">
                        &copy; 2025 <strong class="text-white">Dinas Peternakan dan Perikanan Situbondo</strong>. All Rights Reserved.
                    </div>
                    <div class="col-md-6 text-md-end">
                        <small class="text-white" style="opacity: 0.8;">Bidang Pemberdayaan Nelayan</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modal Detail Desa -->
    <div class="detail-modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detail Desa</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="modal fade lightbox-modal" id="lightboxModal" tabindex="-1" aria-labelledby="lightboxModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lightboxModalLabel">Galeri Kegiatan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="lightboxImage" src="" alt="Kegiatan" class="lightbox-image">
                </div>
                <div class="modal-footer">
                    <div class="lightbox-nav">
                        <button type="button" class="lightbox-nav-btn" id="prevBtn">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="nextBtn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="lightbox-counter">
                        <span id="currentIndex">1</span> / <span id="totalImages">9</span>
                    </div>
                    <div class="lightbox-zoom-controls">
                        <button type="button" class="lightbox-nav-btn" id="zoomInBtn">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="zoomOutBtn">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="resetZoomBtn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Script Utama -->
    <script>
        // ============================================
        // INISIALISASI AOS
        // ============================================
        AOS.init({
            once: true,
            offset: 100,
            duration: 800,
        });

        // ============================================
        // WELCOME NOTIFICATION & AUDIO PLAYER
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const welcomeNotif = document.getElementById('welcomeNotification');
                if (welcomeNotif) {
                    welcomeNotif.style.display = 'flex';
                }
            }, 500);

            const laterBtn = document.getElementById('laterButton');
            if (laterBtn) {
                laterBtn.addEventListener('click', function() {
                    closeWelcomeNotification();
                });
            }

            const playBtn = document.getElementById('playAudioButton');
            if (playBtn) {
                playBtn.addEventListener('click', function() {
                    closeWelcomeNotification();
                    showAudioPlayer();
                });
            }
        });

        function closeWelcomeNotification() {
            const welcomeNotif = document.getElementById('welcomeNotification');
            if (welcomeNotif) {
                welcomeNotif.style.display = 'none';
            }
        }

        function showAudioPlayer() {
            const audioContainer = document.getElementById('audioPlayerContainer');
            const audio = document.getElementById('audioPlayer');
            if (audioContainer) {
                audioContainer.style.display = 'block';
                audio.play().catch(e => console.log('Autoplay dicegah browser:', e));
            }
        }

        function closeAudioPlayer() {
            const audioContainer = document.getElementById('audioPlayerContainer');
            const audio = document.getElementById('audioPlayer');
            if (audio) {
                audio.pause();
                audio.currentTime = 0;
            }
            if (audioContainer) {
                audioContainer.style.display = 'none';
            }
        }

        // ============================================
        // PETA STATISTIK (SIMPADAN TANGKAP)
        // ============================================
        let statistikMap;
        let statistikMarkers = [];
        let statistikMarkerLayerGroup;
        let dataDesa = [];
        let autoReloadInterval;
        let updateCount = 0;
        let bantuanChart = null;
        let tahunChart = null;
        let isFullscreen = false;

        const APP_CONFIG = {
            autoReload: true,
            reloadInterval: 300000, // 5 menit
            showNotifications: true,
            defaultMapZoom: 10,
            situbondoCenter: [-7.7069, 113.6347],
            maxMarkers: 100
        };

        const SAMPLE_DATA = {
            metadata: {
                lastUpdate: "9 Desember 2025 pukul 23.35",
                totalDesa: 27,
                totalPenerima: 393
            },
            summary: {
                totalBantuanBarang: 424,
                totalBantuanUang: 0
            },
            data: [
                {
                    id: "1",
                    desa: "Panarukan",
                    kecamatan: "Panarukan",
                    jumlahPenerima: 45,
                    totalBantuanBarang: 50,
                    rataBantuan: 1.11,
                    koordinat: { lat: -7.7069, lng: 113.6347 },
                    tahunDistribusi: [
                        { tahun: "2023", jumlah: 20 },
                        { tahun: "2024", jumlah: 25 }
                    ],
                    jenisBantuan: [
                        { jenis: "Jaring", jumlah: 30 },
                        { jenis: "Perahu", jumlah: 5 },
                        { jenis: "Mesin", jumlah: 15 }
                    ],
                    kelompokDistribusi: [
                        { kelompok: "Nelayan Tradisional", jumlah: 30 },
                        { kelompok: "Nelayan Modern", jumlah: 15 }
                    ]
                },
                {
                    id: "2",
                    desa: "Mimbaan",
                    kecamatan: "Panarukan",
                    jumlahPenerima: 35,
                    totalBantuanBarang: 40,
                    rataBantuan: 1.14,
                    koordinat: { lat: -7.7167, lng: 113.6500 },
                    tahunDistribusi: [
                        { tahun: "2023", jumlah: 15 },
                        { tahun: "2024", jumlah: 20 }
                    ],
                    jenisBantuan: [
                        { jenis: "Jaring", jumlah: 25 },
                        { jenis: "Perahu", jumlah: 3 },
                        { jenis: "Mesin", jumlah: 12 }
                    ],
                    kelompokDistribusi: [
                        { kelompok: "Nelayan Tradisional", jumlah: 25 },
                        { kelompok: "Nelayan Modern", jumlah: 10 }
                    ]
                }
            ]
        };

        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }

        function initStatistikMap() {
            try {
                statistikMap = L.map('statistikMap').setView(APP_CONFIG.situbondoCenter, APP_CONFIG.defaultMapZoom);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 18,
                    minZoom: 8
                }).addTo(statistikMap);
                
                statistikMarkerLayerGroup = L.layerGroup().addTo(statistikMap);
                
                L.control.scale({position: 'bottomleft'}).addTo(statistikMap);
                
                setupEventListeners();
                loadData();
                
                if (APP_CONFIG.autoReload) {
                    setupAutoUpdate();
                }
                
                if (isMobileDevice()) {
                    optimizeForMobile();
                }
            } catch (error) {
                console.error('Error inisialisasi peta statistik:', error);
                showNotification('Gagal menginisialisasi peta statistik. Silakan refresh halaman.', 'error');
            }
        }

        function optimizeForMobile() {
            try {
                statistikMap.dragging.enable();
                statistikMap.touchZoom.enable();
                statistikMap.doubleClickZoom.enable();
                statistikMap.scrollWheelZoom.enable();
                statistikMap.setZoom(APP_CONFIG.defaultMapZoom - 1);
                
                const mapContainer = document.getElementById('statistikMap');
                if (mapContainer) {
                    mapContainer.style.height = '350px';
                }
                
                const btnTexts = document.querySelectorAll('.btn-text');
                btnTexts.forEach(text => {
                    if (window.innerWidth <= 400) {
                        text.style.display = 'none';
                    }
                });
            } catch (error) {
                console.error('Error optimizing for mobile:', error);
            }
        }

        function setupEventListeners() {
            try {
                document.getElementById('reloadBtn').addEventListener('click', updateData);
                document.getElementById('resetViewBtn').addEventListener('click', resetView);
                document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
                document.getElementById('reloadDataBtn').addEventListener('click', reloadDataFromFile);
                
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        this.classList.add('active');
                        const tabId = this.getAttribute('data-tab');
                        const tabContent = document.getElementById(`${tabId}-tab`);
                        if (tabContent) {
                            tabContent.classList.add('active');
                        }
                    });
                });
                
                const searchInput = document.getElementById('searchDesa');
                if (searchInput) {
                    searchInput.addEventListener('input', function(e) {
                        filterDesaList(e.target.value);
                    });
                }
                
                const modalClose = document.getElementById('modalClose');
                if (modalClose) {
                    modalClose.addEventListener('click', closeModal);
                }
                
                const detailModal = document.getElementById('detailModal');
                if (detailModal) {
                    detailModal.addEventListener('click', function(e) {
                        if (e.target === this) {
                            closeModal();
                        }
                    });
                }
                
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        closeModal();
                    }
                });
                
                document.addEventListener('fullscreenchange', handleFullscreenChange);
                document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
                document.addEventListener('mozfullscreenchange', handleFullscreenChange);
                document.addEventListener('MSFullscreenChange', handleFullscreenChange);
                
                setupTouchEvents();
            } catch (error) {
                console.error('Error setup event listeners:', error);
            }
        }

        function setupTouchEvents() {
            const petaContainer = document.querySelector('.peta-map-container');
            if (petaContainer) {
                petaContainer.addEventListener('touchstart', function(e) {
                    if (e.touches.length > 1) {
                        e.preventDefault();
                    }
                }, { passive: false });
            }
            
            document.addEventListener('touchstart', function() {}, { passive: true });
        }

        function setupAutoUpdate() {
            try {
                const autoReloadStatus = document.getElementById('autoReloadStatus');
                const footerReloadStatus = document.getElementById('footerReloadStatus');
                const reloadInterval = document.getElementById('reloadInterval');
                
                if (autoReloadStatus) autoReloadStatus.textContent = 'Aktif';
                if (footerReloadStatus) footerReloadStatus.textContent = 'Aktif';
                if (reloadInterval) reloadInterval.textContent = APP_CONFIG.reloadInterval / 1000;
                
                if (autoReloadInterval) {
                    clearInterval(autoReloadInterval);
                }
                
                autoReloadInterval = setInterval(() => {
                    try {
                        updateData();
                        updateCount++;
                        
                        if (updateCount % 5 === 0 && APP_CONFIG.showNotifications) {
                            showNotification(`Data telah diperbarui ${updateCount} kali`, 'info');
                        }
                    } catch (error) {
                        console.error('Error dalam auto-update:', error);
                    }
                }, APP_CONFIG.reloadInterval);
                
                if (APP_CONFIG.showNotifications) {
                    showNotification(`Auto-update diaktifkan. Data akan diperbarui setiap ${APP_CONFIG.reloadInterval/1000} detik.`, 'info');
                }
            } catch (error) {
                console.error('Error setup auto-update:', error);
            }
        }

        function loadData() {
            showLoading(true);
            
            setTimeout(() => {
                processData(SAMPLE_DATA);
                showLoading(false);
                loadDataFile();
            }, 1000);
        }

        function loadDataFile() {
            try {
                if (typeof DATA_PETA_STATISTIK !== 'undefined') {
                    processData(DATA_PETA_STATISTIK);
                    return;
                }
                
                const script = document.createElement('script');
                script.src = 'datapeta.js';
                script.onload = function() {
                    if (typeof DATA_PETA_STATISTIK !== 'undefined') {
                        processData(DATA_PETA_STATISTIK);
                    }
                };
                script.onerror = function() {
                    console.log('File datapeta.js tidak ditemukan, menggunakan data sample');
                };
                document.head.appendChild(script);
            } catch (error) {
                console.error('Error loading data file:', error);
            }
        }

        async function reloadDataFromFile() {
            try {
                showLoading(true);
                showNotification('Sedang memuat data dari file eksternal...', 'info');
                
                const response = await fetch('reload.js?t=' + new Date().getTime());
                if (response.ok) {
                    const jsContent = await response.text();
                    
                    try {
                        eval(jsContent);
                        
                        if (typeof RELOAD_DATA !== 'undefined') {
                            processData(RELOAD_DATA);
                            showNotification('Data berhasil dimuat dari file reload.js', 'success');
                        } else {
                            const jsonMatch = jsContent.match(/const\s+RELOAD_DATA\s*=\s*(\{[\s\S]*?\});/);
                            if (jsonMatch) {
                                const data = JSON.parse(jsonMatch[1]);
                                processData(data);
                                showNotification('Data berhasil dimuat dari file reload.js', 'success');
                            } else {
                                throw new Error('Format data tidak dikenali');
                            }
                        }
                    } catch (evalError) {
                        console.error('Error parsing data dari reload.js:', evalError);
                        await loadReloadHTML();
                    }
                } else {
                    await loadReloadHTML();
                }
            } catch (error) {
                console.error('Error reloading data dari file:', error);
                showNotification('Gagal memuat data dari file eksternal. Menggunakan data yang tersedia.', 'error');
                processData(SAMPLE_DATA);
            } finally {
                showLoading(false);
            }
        }

        async function loadReloadHTML() {
            try {
                const response = await fetch('reload.html?t=' + new Date().getTime());
                if (response.ok) {
                    const htmlContent = await response.text();
                    
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlContent, 'text/html');
                    
                    const dataElement = doc.querySelector('#data-content');
                    if (dataElement) {
                        const dataText = dataElement.textContent;
                        try {
                            const data = JSON.parse(dataText);
                            processData(data);
                            showNotification('Data berhasil dimuat dari file reload.html', 'success');
                        } catch (parseError) {
                            throw new Error('Format data tidak valid di reload.html');
                        }
                    } else {
                        throw new Error('Tidak ditemukan data di reload.html');
                    }
                } else {
                    throw new Error('File reload.html tidak ditemukan');
                }
            } catch (error) {
                console.error('Error loading reload.html:', error);
                throw error;
            }
        }

        function processData(data) {
            try {
                if (!data || !Array.isArray(data.data)) {
                    console.log('Menggunakan data sample');
                    data = SAMPLE_DATA;
                }
                
                dataDesa = data.data || [];
                
                updateElementText('lastUpdate', data.metadata?.lastUpdate || '9 Desember 2025');
                updateElementText('totalDesa', data.metadata?.totalDesa || '27');
                updateElementText('totalPenerima', data.metadata?.totalPenerima || '393');
                updateElementText('totalBantuan', data.summary?.totalBantuanBarang || '424');
                updateElementText('footerUpdate', data.metadata?.lastUpdate || '9 Desember 2025 pukul 23.35');
                
                updateElementText('summaryDesa', data.metadata?.totalDesa || '27');
                updateElementText('summaryPenerima', data.metadata?.totalPenerima || '393');
                updateElementText('summaryBarang', data.summary?.totalBantuanBarang || '424');
                updateElementText('summaryUang', data.summary?.totalBantuanUang || '0');
                
                displayTopDesa(dataDesa);
                displayDesaList(dataDesa);
                displayMapMarkers(dataDesa);
                updateCharts(dataDesa);
                
                const now = new Date();
                const formattedDate = now.toLocaleDateString('id-ID', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                updateElementText('lastUpdate', formattedDate);
                updateElementText('footerUpdate', formattedDate);
                
                if (APP_CONFIG.showNotifications) {
                    showNotification('Data berhasil dimuat', 'success');
                }
            } catch (error) {
                console.error('Error processing data:', error);
                showNotification('Terjadi kesalahan saat memproses data.', 'error');
            }
        }

        function updateElementText(elementId, text) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = text;
            }
        }

        function displayTopDesa(desaData) {
            try {
                const topDesaList = document.getElementById('topDesaList');
                if (!topDesaList) return;
                
                topDesaList.innerHTML = '';
                
                if (!Array.isArray(desaData) || desaData.length === 0) {
                    topDesaList.innerHTML = '<p style="text-align: center; color: var(--gray-color); padding: 20px;">Data tidak tersedia</p>';
                    return;
                }
                
                const sortedDesa = [...desaData]
                    .sort((a, b) => (b.jumlahPenerima || 0) - (a.jumlahPenerima || 0))
                    .slice(0, 5);
                
                sortedDesa.forEach((desa, index) => {
                    const desaItem = document.createElement('div');
                    desaItem.className = 'desa-item';
                    
                    let rankBadge = '';
                    if (index === 0) rankBadge = '<span style="background: gold; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;"><i class="fas fa-crown"></i> 1</span>';
                    else if (index === 1) rankBadge = '<span style="background: silver; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">2</span>';
                    else if (index === 2) rankBadge = '<span style="background: #cd7f32; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">3</span>';
                    else rankBadge = `<span style="background: var(--primary); color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">${index + 1}</span>`;
                    
                    desaItem.innerHTML = `
                        <div>
                            <div class="desa-name">${rankBadge} ${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'}</div>
                            <div class="desa-details">
                                <span><i class="fas fa-users"></i> ${desa.jumlahPenerima || 0} Penerima</span>
                                <span><i class="fas fa-box"></i> ${desa.totalBantuanBarang || 0} Unit</span>
                            </div>
                        </div>
                        <div>
                            <button class="control-btn" style="padding: 8px 12px; font-size: 0.9rem;" data-id="${desa.id || ''}">
                                <i class="fas fa-info-circle"></i> Detail
                            </button>
                        </div>
                    `;
                    
                    desaItem.addEventListener('click', function(e) {
                        if (!e.target.closest('button')) {
                            zoomToDesa(desa.id);
                        }
                    });
                    
                    const detailBtn = desaItem.querySelector('button');
                    detailBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        showDesaDetail(desa.id);
                    });
                    
                    topDesaList.appendChild(desaItem);
                });
            } catch (error) {
                console.error('Error displaying top desa:', error);
            }
        }

        function displayDesaList(desaData) {
            try {
                const desaList = document.getElementById('desaList');
                if (!desaList) return;
                
                desaList.innerHTML = '';
                
                if (!Array.isArray(desaData) || desaData.length === 0) {
                    desaList.innerHTML = '<div class="desa-item" style="justify-content: center;"><span>Data tidak tersedia</span></div>';
                    return;
                }
                
                const sortedDesa = [...desaData].sort((a, b) => (b.jumlahPenerima || 0) - (a.jumlahPenerima || 0));
                
                sortedDesa.forEach(desa => {
                    const desaItem = document.createElement('div');
                    desaItem.className = 'desa-item';
                    desaItem.dataset.id = desa.id || '';
                    
                    let tahunText = 'N/A';
                    if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                        tahunText = desa.tahunDistribusi.map(t => t.tahun).filter(t => t).join(', ');
                    }
                    
                    desaItem.innerHTML = `
                        <div>
                            <div class="desa-name">${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'}</div>
                            <div class="desa-details">
                                <span><i class="fas fa-calendar"></i> ${tahunText}</span>
                            </div>
                        </div>
                        <div>
                            <span style="background: ${getColorByPenerima(desa.jumlahPenerima || 0)}; color: white; padding: 5px 12px; border-radius: 20px; font-weight: bold;">
                                ${desa.jumlahPenerima || 0}
                            </span>
                        </div>
                    `;
                    
                    desaItem.addEventListener('click', function() {
                        zoomToDesa(desa.id);
                    });
                    
                    desaList.appendChild(desaItem);
                });
            } catch (error) {
                console.error('Error displaying desa list:', error);
            }
        }

        function filterDesaList(query) {
            try {
                const desaItems = document.querySelectorAll('#desaList .desa-item');
                const lowerQuery = query.toLowerCase().trim();
                
                desaItems.forEach(item => {
                    const desaName = item.querySelector('.desa-name')?.textContent.toLowerCase() || '';
                    if (desaName.includes(lowerQuery) || query === '') {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            } catch (error) {
                console.error('Error filtering desa list:', error);
            }
        }

        function displayMapMarkers(desaData) {
            try {
                if (statistikMarkerLayerGroup) {
                    statistikMarkerLayerGroup.clearLayers();
                }
                statistikMarkers = [];
                
                if (!Array.isArray(desaData) || desaData.length === 0) return;
                
                const displayData = desaData.slice(0, APP_CONFIG.maxMarkers);
                
                displayData.forEach(desa => {
                    if (!desa.koordinat || !desa.koordinat.lat || !desa.koordinat.lng) {
                        return;
                    }
                    
                    const markerColor = getColorByPenerima(desa.jumlahPenerima || 0);
                    
                    const markerIcon = L.divIcon({
                        html: `<div style="
                            background: ${markerColor};
                            width: 32px;
                            height: 32px;
                            border-radius: 50%;
                            border: 3px solid white;
                            box-shadow: 0 0 15px rgba(0,0,0,0.3);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-weight: bold;
                            font-size: 12px;
                            cursor: pointer;
                            font-family: var(--font-head);
                            transition: all 0.3s ease;
                        ">${desa.jumlahPenerima || 0}</div>`,
                        className: 'custom-marker',
                        iconSize: [35, 35],
                        iconAnchor: [17.5, 17.5]
                    });
                    
                    const marker = L.marker([desa.koordinat.lat, desa.koordinat.lng], {
                        icon: markerIcon,
                        title: `${desa.desa || 'N/A'}, ${desa.kecamatan || 'N/A'} - ${desa.jumlahPenerima || 0} penerima`
                    });
                    
                    const popupContent = createPopupContent(desa);
                    marker.bindPopup(popupContent);
                    
                    marker.on('click', function() {
                        highlightDesa(desa.id);
                    });
                    
                    if (statistikMarkerLayerGroup) {
                        marker.addTo(statistikMarkerLayerGroup);
                    }
                    
                    statistikMarkers.push({
                        id: desa.id || '',
                        marker: marker,
                        desa: desa
                    });
                });
                
                if (statistikMarkers.length > 0 && statistikMap) {
                    const markerBounds = L.latLngBounds(statistikMarkers.map(m => {
                        if (m.marker && m.marker.getLatLng) {
                            return m.marker.getLatLng();
                        }
                        return APP_CONFIG.situbondoCenter;
                    }));
                    
                    if (markerBounds.isValid()) {
                        const maxZoom = isMobileDevice() ? 11 : 12;
                        statistikMap.fitBounds(markerBounds, { padding: [50, 50], maxZoom: maxZoom });
                    }
                }
            } catch (error) {
                console.error('Error displaying map markers:', error);
            }
        }

        function createPopupContent(desa) {
            const desaName = desa.desa || 'N/A';
            const kecamatan = desa.kecamatan || 'N/A';
            const jumlahPenerima = desa.jumlahPenerima || 0;
            const totalBantuanBarang = desa.totalBantuanBarang || 0;
            
            return `
                <div style="max-width: 300px;">
                    <h3 style="margin: 0 0 10px 0; color: var(--primary); font-family: var(--font-head); font-size: ${isMobileDevice() ? '1.1rem' : '1.2rem'};">${desaName}, ${kecamatan}</h3>
                    <p><strong><i class="fas fa-users" style="color: var(--accent);"></i> Jumlah Penerima:</strong> ${jumlahPenerima} orang</p>
                    <p><strong><i class="fas fa-box" style="color: #f59e0b;"></i> Total Bantuan Barang:</strong> ${totalBantuanBarang} unit</p>
                    <hr style="margin: 15px 0;">
                    <div style="text-align: center;">
                        <button onclick="window.showDesaDetail('${desa.id || ''}')" style="
                            background: linear-gradient(135deg, var(--accent), var(--primary));
                            color: white;
                            border: none;
                            padding: 10px 18px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: bold;
                            width: 100%;
                            font-family: var(--font-head);
                            transition: all 0.3s ease;
                            font-size: ${isMobileDevice() ? '0.9rem' : '1rem'};
                            min-height: 44px;
                        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(245, 158, 11, 0.3)'" 
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                            <i class="fas fa-info-circle"></i> Lihat Detail Lengkap
                        </button>
                    </div>
                </div>
            `;
        }

        function getColorByPenerima(jumlah) {
            if (jumlah >= 50) return 'var(--danger-color)';
            if (jumlah >= 20) return 'var(--warning-color)';
            return 'var(--success-color)';
        }

        function zoomToDesa(desaId) {
            try {
                const selectedMarker = statistikMarkers.find(m => m.id === desaId);
                if (selectedMarker && selectedMarker.marker && statistikMap) {
                    const zoomLevel = isMobileDevice() ? 12 : 13;
                    statistikMap.setView(selectedMarker.marker.getLatLng(), zoomLevel);
                    selectedMarker.marker.openPopup();
                    highlightDesa(desaId);
                }
            } catch (error) {
                console.error('Error zooming to desa:', error);
            }
        }

        function highlightDesa(desaId) {
            try {
                statistikMarkers.forEach(m => {
                    if (m.marker && m.marker.getElement) {
                        const markerEl = m.marker.getElement();
                        if (markerEl) {
                            markerEl.style.transform = 'scale(1)';
                            markerEl.style.zIndex = '1';
                        }
                    }
                });
                
                const selectedMarker = statistikMarkers.find(m => m.id === desaId);
                if (selectedMarker && selectedMarker.marker && selectedMarker.marker.getElement) {
                    const markerEl = selectedMarker.marker.getElement();
                    if (markerEl) {
                        markerEl.style.transform = 'scale(1.4)';
                        markerEl.style.zIndex = '1000';
                        markerEl.style.boxShadow = '0 0 20px rgba(0,0,0,0.5)';
                    }
                    
                    highlightDesaListItem(desaId);
                }
            } catch (error) {
                console.error('Error highlighting desa:', error);
            }
        }

        function highlightDesaListItem(desaId) {
            try {
                const desaItems = document.querySelectorAll('.desa-item');
                desaItems.forEach(item => {
                    item.classList.remove('active');
                });
                
                const selectedItem = document.querySelector(`.desa-item[data-id="${desaId}"]`);
                if (selectedItem) {
                    selectedItem.classList.add('active');
                    selectedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            } catch (error) {
                console.error('Error highlighting desa list item:', error);
            }
        }

        function showDesaDetail(desaId) {
            try {
                const desaData = dataDesa.find(d => d.id === desaId);
                if (!desaData) {
                    showNotification('Data desa tidak ditemukan.', 'error');
                    return;
                }
                
                const modalTitle = document.getElementById('modalTitle');
                if (modalTitle) {
                    modalTitle.textContent = `${desaData.desa || 'N/A'}, ${desaData.kecamatan || 'N/A'}`;
                }
                
                let modalHtml = `
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-item-title">Jumlah Penerima</div>
                            <div class="detail-item-value">${desaData.jumlahPenerima || 0} orang</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">Total Bantuan Barang</div>
                            <div class="detail-item-value">${desaData.totalBantuanBarang || 0} unit</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">Rata-rata Bantuan</div>
                            <div class="detail-item-value">${desaData.rataBantuan ? desaData.rataBantuan.toFixed(2) : '0.00'} unit/orang</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('modalBody').innerHTML = modalHtml;
                document.getElementById('detailModal').classList.add('active');
            } catch (error) {
                console.error('Error showing desa detail:', error);
                showNotification('Terjadi kesalahan saat menampilkan detail desa.', 'error');
            }
        }

        function closeModal() {
            try {
                document.getElementById('detailModal').classList.remove('active');
            } catch (error) {
                console.error('Error closing modal:', error);
            }
        }

        function updateData() {
            try {
                showLoading(true);
                setTimeout(() => {
                    loadData();
                    showNotification('Data berhasil diperbarui', 'success');
                }, 1000);
            } catch (error) {
                console.error('Error updating data:', error);
                showLoading(false);
                showNotification('Gagal memperbarui data.', 'error');
            }
        }

        function resetView() {
            try {
                if (statistikMap) {
                    const zoomLevel = isMobileDevice() ? APP_CONFIG.defaultMapZoom - 1 : APP_CONFIG.defaultMapZoom;
                    statistikMap.setView(APP_CONFIG.situbondoCenter, zoomLevel);
                }
                
                const desaItems = document.querySelectorAll('.desa-item');
                desaItems.forEach(item => {
                    item.classList.remove('active');
                });
                
                statistikMarkers.forEach(m => {
                    if (m.marker && m.marker.getElement) {
                        const markerEl = m.marker.getElement();
                        if (markerEl) {
                            markerEl.style.transform = 'scale(1)';
                            markerEl.style.zIndex = '1';
                        }
                        if (m.marker.closePopup) {
                            m.marker.closePopup();
                        }
                    }
                });
            } catch (error) {
                console.error('Error resetting view:', error);
            }
        }

        function toggleFullscreen() {
            try {
                const container = document.querySelector('.peta-statistik-container');
                if (!container) return;
                
                if (!isFullscreen) {
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) {
                        container.webkitRequestFullscreen();
                    } else if (container.mozRequestFullScreen) {
                        container.mozRequestFullScreen();
                    } else if (container.msRequestFullscreen) {
                        container.msRequestFullscreen();
                    }
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            } catch (error) {
                console.error('Error toggling fullscreen:', error);
            }
        }

        function handleFullscreenChange() {
            try {
                isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || 
                                document.mozFullScreenElement || document.msFullscreenElement);
                
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                if (fullscreenBtn) {
                    if (isFullscreen) {
                        fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i> <span class="btn-text">Keluar Layar Penuh</span>';
                    } else {
                        fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i> <span class="btn-text">Layar Penuh</span>';
                    }
                }
            } catch (error) {
                console.error('Error handling fullscreen change:', error);
            }
        }

        function updateCharts(desaData) {
            try {
                const bantuanLabels = ['Tinggi (≥50)', 'Sedang (20-49)', 'Rendah (≤19)'];
                const bantuanCounts = [0, 0, 0];
                
                if (Array.isArray(desaData)) {
                    desaData.forEach(desa => {
                        const jumlah = desa.jumlahPenerima || 0;
                        if (jumlah >= 50) bantuanCounts[0]++;
                        else if (jumlah >= 20) bantuanCounts[1]++;
                        else bantuanCounts[2]++;
                    });
                }
                
                if (bantuanChart) bantuanChart.destroy();
                if (tahunChart) tahunChart.destroy();
                
                const bantuanCtx = document.getElementById('bantuanChart');
                if (bantuanCtx) {
                    bantuanChart = new Chart(bantuanCtx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: bantuanLabels,
                            datasets: [{
                                data: bantuanCounts,
                                backgroundColor: ['#ff6b6b', '#ffd166', '#06d6a0'],
                                borderWidth: 3,
                                borderColor: 'white',
                                hoverBorderWidth: 4,
                                hoverBorderColor: '#f1f5f9'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: '#475569',
                                        font: {
                                            family: 'var(--font-body)',
                                            size: isMobileDevice() ? 10 : 12,
                                            weight: '600'
                                        },
                                        padding: 15
                                    }
                                }
                            },
                            cutout: '65%'
                        }
                    });
                }
                
                const tahunCtx = document.getElementById('tahunChart');
                if (tahunCtx) {
                    tahunChart = new Chart(tahunCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['2023', '2024', '2025'],
                            datasets: [{
                                label: 'Jumlah Penerima',
                                data: [150, 200, 250],
                                backgroundColor: 'rgba(245, 158, 11, 0.8)',
                                borderColor: '#f59e0b',
                                borderWidth: 2,
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 50
                                    }
                                }
                            }
                        }
                    });
                }
            } catch (error) {
                console.error('Error updating charts:', error);
            }
        }

        function showLoading(show) {
            try {
                const loadingScreen = document.getElementById('loadingScreen');
                if (!loadingScreen) return;
                
                if (show) {
                    loadingScreen.classList.remove('hidden');
                } else {
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                    }, 500);
                }
            } catch (error) {
                console.error('Error showing loading:', error);
            }
        }

        function showNotification(message, type = 'info') {
            try {
                if (!APP_CONFIG.showNotifications) return;
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                
                let icon = 'info-circle';
                if (type === 'success') icon = 'check-circle';
                else if (type === 'error') icon = 'exclamation-circle';
                else if (type === 'warning') icon = 'exclamation-triangle';
                
                notification.innerHTML = `<i class="fas fa-${icon}"></i><span>${message}</span>`;
                
                if (type === 'success') {
                    notification.style.background = 'linear-gradient(135deg, #06d6a0, #059669)';
                } else if (type === 'error') {
                    notification.style.background = 'linear-gradient(135deg, #ff6b6b, #dc2626)';
                } else if (type === 'warning') {
                    notification.style.background = 'linear-gradient(135deg, #ffd166, #f59e0b)';
                } else {
                    notification.style.background = 'linear-gradient(135deg, var(--accent), var(--primary))';
                }
                notification.style.color = 'white';
                notification.style.position = 'fixed';
                notification.style.top = '20px';
                notification.style.right = '20px';
                notification.style.padding = '12px 24px';
                notification.style.borderRadius = '50px';
                notification.style.boxShadow = '0 10px 20px rgba(0,0,0,0.2)';
                notification.style.zIndex = '1000000';
                notification.style.display = 'flex';
                notification.style.alignItems = 'center';
                notification.style.gap = '10px';
                notification.style.fontWeight = '600';
                notification.style.maxWidth = '300px';
                notification.style.animation = 'slideIn 0.3s ease';
                
                if (isMobileDevice()) {
                    notification.style.top = '15px';
                    notification.style.right = '15px';
                    notification.style.left = '15px';
                    notification.style.maxWidth = 'none';
                }
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 4000);
            } catch (error) {
                console.error('Error showing notification:', error);
            }
        }

        // ============================================
        // PETA LOKASI KANTOR (LEAFLET)
        // ============================================
        function initLokasiMap() {
            try {
                const kantorLat = -7.7069;
                const kantorLng = 113.6347;

                // Pastikan elemen peta sudah ada
                const mapElement = document.getElementById('leafletMap');
                if (!mapElement) {
                    console.error('Elemen #leafletMap tidak ditemukan');
                    return;
                }

                const map = L.map('leafletMap').setView([kantorLat, kantorLng], 16);

                // Gunakan tile layer yang stabil
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; CartoDB',
                    subdomains: 'abcd',
                    maxZoom: 19
                }).addTo(map);

                // Ikon kustom
                const customIcon = L.divIcon({
                    html: `<div style="
                        background: linear-gradient(135deg, #f97316, #f59e0b);
                        width: 50px;
                        height: 50px;
                        border-radius: 50%;
                        border: 4px solid white;
                        box-shadow: 0 10px 20px rgba(0,0,0,0.3);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-size: 24px;
                    "><i class="fas fa-map-pin"></i></div>`,
                    className: 'custom-marker-lokasi',
                    iconSize: [50, 50],
                    iconAnchor: [25, 50],
                    popupAnchor: [0, -45]
                });

                const marker = L.marker([kantorLat, kantorLng], { icon: customIcon }).addTo(map);

                marker.bindPopup(`
                    <div style="font-family: 'Outfit', sans-serif; text-align: center;">
                        <h4 style="margin: 5px 0; color: #1e3a8a;">Dinas Peternakan dan Perikanan</h4>
                        <p style="margin: 5px 0;"><i class="fas fa-map-marker-alt" style="color: #f97316;"></i> Jl. PB Sudirman No.77 C, Situbondo</p>
                        <p style="margin: 5px 0;"><i class="fas fa-phone-alt" style="color: #f97316;"></i> 0878-6561-4222</p>
                        <a href="https://www.google.com/maps/dir/?api=1&destination=${kantorLat},${kantorLng}" target="_blank" style="display: inline-block; margin-top: 10px; background: #f97316; color: white; padding: 8px 16px; border-radius: 30px; text-decoration: none; font-weight: bold;">Rute ke sini</a>
                    </div>
                `).openPopup();

                L.control.scale({ position: 'bottomleft' }).addTo(map);

                // Paksa peta untuk menyesuaikan ukuran setelah ditampilkan
                setTimeout(() => {
                    map.invalidateSize();
                }, 200);
            } catch (error) {
                console.error('Error inisialisasi peta lokasi:', error);
                // Tampilkan pesan error di elemen peta
                const mapElement = document.getElementById('leafletMap');
                if (mapElement) {
                    mapElement.innerHTML = '<div style="padding: 20px; text-align: center; background: #fee; color: #c00;">Gagal memuat peta. Silakan refresh halaman.</div>';
                }
            }
        }

        // ============================================
        // FUNGSI UMUM WEBSITE
        // ============================================
        function kirimKeWA(e) {
            e.preventDefault();

            try {
                let nama = document.getElementById('nama').value.trim();
                let nik = document.getElementById('nik').value.trim();
                let wa = document.getElementById('whatsapp').value.trim();
                let email = document.getElementById('email').value.trim() || '-';
                let alamat = document.getElementById('alamat').value.trim();
                let perihal = document.getElementById('perihal').value.trim();

                if (!nama || !nik || !wa || !alamat || !perihal) {
                    showNotification('Harap isi semua field yang wajib diisi!', 'error');
                    return;
                }

                let targetNumber = "6287865614222"; 

                let pesan = `*LAPORAN PENGADUAN NELAYAN*%0A` +
                            `--------------------------------%0A` +
                            `*Nama:* ${nama}%0A` +
                            `*NIK:* ${nik}%0A` +
                            `*Alamat:* ${alamat}%0A` +
                            `*No. WA:* ${wa}%0A` +
                            `*Email:* ${email}%0A` +
                            `--------------------------------%0A` +
                            `*Perihal / Isi Laporan:*%0A` +
                            `${perihal}`;

                let url = `https://api.whatsapp.com/send?phone=${targetNumber}&text=${pesan}`;
                window.open(url, '_blank');
                
                document.getElementById('waForm').reset();
                showNotification('Formulir berhasil dikirim!', 'success');
            } catch (error) {
                console.error('Error sending WhatsApp message:', error);
                showNotification('Terjadi kesalahan saat mengirim formulir.', 'error');
            }
        }

        // Efek Navbar saat scroll
        window.addEventListener('scroll', function() {
            try {
                const nav = document.getElementById('mainNav');
                if (!nav) return;
                
                if (window.scrollY > 50) {
                    nav.style.boxShadow = "0 10px 30px rgba(0,0,0,0.1)";
                    nav.style.background = "rgba(255, 255, 255, 0.98)";
                } else {
                    nav.style.boxShadow = "0 4px 20px rgba(0,0,0,0.05)";
                    nav.style.background = "rgba(255, 255, 255, 0.95)";
                }
            } catch (error) {
                console.error('Error in scroll handler:', error);
            }
        });

        // Lightbox functionality
        const photoUrls = [
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg'
        ];

        let currentIndex = 0;
        let zoomLevel = 1;
        const maxZoom = 3;
        const minZoom = 1;
        const zoomStep = 0.2;

        function openLightbox(index) {
            try {
                if (index < 0 || index >= photoUrls.length) return;
                
                currentIndex = index;
                updateLightbox();
                const lightboxModal = new bootstrap.Modal(document.getElementById('lightboxModal'));
                lightboxModal.show();
            } catch (error) {
                console.error('Error opening lightbox:', error);
            }
        }

        function updateLightbox() {
            try {
                const lightboxImage = document.getElementById('lightboxImage');
                const currentIndexElement = document.getElementById('currentIndex');
                const totalImagesElement = document.getElementById('totalImages');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (!lightboxImage) return;
                
                zoomLevel = 1;
                lightboxImage.style.transform = `scale(${zoomLevel})`;
                
                lightboxImage.src = photoUrls[currentIndex];
                lightboxImage.alt = `Kegiatan ${currentIndex + 1}`;
                
                if (currentIndexElement) currentIndexElement.textContent = currentIndex + 1;
                if (totalImagesElement) totalImagesElement.textContent = photoUrls.length;
                
                if (prevBtn) prevBtn.disabled = currentIndex === 0;
                if (nextBtn) nextBtn.disabled = currentIndex === photoUrls.length - 1;
                
                const modalLabel = document.getElementById('lightboxModalLabel');
                if (modalLabel) modalLabel.textContent = `Galeri Kegiatan - Foto ${currentIndex + 1}`;
            } catch (error) {
                console.error('Error updating lightbox:', error);
            }
        }

        function navigateLightbox(direction) {
            try {
                if (direction === 'prev' && currentIndex > 0) {
                    currentIndex--;
                } else if (direction === 'next' && currentIndex < photoUrls.length - 1) {
                    currentIndex++;
                }
                updateLightbox();
            } catch (error) {
                console.error('Error navigating lightbox:', error);
            }
        }

        function zoomImage(action) {
            try {
                const lightboxImage = document.getElementById('lightboxImage');
                if (!lightboxImage) return;
                
                if (action === 'in' && zoomLevel < maxZoom) {
                    zoomLevel += zoomStep;
                } else if (action === 'out' && zoomLevel > minZoom) {
                    zoomLevel -= zoomStep;
                } else if (action === 'reset') {
                    zoomLevel = 1;
                }
                
                zoomLevel = Math.max(minZoom, Math.min(maxZoom, zoomLevel));
                lightboxImage.style.transform = `scale(${zoomLevel})`;
                lightboxImage.style.transition = 'transform 0.3s ease';
            } catch (error) {
                console.error('Error zooming image:', error);
            }
        }

        // Smooth scroll untuk navigasi
        function setupSmoothScroll() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href === '#') return;
                    
                    const targetElement = document.querySelector(href);
                    if (targetElement) {
                        e.preventDefault();
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        document.querySelectorAll('.nav-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        this.classList.add('active');
                    }
                });
            });
        }

        // Fungsi copy dan share
        function copyToClipboard(text) {
            try {
                navigator.clipboard.writeText(text)
                    .then(() => {
                        showNotification('Link telah disalin ke clipboard!', 'success');
                    })
                    .catch(err => {
                        console.error('Gagal menyalin: ', err);
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        showNotification('Link telah disalin ke clipboard!', 'success');
                    });
            } catch (error) {
                console.error('Error copying to clipboard:', error);
                showNotification('Gagal menyalin link', 'error');
            }
        }

        function shareViaWhatsApp(url, title) {
            try {
                const text = `Lihat ${title}: ${url}`;
                const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`;
                window.open(whatsappUrl, '_blank');
                showNotification('Membuka WhatsApp untuk berbagi...', 'info');
            } catch (error) {
                console.error('Error sharing via WhatsApp:', error);
                showNotification('Gagal membagikan via WhatsApp', 'error');
            }
        }

        function setupImprovedShareButtons() {
            try {
                document.addEventListener('click', function(e) {
                    if (e.target.closest('.share-btn-copy')) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const shareBtn = e.target.closest('.share-btn-copy');
                        const url = shareBtn.getAttribute('data-url');
                        
                        if (url) {
                            copyToClipboard(url);
                        }
                    }
                    
                    if (e.target.closest('.share-btn-whatsapp')) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const shareBtn = e.target.closest('.share-btn-whatsapp');
                        const url = shareBtn.getAttribute('data-url');
                        const title = shareBtn.getAttribute('data-title') || 'Dinas Peternakan dan Perikanan Situbondo';
                        
                        if (url) {
                            shareViaWhatsApp(url, title);
                        }
                    }
                });
                
                console.log('Improved share buttons setup completed');
            } catch (error) {
                console.error('Error setting up improved share buttons:', error);
            }
        }

        // Fitur klik alamat dan WhatsApp di footer
        function setupFooterClickFeatures() {
            try {
                const alamatKantor = document.getElementById('alamatKantor');
                if (alamatKantor) {
                    alamatKantor.addEventListener('click', function(e) {
                        e.preventDefault();
                        window.open('https://maps.app.goo.gl/BxSQYHqFU5QstT2m8', '_blank');
                    });
                }
                
                const whatsappContact = document.getElementById('whatsappContact');
                if (whatsappContact) {
                    whatsappContact.addEventListener('click', function(e) {
                        e.preventDefault();
                        const phoneNumber = '6287865614222';
                        const message = 'Halo, saya ingin informasi lebih lanjut tentang Dinas Peternakan dan Perikanan Situbondo.';
                        const whatsappUrl = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodeURIComponent(message)}`;
                        window.open(whatsappUrl, '_blank');
                    });
                }
            } catch (error) {
                console.error('Error setting up footer click features:', error);
            }
        }

        // ============================================
        // INISIALISASI SEMUA SAAT DOM READY
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Inisialisasi peta statistik
                initStatistikMap();
                
                // Inisialisasi peta lokasi kantor
                initLokasiMap();
                
                // Setup smooth scroll
                setupSmoothScroll();
                
                // Setup footer click
                setupFooterClickFeatures();
                
                // Setup share buttons
                setupImprovedShareButtons();
                
                // Setup event listener untuk lightbox
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (prevBtn) {
                    prevBtn.addEventListener('click', () => navigateLightbox('prev'));
                }
                
                if (nextBtn) {
                    nextBtn.addEventListener('click', () => navigateLightbox('next'));
                }
                
                const zoomInBtn = document.getElementById('zoomInBtn');
                const zoomOutBtn = document.getElementById('zoomOutBtn');
                const resetZoomBtn = document.getElementById('resetZoomBtn');
                
                if (zoomInBtn) {
                    zoomInBtn.addEventListener('click', () => zoomImage('in'));
                }
                
                if (zoomOutBtn) {
                    zoomOutBtn.addEventListener('click', () => zoomImage('out'));
                }
                
                if (resetZoomBtn) {
                    resetZoomBtn.addEventListener('click', () => zoomImage('reset'));
                }
                
                // Keyboard navigation untuk lightbox
                document.addEventListener('keydown', function(e) {
                    const lightboxModal = document.getElementById('lightboxModal');
                    if (lightboxModal && lightboxModal.classList.contains('show')) {
                        if (e.key === 'ArrowLeft') {
                            navigateLightbox('prev');
                        } else if (e.key === 'ArrowRight') {
                            navigateLightbox('next');
                        } else if (e.key === 'Escape') {
                            const modal = bootstrap.Modal.getInstance(lightboxModal);
                            if (modal) modal.hide();
                        } else if (e.key === '+' || e.key === '=') {
                            zoomImage('in');
                            e.preventDefault();
                        } else if (e.key === '-' || e.key === '_') {
                            zoomImage('out');
                            e.preventDefault();
                        } else if (e.key === '0') {
                            zoomImage('reset');
                        }
                    }
                });
                
                // Notifikasi selamat datang
                setTimeout(() => {
                    showNotification('Website Pemberdayaan Nelayan Situbondo dimuat', 'success');
                }, 1500);
                
                // Perbaiki ukuran peta saat resize
                window.addEventListener('resize', function() {
                    if (statistikMap) {
                        setTimeout(() => {
                            statistikMap.invalidateSize();
                        }, 300);
                    }
                    if (window.lokasiMap) {
                        setTimeout(() => {
                            window.lokasiMap.invalidateSize();
                        }, 300);
                    }
                });
            } catch (error) {
                console.error('Error in DOMContentLoaded:', error);
                showNotification('Terjadi kesalahan saat memuat halaman.', 'error');
            }
        });

        // Ekspos fungsi ke global
        window.showDesaDetail = showDesaDetail;
        window.zoomToDesa = zoomToDesa;
        window.closeModal = closeModal;
        window.openLightbox = openLightbox;
        window.copyToClipboard = copyToClipboard;
        window.shareViaWhatsApp = shareViaWhatsApp;
        window.reloadDataFromFile = reloadDataFromFile;
        window.closeAudioPlayer = closeAudioPlayer;
    </script>
</body>
</html>
