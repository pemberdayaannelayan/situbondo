<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Bidang Pemberdayaan Nelayan - Dinas Perikanan Situbondo</title>
    <meta name="description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMATA, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta name="keywords" content="Dinas Perikanan Situbondo, SIMATA Situbondo, Peta Nelayan, Pemberdayaan Nelayan, Kartu KUSUKA, Bantuan Kapal, Pengaduan Nelayan, Layanan Nelayan">
    <meta name="author" content="Dinas Perikanan Situbondo">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#0284c7">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.dinasperikanansitubondo.com/">
    <meta property="og:title" content="Layanan Pemberdayaan Nelayan - Situbondo">
    <meta property="og:description" content="Akses mudah data KUSUKA, SIMATA, Bantuan Sarpras, dan Saluran Aspirasi Masyarakat Pesisir Situbondo.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS untuk peta -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Satisfy&family=Inter:wght@300;400;500;600&family=Montserrat:wght@500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            --primary: #0284c7;
            --primary-dark: #0c4a6e;
            --secondary: #38bdf8;
            --accent: #f59e0b;
            --accent-dark: #d97706;
            --light-bg: #f0f9ff;
            --white: #ffffff;
            --text-main: #0f172a;
            --text-sub: #475569;
            --font-head: 'Outfit', 'Montserrat', sans-serif;
            --font-body: 'Plus Jakarta Sans', 'Inter', sans-serif;
            --font-signature: 'Satisfy', cursive;
            --green-high: #2ecc71;
            --orange-medium: #f39c12;
            --red-low: #e74c3c;
            --blue-marker: #0284c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-sub);
            background-color: var(--light-bg);
            overflow-x: hidden;
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, .navbar-brand {
            font-family: var(--font-head);
            color: var(--text-main);
        }

        /* ========== WELCOME OVERLAY (Simple) ========== */
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #001219 0%, #005f73 50%, #0a9396 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .welcome-content {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            padding: 30px 25px;
            text-align: center;
            max-width: 90%;
            width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--accent);
        }
        
        .welcome-logo {
            width: 80px;
            height: 80px;
            margin-bottom: 15px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }
        
        .welcome-title {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            font-size: 1.3rem;
            margin-bottom: 8px;
            font-weight: 800;
        }
        
        .welcome-subtitle {
            color: var(--primary);
            font-size: 0.9rem;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .login-form {
            margin: 20px 0;
        }
        
        .btn-enter {
            background: linear-gradient(90deg, var(--primary), var(--primary-dark), var(--accent));
            background-size: 200% auto;
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 0.5px;
            box-shadow: 0 5px 15px rgba(0, 95, 115, 0.4);
            width: 100%;
        }
        
        .btn-enter:hover {
            background-position: right center;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 95, 115, 0.6);
        }
        
        .welcome-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(238, 155, 0, 0.1);
            border-radius: 8px;
            color: #555;
            font-size: 0.8rem;
        }

        /* Responsive untuk welcome screen */
        @media (max-width: 576px) {
            .welcome-content {
                padding: 20px 15px;
                max-width: 95%;
            }
            .welcome-logo {
                width: 60px;
                height: 60px;
            }
            .welcome-title {
                font-size: 1.1rem;
            }
            .welcome-subtitle {
                font-size: 0.8rem;
            }
            .btn-enter {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }

        /* ========== MAIN WEBSITE STYLES ========== */
        .slogan-signature {
            font-family: var(--font-signature);
            color: var(--primary);
            font-size: calc(2rem + 1vw); 
            font-weight: 700; 
            line-height: 1.2;
            margin-bottom: 10px;
            display: inline-block;
        }

        .connector-text {
            font-family: var(--font-body);
            font-size: 0.5em;
            font-weight: 400;
            font-style: italic;
            color: var(--text-sub);
            vertical-align: middle;
            margin: 0 5px;
            letter-spacing: 1px;
        }

        .text-orange-gradient {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            text-shadow: 0px 4px 10px rgba(245, 158, 11, 0.2);
        }

        /* --- Navbar --- */
        .navbar {
            padding: 10px 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .navbar-brand img {
            height: 55px; 
            width: auto;
            object-fit: contain;
            transition: transform 0.3s;
        }

        .navbar-brand:hover img {
            transform: scale(1.05);
        }

        .brand-text h5 {
            font-weight: 800;
            margin: 0;
            line-height: 1;
            color: var(--primary-dark);
            letter-spacing: -0.5px;
        }
        .brand-text span {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .nav-link {
            font-weight: 600;
            color: var(--text-main) !important;
            margin: 0 10px;
            position: relative;
            transition: 0.3s;
        }

        .nav-link:hover {
            color: var(--primary) !important;
        }

        .btn-cta {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 10px 30px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(2, 132, 199, 0.3);
            transition: 0.3s;
        }
        
        .btn-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(2, 132, 199, 0.4);
            color: white;
        }

        /* --- Hero Section --- */
        .hero-section {
            min-height: 100vh;
            background: url('https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            display: flex;
            align-items: center;
            padding-top: 140px; 
            padding-bottom: 80px;
        }

        .hero-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to right, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.7) 60%, rgba(255,255,255,0) 100%);
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-badge {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border: 1px solid var(--primary);
            color: var(--primary-dark);
            padding: 10px 24px;
            border-radius: 30px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        /* --- ANIMASI TOMBOL --- */
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(2, 132, 199, 0); }
            100% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0); }
        }

        .btn-pulse-primary {
            animation: pulse-glow 2s infinite;
        }

        .btn-pulse-outline {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .btn-pulse-outline:hover {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 0 20px rgba(2, 132, 199, 0.5);
        }

        /* --- Service Cards --- */
        .section-header h2 {
            font-weight: 800;
            color: var(--primary-dark);
        }
        
        .service-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            border: 1px solid rgba(2, 132, 199, 0.1); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
            transition: all 0.4s ease;
            height: 100%;
            position: relative;
            display: block;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .service-card::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            transform: scaleX(0);
            transform-origin: left;
            transition: 0.4s;
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(2, 132, 199, 0.15);
        }

        .service-card:hover::after {
            transform: scaleX(1);
        }

        /* --- LOGO LANGSUNG DI MENU (TANPA ICON BOX) --- */
        .menu-logo {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin: 0 auto 25px auto;
            display: block;
            transition: transform 0.4s ease;
        }

        .service-card:hover .menu-logo {
            transform: scale(1.1);
        }

        .card-link-text {
            color: var(--primary);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: auto; 
            padding-top: 20px;
        }

        /* --- Galeri Foto Thumbnail Styles --- */
        .gallery-thumbnail-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin-top: 20px;
            margin-bottom: 20px;
            height: 180px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .gallery-thumbnail-item {
            position: relative;
            overflow: hidden;
            border-radius: 5px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .gallery-thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .gallery-thumbnail-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 132, 199, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-thumbnail-item:hover .gallery-overlay {
            opacity: 1;
        }

        /* --- LOGO PEMBERDAYAAN NELAYAN DI INFO PANEL --- */
        .info-panel-logo {
            width: 180px;
            height: auto;
            margin: 0 auto 25px auto;
            display: block;
        }

        /* --- Lightbox Modal Styles --- */
        .lightbox-modal .modal-dialog {
            max-width: 95%;
            max-height: 95vh;
            margin: 10px auto;
        }

        .lightbox-modal .modal-content {
            background: rgba(0, 0, 0, 0.9);
            border: none;
            border-radius: 10px;
            overflow: hidden;
        }

        .lightbox-modal .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
        }

        .lightbox-modal .modal-title {
            color: white;
            font-size: 1.2rem;
        }

        .lightbox-modal .btn-close {
            background-color: white;
            opacity: 1;
            padding: 8px;
            border-radius: 50%;
        }

        .lightbox-modal .modal-body {
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            max-height: 70vh;
            overflow: hidden;
        }

        .lightbox-modal .lightbox-image {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 5px;
        }

        /* --- Peta Data Section Styles --- */
        .petadata-section {
            padding: 100px 0;
            background-color: var(--white);
        }

        /* Peta Container */
        .peta-container {
            height: 600px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(2, 132, 199, 0.15);
            border: 3px solid white;
            position: relative;
        }

        #petadata-map {
            width: 100%;
            height: 100%;
        }

        /* Header untuk peta interaktif */
        .peta-header {
            background: linear-gradient(120deg, #003049 0%, #005f73 40%, #0a9396 70%, var(--accent) 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-radius: 15px 15px 0 0;
        }

        .peta-header-left h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            margin: 0;
            font-weight: 700;
        }

        .peta-header-left p {
            margin: 5px 0 0;
            opacity: 0.9;
            font-size: 0.85rem;
        }

        .peta-header-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            backdrop-filter: blur(10px);
            font-size: 0.9rem;
        }

        /* Side Panel */
        .side-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            transition: right 0.3s ease;
            overflow-y: auto;
            padding: 20px;
        }
        
        .side-panel.open {
            right: 0;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
        }
        
        .panel-title {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 700;
            margin: 0;
        }
        
        .close-panel {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
        }

        /* Desa Info Card */
        .desa-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 4px solid var(--primary);
        }
        
        .desa-name {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .desa-kecamatan {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .stat-value {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-dark);
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        /* Jenis Bantuan */
        .jenis-bantuan-list {
            margin-top: 15px;
        }
        
        .jenis-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .jenis-name {
            font-weight: 500;
            color: #333;
        }
        
        .jenis-count {
            background: var(--primary);
            color: white;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Filter Controls */
        .filter-controls {
            position: absolute;
            top: 80px;
            left: 20px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 250px;
        }
        
        .filter-title {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .form-select-sm {
            margin-bottom: 8px;
            border-radius: 8px;
            padding: 6px 10px;
            border: 1px solid #ced4da;
            font-size: 0.85rem;
            width: 100%;
        }

        /* Legend */
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 180px;
        }
        
        .legend-title {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            margin-right: 8px;
        }
        
        .legend-label {
            font-size: 0.8rem;
            color: #333;
        }

        /* Loading Spinner */
        .loading-spinner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            z-index: 9999;
            display: none;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
        }
        
        .custom-toast {
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            max-width: 350px;
            animation: slideIn 0.3s ease;
            border-left: 4px solid var(--primary);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast-icon {
            font-size: 1.5rem;
            margin-right: 15px;
            color: var(--primary);
        }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-title {
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }
        
        .toast-message {
            color: #666;
            font-size: 0.9rem;
        }

        /* Peta Tabs */
        .petadata-tabs {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .petadata-tabs .nav-tabs {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border: none;
            padding: 0;
            margin: 0;
        }

        .petadata-tabs .nav-link {
            color: white;
            background: transparent;
            border: none;
            border-radius: 0;
            padding: 15px 25px;
            font-weight: 600;
            margin: 0;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .petadata-tabs .nav-link:hover {
            background-color: rgba(255,255,255,0.1);
            color: white;
        }

        .petadata-tabs .nav-link.active {
            background-color: white;
            color: var(--primary-dark);
            border-bottom: 3px solid var(--accent);
        }

        .petadata-tabs .tab-content {
            padding: 30px;
            background: white;
        }

        /* Summary Cards */
        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
            border: 1px solid rgba(2, 132, 199, 0.1);
            transition: transform 0.3s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
        }
        
        .summary-card h5 {
            font-size: 1rem;
            color: var(--text-sub);
            margin-bottom: 15px;
        }
        
        .summary-card .number {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .summary-card .label {
            font-size: 0.85rem;
            color: #666;
        }

        /* ========== FORM SECTION ========== */
        .aduan-section {
            padding: 100px 0;
            background-color: white; 
            position: relative;
        }

        .form-container {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08); 
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .info-panel {
            background: linear-gradient(160deg, var(--primary-dark) 0%, var(--primary) 100%);
            padding: 50px;
            color: white;
            position: relative;
        }

        .info-panel h3 { color: white !important; }
        .info-panel p { color: rgba(255,255,255,0.8); }

        .form-panel {
            padding: 50px;
            background-color: white;
        }

        .form-label {
            color: var(--text-main); 
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .btn-wa {
            background-color: #25D366;
            color: white;
            font-weight: 700;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
            transition: 0.3s;
        }
        .btn-wa:hover {
            background-color: #1ebc57;
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
            color: white;
        }

        /* ========== FOOTER ========== */
        footer {
            background-color: var(--primary-dark);
            color: #cbd5e1;
            padding-top: 0;
            position: relative;
            margin-top: 50px;
        }

        .footer-wave {
            line-height: 0;
            width: 100%;
            background-color: white; 
        }
        .footer-wave svg {
            display: block;
            width: 100%;
            height: 60px;
            fill: var(--primary-dark);
        }

        .footer-content {
            padding: 60px 0 40px;
        }

        footer h5 {
            color: white;
            font-weight: 700;
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
        }

        footer h5::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -8px;
            width: 40px;
            height: 3px;
            background-color: var(--accent);
            border-radius: 2px;
        }

        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            color: var(--secondary);
            padding-left: 5px;
        }

        .contact-item {
            display: flex;
            align-items: start;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .contact-icon {
            background: rgba(255,255,255,0.1);
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary);
            flex-shrink: 0;
        }

        .copyright {
            background-color: rgba(0,0,0,0.2);
            padding: 20px 0;
            text-align: center;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
        }

        /* ========== RESPONSIVE MEDIA QUERIES ========== */
        @media (max-width: 991px) {
            .hero-section {
                padding-top: 120px;
                text-align: center;
                background-position: left center;
            }
            .hero-overlay {
                background: linear-gradient(to bottom, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.8) 100%);
            }
            .hero-badge {
                margin: 0 auto 20px auto;
            }
            .d-flex.gap-3 {
                justify-content: center;
                flex-wrap: wrap;
            }
            .form-panel {
                padding: 30px 20px;
            }
            .info-panel {
                padding: 30px 20px;
            }
            .gallery-thumbnail-container {
                height: 150px;
            }
            .lightbox-modal .modal-dialog {
                max-width: 98%;
                margin: 5px auto;
            }
            .menu-logo {
                width: 100px;
                height: 100px;
            }
            .info-panel-logo {
                width: 150px;
            }
            .filter-controls, .legend {
                width: 90%;
                left: 5%;
            }
            .filter-controls {
                top: 100px;
            }
            .side-panel {
                width: 100%;
                right: -100%;
            }
            .petadata-tabs .nav-link {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            .summary-card {
                padding: 20px;
            }
            .summary-card .number {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 768px) {
            .gallery-thumbnail-container {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
                height: 200px;
            }
            .menu-logo {
                width: 90px;
                height: 90px;
            }
            .info-panel-logo {
                width: 120px;
            }
            .peta-header {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
            }
            .peta-header-right {
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }
            .petadata-tabs .nav {
                flex-direction: column;
            }
            .petadata-tabs .nav-link {
                border-right: none;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            .summary-card {
                margin-bottom: 15px;
            }
        }

        @media (max-width: 576px) {
            .display-3 {
                font-size: 2.5rem; 
            }
            .slogan-signature {
                font-size: 2rem;
                margin-bottom: 15px;
            }
            .lead {
                font-size: 1rem;
            }
            .hero-section {
                padding-top: 130px; 
                padding-bottom: 50px;
            }
            .navbar-brand div h5 {
                font-size: 1rem;
            }
            .navbar-brand div span {
                font-size: 0.65rem;
            }
            .btn-cta {
                width: 100%; 
                margin-bottom: 10px;
            }
            .btn-outline-primary {
                width: 100%;
            }
            .gallery-thumbnail-container {
                height: 160px;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
            }
            .lightbox-modal .modal-body {
                max-height: 60vh;
            }
            .menu-logo {
                width: 80px;
                height: 80px;
                margin-bottom: 20px;
            }
            .service-card {
                padding: 30px 20px;
            }
            .info-panel-logo {
                width: 100px;
                margin-bottom: 20px;
            }
            .petadata-tabs .tab-content {
                padding: 20px 15px;
            }
            .peta-container {
                height: 450px;
            }
            .summary-card .number {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 400px) {
            .gallery-thumbnail-container {
                height: 140px;
            }
            .menu-logo {
                width: 70px;
                height: 70px;
            }
            .info-panel-logo {
                width: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Overlay (Simple) -->
    <div class="welcome-overlay" id="welcomeOverlay">
        <div class="welcome-content">
            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/garuda.png" 
                 alt="Logo Garuda" class="welcome-logo">
            
            <h1 class="welcome-title">SISTEM INFORMASI PEMBERDAYAAN NELAYAN</h1>
            <p class="welcome-subtitle">
                Kabupaten Situbondo<br>
                <strong>Dinas Perikanan - Bidang Pemberdayaan Nelayan</strong>
            </p>
            
            <div class="login-form">
                <button class="btn-enter" id="enterBtn">
                    <i class="fas fa-sign-in-alt me-2"></i> MASUK KE WEBSITE
                </button>
            </div>
            
            <div class="welcome-info">
                <i class="fas fa-sync-alt me-2"></i>
                Data akan dimuat dari repositori GitHub setelah masuk
            </div>
        </div>
    </div>

    <!-- Main Website Content (Initially Hidden) -->
    <div id="mainWebsite" style="display: none;">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand d-flex align-items-center gap-3" href="#">
                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Pemerintah Kabupaten Situbondo">
                    <div class="brand-text d-flex flex-column">
                        <h5>DINAS PERIKANAN</h5>
                        <span>KAB. SITUBONDO</span>
                    </div>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                    <ul class="navbar-nav align-items-center gap-2">
                        <li class="nav-item"><a class="nav-link" href="#home">Beranda</a></li>
                        <li class="nav-item"><a class="nav-link" href="#layanan">Layanan</a></li>
                        <li class="nav-item"><a class="nav-link" href="#petadata">Peta Data</a></li>
                        <li class="nav-item ms-lg-3">
                            <a href="#aduan" class="btn btn-cta">Hubungi Kami</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section id="home" class="hero-section">
            <div class="hero-overlay"></div>
            <div class="container hero-content">
                <div class="row">
                    <div class="col-lg-7" data-aos="fade-right">
                        <div class="hero-badge text-nowrap">
                            <i class="fas fa-water"></i> <span>Dinas Perikanan Situbondo</span>
                        </div>
                        
                        <div class="slogan-signature">
                            Pemberdayaan Nelayan
                        </div>
                        <h1 class="display-3 fw-bold mb-4" style="color: var(--text-main);">
                            Dari Hulu ke Hilir <span class="connector-text">untuk</span> <br>
                            <span class="text-orange-gradient">Situbondo Naik Kelas</span>
                        </h1>
                        
                        <p class="lead mb-5" style="color: var(--text-sub); font-weight: 500;">
                            Program kegiatan Bidang Bina Pemberdayaan Nelayan yang merujuk pada rantai nilai perikanan, mulai dari kegiatan penangkapan ikan di laut (hulu) hingga proses pengolahan, distribusi, pemasaran, hingga akhirnya sampai ke konsumen (hilir), yang tujuannya meningkatkan kesejahteraan nelayan melalui data basis nelayan yang terintegrasi, pemberdayaan, dan dukungan infrastruktur.
                        </p>
                        <div class="d-flex gap-3">
                            <a href="#layanan" class="btn btn-cta px-4 py-3 shadow btn-pulse-primary">Layanan Kami</a>
                            <a href="#petadata" class="btn btn-outline-primary px-4 py-3 rounded-pill fw-bold btn-pulse-outline" style="border-width: 2px;">Peta Data Lengkap</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Layanan Section -->
        <section id="layanan" class="py-5">
            <div class="container py-5">
                <div class="text-center mb-5 section-header" data-aos="fade-up">
                    <span class="text-primary fw-bold text-uppercase letter-spacing-2">Menu Layanan</span>
                    <h2 class="display-6 mt-2">Akses Program Nelayan</h2>
                    <div style="width: 80px; height: 4px; background: var(--accent); margin: 15px auto; border-radius: 2px;"></div>
                    <p class="text-muted col-lg-6 mx-auto">Pilih menu di bawah ini untuk mengakses layanan digital dan program bantuan pemerintah.</p>
                </div>

                <div class="row g-4">
                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                        <a href="https://portaldata.kkp.go.id/" target="_blank" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kusuka.png" alt="Logo KUSUKA" class="menu-logo">
                            <h4 class="fw-bold mb-3">Kartu KUSUKA</h4>
                            <p class="text-muted">Akses Portal Data KKP untuk pendaftaran dan cek status identitas pelaku usaha perikanan (KUSUKA).</p>
                            <span class="card-link-text">Buka Portal <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="150">
                        <a href="#petadata" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMATA" class="menu-logo">
                            <h4 class="fw-bold mb-3">SIMATA</h4>
                            <p class="text-muted">Sistem Manajemen & Pemetaan Data. Monitoring data nelayan dan potensi tangkapan dalam satu peta.</p>
                            <span class="card-link-text">Lihat Peta Data <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="170">
                        <a href="https://www.dinasperikanansitubondo.com/kilat" target="_blank" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kilat.png" alt="Logo KILAT" class="menu-logo">
                            <h4 class="fw-bold mb-3">KILAT</h4>
                            <p class="text-muted">Kamera Interaktif Lacak Aktivitas Terkini. Aplikasi dokumentasi kegiatan dengan watermark lokasi dan waktu otomatis.</p>
                            <span class="card-link-text">Akses Kamera <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="190">
                        <a href="https://www.dinasperikanansitubondo.com/sismat" target="_blank" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/surat.png" alt="Logo SISMAT" class="menu-logo">
                            <h4 class="fw-bold mb-3">SISMAT</h4>
                            <p class="text-muted">Sistem Manajemen Surat. Layanan administrasi dan persuratan digital dinas perikanan.</p>
                            <span class="card-link-text">Buka Aplikasi <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                        <a href="#petadata" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kapal.png" alt="Logo Bantuan Sarpras" class="menu-logo">
                            <h4 class="fw-bold mb-3">Bantuan Sarpras</h4>
                            <p class="text-muted">Informasi dan pengajuan bantuan sarana prasarana seperti mesin, jaring, dan perahu nelayan.</p>
                            <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="210">
                        <a href="https://www.dinasperikanansitubondo.com/peraturankkp" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/peraturan.png" alt="Logo Peraturan Kemen-KP" class="menu-logo">
                            <h4 class="fw-bold mb-3">Peraturan Kemen-KP</h4>
                            <p class="text-muted">Akses kumpulan peraturan dan kebijakan Kementerian Kelautan dan Perikanan yang berlaku untuk nelayan dan pelaku usaha perikanan.</p>
                            <span class="card-link-text">Lihat Peraturan <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="230">
                        <div class="service-card" onclick="window.open('https://www.dinasperikanansitubondo.com/kegiatan/', '_blank')">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/galeri.png" alt="Logo Galeri" class="menu-logo">
                            <h4 class="fw-bold mb-3">Galeri Kegiatan</h4>
                            <p class="text-muted">Lihat dokumentasi kegiatan lapangan, pelatihan, dan program pemberdayaan nelayan Situbondo.</p>
                            
                            <div class="gallery-thumbnail-container">
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(0)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg" alt="Kegiatan 1" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(1)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg" alt="Kegiatan 2" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(2)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg" alt="Kegiatan 3" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(3)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg" alt="Kegiatan 4" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(4)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg" alt="Kegiatan 5" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(5)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg" alt="Kegiatan 6" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(6)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg" alt="Kegiatan 7" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(7)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg" alt="Kegiatan 8" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                                <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(8)">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg" alt="Kegiatan 9" loading="lazy">
                                    <div class="gallery-overlay">
                                        <i class="fas fa-search-plus"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <span class="card-link-text">Lihat Galeri Lengkap <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="310">
                        <a href="#petadata" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/data.png" alt="Logo Data Statistik" class="menu-logo">
                            <h4 class="fw-bold mb-3">Peta Data Lengkap</h4>
                            <p class="text-muted">Akses data statistik lengkap nelayan, penerima bantuan, dan distribusi sarana prasarana per kecamatan.</p>
                            <span class="card-link-text">Buka Data Lengkap <i class="fas fa-arrow-right"></i></span>
                        </a>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="320">
                        <a href="#aduan" class="service-card">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/layanan%20info.png" alt="Logo Layanan Aduan" class="menu-logo">
                            <h4 class="fw-bold mb-3">Layanan Aduan</h4>
                            <p class="text-muted">Sampaikan aspirasi, keluhan, atau permohonan informasi langsung kepada dinas secara online.</p>
                            <span class="card-link-text">Isi Formulir <i class="fas fa-arrow-down"></i></span>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Peta Data Section (PetaData Lengkap) -->
        <section id="petadata" class="petadata-section">
            <div class="container">
                <div class="text-center mb-5 section-header" data-aos="fade-up">
                    <span class="text-primary fw-bold text-uppercase letter-spacing-2">Data Statistik Lengkap</span>
                    <h2 class="display-6 mt-2">Peta Data Nelayan & Bantuan Sarpras Kabupaten Situbondo</h2>
                    <div style="width: 80px; height: 4px; background: var(--accent); margin: 15px auto; border-radius: 2px;"></div>
                    <p class="text-muted col-lg-8 mx-auto">Data terperinci dan lengkap mengenai jumlah nelayan, perahu, usaha, dan bantuan sarana prasarana di setiap kecamatan pesisir Situbondo. Data diambil dari repositori GitHub secara real-time.</p>
                </div>

                <div class="petadata-tabs" data-aos="fade-up">
                    <ul class="nav nav-tabs" id="petadataTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="peta-interaktif-tab" data-bs-toggle="tab" data-bs-target="#peta-interaktif" type="button" role="tab">
                                <i class="fas fa-map-marked-alt me-2"></i>Peta Interaktif
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="ringkasan-tab" data-bs-toggle="tab" data-bs-target="#ringkasan" type="button" role="tab">
                                <i class="fas fa-chart-pie me-2"></i>Ringkasan Data
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tabel-tab" data-bs-toggle="tab" data-bs-target="#tabel" type="button" role="tab">
                                <i class="fas fa-table me-2"></i>Tabel Data
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="petadataTabContent">
                        <!-- Tab Peta Interaktif -->
                        <div class="tab-pane fade show active" id="peta-interaktif" role="tabpanel">
                            <div class="peta-container">
                                <div class="peta-header">
                                    <div class="peta-header-left">
                                        <h1><i class="fas fa-map-marked-alt me-2"></i> PETA STATISTIK NELAYAN SITUBONDO</h1>
                                        <p>Visualisasi Data Bantuan Per Desa - Bidang Pemberdayaan Nelayan</p>
                                    </div>
                                    <div class="peta-header-right">
                                        <div class="stats-badge" id="statsSummary">
                                            <i class="fas fa-database me-2"></i>
                                            <span id="totalDesa">0</span> Desa | 
                                            <span id="totalPenerima">0</span> Penerima
                                        </div>
                                        <button class="btn btn-light btn-sm" id="reloadDataBtn" title="Reload Data dari GitHub">
                                            <i class="fas fa-sync-alt"></i>
                                        </button>
                                        <button class="btn btn-primary btn-sm" id="togglePanelBtn" title="Detail Data">
                                            <i class="fas fa-info-circle"></i> Detail
                                        </button>
                                    </div>
                                </div>
                                <div id="petadata-map"></div>
                                
                                <!-- Filter Controls -->
                                <div class="filter-controls">
                                    <h6 class="filter-title"><i class="fas fa-filter me-2"></i> Filter Data</h6>
                                    <select class="form-select-sm" id="filterKecamatan">
                                        <option value="">Semua Kecamatan</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                    <select class="form-select-sm" id="filterJenis">
                                        <option value="">Semua Jenis Bantuan</option>
                                        <option value="Barang">Barang</option>
                                        <option value="Uang">Uang</option>
                                        <option value="Jasa">Jasa</option>
                                    </select>
                                    <select class="form-select-sm" id="filterTahun">
                                        <option value="">Semua Tahun</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                                
                                <!-- Legend -->
                                <div class="legend">
                                    <h6 class="legend-title"><i class="fas fa-key me-2"></i> Legenda</h6>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background-color: var(--green-high);"></div>
                                        <div class="legend-label">Tinggi (> 50 penerima)</div>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background-color: var(--orange-medium);"></div>
                                        <div class="legend-label">Sedang (10-50 penerima)</div>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background-color: var(--red-low);"></div>
                                        <div class="legend-label">Rendah (< 10 penerima)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Ringkasan Data -->
                        <div class="tab-pane fade" id="ringkasan" role="tabpanel">
                            <div class="row mb-4">
                                <div class="col-md-3 col-sm-6">
                                    <div class="summary-card">
                                        <h5><i class="fas fa-users me-2"></i>Total Penerima</h5>
                                        <div class="number" id="total-penerima">0</div>
                                        <div class="label">Seluruh Kecamatan</div>
                                    </div>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <div class="summary-card">
                                        <h5><i class="fas fa-gift me-2"></i>Total Bantuan Barang</h5>
                                        <div class="number" id="total-barang">0</div>
                                        <div class="label">Unit Barang</div>
                                    </div>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <div class="summary-card">
                                        <h5><i class="fas fa-building me-2"></i>Total Desa</h5>
                                        <div class="number" id="total-desa-ringkasan">0</div>
                                        <div class="label">Desa Penerima</div>
                                    </div>
                                </div>
                                <div class="col-md-3 col-sm-6">
                                    <div class="summary-card">
                                        <h5><i class="fas fa-calendar me-2"></i>Tahun Aktif</h5>
                                        <div class="number" id="total-tahun">0</div>
                                        <div class="label">Tahun Distribusi</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle me-2"></i>
                                        Data ringkasan diambil dari file <code>datapeta.js</code> yang berada di repositori GitHub.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Tabel Data -->
                        <div class="tab-pane fade" id="tabel" role="tabpanel">
                            <div class="alert alert-warning">
                                <i class="fas fa-database me-2"></i>
                                Tabel data akan ditampilkan setelah data dari <code>datapeta.js</code> berhasil dimuat dari repositori GitHub.
                            </div>
                            <div class="data-table-container" style="max-height: 400px; overflow-y: auto;">
                                <table class="table table-striped table-hover">
                                    <thead class="table-primary">
                                        <tr>
                                            <th>No</th>
                                            <th>Desa</th>
                                            <th>Kecamatan</th>
                                            <th>Jumlah Penerima</th>
                                            <th>Bantuan Barang</th>
                                            <th>Tahun Distribusi</th>
                                            <th>Kelompok</th>
                                        </tr>
                                    </thead>
                                    <tbody id="data-table-body">
                                        <tr>
                                            <td colspan="7" class="text-center py-4">
                                                <i class="fas fa-spinner fa-spin me-2"></i>
                                                Memuat data dari GitHub...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Form Pengaduan Section -->
        <section id="aduan" class="aduan-section">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-xl-10">
                        <div class="form-container" data-aos="zoom-in">
                            <div class="row g-0">
                                <div class="col-lg-4 info-panel d-flex flex-column justify-content-center">
                                    <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo%20pemberdayaan%20nelayan.png" alt="Logo Pemberdayaan Nelayan" class="info-panel-logo">
                                    
                                    <h3 class="fw-bold mb-4 text-center">Pusat Bantuan</h3>
                                    <p class="mb-4 text-center">Data yang Anda kirimkan akan diteruskan ke sistem WhatsApp Center kami. Privasi pelapor dijamin aman.</p>
                                    
                                    <div class="mt-4">
                                        <div class="d-flex align-items-center mb-3">
                                            <i class="fas fa-check-circle text-warning me-3 fa-lg"></i>
                                            <span class="fw-bold">Respon Cepat</span>
                                        </div>
                                        <div class="d-flex align-items-center mb-3">
                                            <i class="fas fa-user-shield text-warning me-3 fa-lg"></i>
                                            <span class="fw-bold">Data Aman</span>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <i class="fab fa-whatsapp text-warning me-3 fa-lg"></i>
                                            <span class="fw-bold">Langsung ke Admin</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-8 form-panel">
                                    <h4 class="fw-bold mb-4 text-dark">Formulir Pengaduan</h4>
                                    <form id="waForm" onsubmit="kirimKeWA(event)">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <label class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                                                <input type="text" class="form-control" id="nama" placeholder="Nama Sesuai KTP" required>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label class="form-label">NIK (16 Digit) <span class="text-danger">*</span></label>
                                                <input type="number" class="form-control" id="nik" placeholder="Masukkan NIK" required>
                                            </div>

                                            <div class="col-md-6">
                                                <label class="form-label">Nomor WhatsApp <span class="text-danger">*</span></label>
                                                <input type="number" class="form-control" id="whatsapp" placeholder="0812xxxx" required>
                                            </div>

                                            <div class="col-md-6">
                                                <label class="form-label">Email <small class="text-muted fw-normal">(Opsional)</small></label>
                                                <input type="email" class="form-control" id="email" placeholder="nama@email.com">
                                            </div>

                                            <div class="col-12">
                                                <label class="form-label">Alamat Lengkap <span class="text-danger">*</span></label>
                                                <textarea class="form-control" id="alamat" rows="2" placeholder="Desa, Kecamatan, Kabupaten..." required></textarea>
                                            </div>

                                            <div class="col-12">
                                                <label class="form-label">Isi Laporan / Perihal <span class="text-danger">*</span></label>
                                                <textarea class="form-control" id="perihal" rows="4" placeholder="Tuliskan detail laporan Anda di sini..." required></textarea>
                                            </div>

                                            <div class="col-12 mt-4">
                                                <button type="submit" class="btn btn-wa">
                                                    <i class="fab fa-whatsapp fa-lg"></i> KIRIM SEKARANG
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="footer-wave">
                <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
                    <path fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
                </svg>
            </div>

            <div class="container footer-content">
                <div class="row gy-5">
                    <div class="col-lg-5 col-md-12">
                        <div class="d-flex align-items-center gap-3 mb-4">
                            <i class="fas fa-ship fa-3x text-white"></i> <div>
                                <h4 class="text-white mb-0 fw-bold">DINAS PERIKANAN</h4>
                                <small class="text-white-50" style="letter-spacing: 2px;">KABUPATEN SITUBONDO</small>
                            </div>
                        </div>
                        <p class="pe-lg-5" style="line-height: 1.8;">
                            Berkomitmen untuk memajukan sektor perikanan tangkap dan memberdayakan masyarakat pesisir melalui pelayanan yang transparan, akuntabel, dan inovatif.
                        </p>
                        <div class="d-flex gap-2 mt-4">
                            <a href="#" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-globe"></i></a>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <h5>Tautan Cepat</h5>
                        <ul class="list-unstyled footer-links mt-3">
                            <li><a href="#home"><i class="fas fa-chevron-right fa-xs"></i> Beranda</a></li>
                            <li><a href="#layanan"><i class="fas fa-chevron-right fa-xs"></i> Layanan</a></li>
                            <li><a href="#petadata"><i class="fas fa-chevron-right fa-xs"></i> Peta Data</a></li>
                            <li><a href="#aduan"><i class="fas fa-chevron-right fa-xs"></i> Pengaduan</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-6">
                        <h5>Kontak Kami</h5>
                        <div class="mt-3">
                            <div class="contact-item">
                                <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                                <div>
                                    <span class="d-block text-white fw-bold">Alamat Kantor</span>
                                    <small>Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur 68312</small>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="fas fa-phone-alt"></i></div>
                                <div>
                                    <span class="d-block text-white fw-bold">Telepon / WhatsApp</span>
                                    <small>0878-6561-4222</small>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="fas fa-clock"></i></div>
                                <div>
                                    <span class="d-block text-white fw-bold">Jam Pelayanan</span>
                                    <small>Senin - Jumat: 08.00 - 15.00 WIB</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="copyright">
                <div class="container">
                    <div class="row">
                        <div class="col-md-6 text-md-start mb-2 mb-md-0">
                            &copy; 2025 <strong>Dinas Perikanan Situbondo</strong>. All Rights Reserved.
                        </div>
                        <div class="col-md-6 text-md-end">
                            <small class="text-white-50">Bidang Pemberdayaan Nelayan | Data dari GitHub</small>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- ========== ELEMEN TAMBAHAN UNTUK PETA DATA ========== -->
    <!-- Side Panel untuk Detail Desa -->
    <div class="side-panel" id="sidePanel">
        <div class="panel-header">
            <h3 class="panel-title"><i class="fas fa-info-circle me-2"></i> Detail Desa</h3>
            <button class="close-panel" id="closePanelBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div id="panelContent">
            <div class="text-center text-muted py-5">
                <i class="fas fa-map-marker-alt fa-3x mb-3" style="color: #ccc;"></i>
                <p>Klik pada marker di peta untuk melihat detail desa</p>
            </div>
        </div>
    </div>
    
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
        <p>Memuat data peta dari GitHub...</p>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Lightbox Modal -->
    <div class="modal fade lightbox-modal" id="lightboxModal" tabindex="-1" aria-labelledby="lightboxModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lightboxModalLabel">Galeri Kegiatan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="lightboxImage" src="" alt="Kegiatan" class="lightbox-image">
                </div>
            </div>
        </div>
    </div>

    <!-- ========== JAVASCRIPT LIBRARIES ========== -->
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        // ========== GLOBAL VARIABLES ==========
        let map;
        let markers = [];
        let petaData = null;
        let currentDesaData = null;
        
        // Koordinat Kecamatan Situbondo
        const kecamatanCoordinates = {
            "Arjasa": [-7.781, 114.075],
            "Asembagus": [-7.784, 114.250],
            "Banyuglugur": [-7.834, 113.917],
            "Banyuputih": [-7.717, 114.250],
            "Besuki": [-7.733, 113.700],
            "Bungatan": [-7.667, 113.817],
            "Jangkar": [-7.783, 114.150],
            "Jatibanteng": [-7.867, 113.983],
            "Kapongan": [-7.700, 114.083],
            "Kendit": [-7.750, 114.033],
            "Mangaran": [-7.717, 114.050],
            "Mlandingan": [-7.783, 113.750],
            "Panarukan": [-7.700, 113.917],
            "Panji": [-7.717, 114.017],
            "Situbondo": [-7.705, 113.994],
            "Suboh": [-7.867, 114.150],
            "Sumbermalang": [-7.933, 113.883]
        };

        // ========== WELCOME OVERLAY & LOGIN ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Setup event listeners untuk login
            setupEventListeners();
            
            // Inisialisasi AOS Animation
            AOS.init({
                once: true,
                offset: 100,
                duration: 800,
            });
            
            // Setup navbar scroll effect
            window.addEventListener('scroll', function() {
                const nav = document.getElementById('mainNav');
                if (window.scrollY > 50) {
                    nav.style.boxShadow = "0 10px 30px rgba(0,0,0,0.1)";
                    nav.style.background = "rgba(255, 255, 255, 0.98)";
                } else {
                    nav.style.boxShadow = "0 4px 20px rgba(0,0,0,0.05)";
                    nav.style.background = "rgba(255, 255, 255, 0.95)";
                }
            });
        });
        
        function setupEventListeners() {
            // Enter Button (Login)
            document.getElementById('enterBtn').addEventListener('click', enterWebsite);
            
            // Panel Controls untuk peta data
            document.getElementById('togglePanelBtn').addEventListener('click', toggleSidePanel);
            document.getElementById('closePanelBtn').addEventListener('click', toggleSidePanel);
            
            // Filter Controls untuk peta data
            document.getElementById('filterKecamatan').addEventListener('change', applyFilters);
            document.getElementById('filterJenis').addEventListener('change', applyFilters);
            document.getElementById('filterTahun').addEventListener('change', applyFilters);
            
            // Reload Data untuk peta data
            document.getElementById('reloadDataBtn').addEventListener('click', reloadDataPeta);
            
            // Tab change untuk resize map
            document.getElementById('peta-interaktif-tab').addEventListener('shown.bs.tab', function() {
                setTimeout(function() {
                    if (map) {
                        map.invalidateSize();
                    }
                }, 300);
            });
        }
        
        function enterWebsite() {
            // Hide welcome overlay
            document.getElementById('welcomeOverlay').style.opacity = '0';
            
            setTimeout(() => {
                document.getElementById('welcomeOverlay').style.display = 'none';
                document.getElementById('mainWebsite').style.display = 'block';
                
                // Show success message
                showToast('Memuat data dari GitHub...', 'info');
                
                // Load data peta dari GitHub
                loadDataPeta();
                
                showLoading(false);
            }, 500);
        }
        
        // ========== PETA DATA FUNCTIONS ==========
        function initMap() {
            // Initialize map centered on Situbondo
            map = L.map('petadata-map').setView([-7.705, 113.994], 11);
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // Add scale control
            L.control.scale().addTo(map);
        }
        
        function showLoading(show) {
            document.getElementById('loadingSpinner').style.display = show ? 'block' : 'none';
        }
        
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            const colors = {
                success: '#2ecc71',
                error: '#e74c3c',
                warning: '#f39c12',
                info: '#3498db'
            };
            
            const toast = document.createElement('div');
            toast.className = 'custom-toast';
            toast.style.borderLeftColor = colors[type];
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icons[type]}"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-message">${message}</div>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Remove toast after 5 seconds
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    toastContainer.removeChild(toast);
                }, 300);
            }, 5000);
        }
        
        function loadDataPeta() {
            showLoading(true);
            
            // Create script element to load datapeta.js dari GitHub
            const script = document.createElement('script');
            // Gunakan URL GitHub raw untuk datapeta.js dengan timestamp untuk menghindari cache
            script.src = 'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/main/datapeta.js?t=' + new Date().getTime();
            
            script.onload = function() {
                setTimeout(() => {
                    if (typeof window.DATA_PETA_STATISTIK !== 'undefined') {
                        petaData = window.DATA_PETA_STATISTIK;
                        processPetaData();
                        showToast('Data peta berhasil dimuat dari GitHub!', 'success');
                    } else {
                        showToast('Data peta tidak ditemukan di repositori.', 'error');
                    }
                    showLoading(false);
                }, 1000);
            };
            
            script.onerror = function() {
                showLoading(false);
                showToast('Gagal memuat data peta dari GitHub. Pastikan file datapeta.js tersedia di repositori.', 'error');
            };
            
            document.head.appendChild(script);
        }
        
        function processPetaData() {
            if (!petaData || !petaData.data) return;
            
            // Initialize map jika belum
            if (!map) {
                initMap();
            }
            
            // Update summary stats
            document.getElementById('totalDesa').textContent = petaData.metadata.totalDesa;
            document.getElementById('totalPenerima').textContent = petaData.metadata.totalPenerima;
            
            // Update ringkasan data
            updateRingkasanData();
            
            // Update tabel data
            updateTabelData();
            
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            // Populate filter dropdowns
            populateFilters();
            
            // Add markers for each desa
            petaData.data.forEach(desa => {
                addMarker(desa);
            });
        }
        
        function updateRingkasanData() {
            if (!petaData || !petaData.data) return;
            
            // Hitung total data
            let totalPenerima = 0;
            let totalBarang = 0;
            let totalDesa = petaData.data.length;
            let tahunSet = new Set();
            
            petaData.data.forEach(desa => {
                totalPenerima += desa.jumlahPenerima;
                totalBarang += desa.totalBantuanBarang;
                
                // Collect unique years
                if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                    desa.tahunDistribusi.forEach(t => {
                        if (t.tahun) tahunSet.add(t.tahun);
                    });
                }
            });
            
            // Update ringkasan
            document.getElementById('total-penerima').textContent = totalPenerima.toLocaleString('id-ID');
            document.getElementById('total-barang').textContent = totalBarang.toLocaleString('id-ID');
            document.getElementById('total-desa-ringkasan').textContent = totalDesa.toLocaleString('id-ID');
            document.getElementById('total-tahun').textContent = tahunSet.size;
        }
        
        function updateTabelData() {
            const tbody = document.getElementById('data-table-body');
            if (!petaData || !petaData.data) {
                tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4">Data tidak tersedia</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            
            petaData.data.forEach((desa, index) => {
                // Format tahun distribusi
                let tahunDistribusi = '-';
                if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                    tahunDistribusi = desa.tahunDistribusi.map(t => t.tahun).join(', ');
                }
                
                // Format kelompok
                let kelompok = '-';
                if (desa.kelompokDistribusi && Array.isArray(desa.kelompokDistribusi)) {
                    kelompok = desa.kelompokDistribusi.map(k => k.kelompok).join(', ');
                } else if (desa.kelompokDistribusi && typeof desa.kelompokDistribusi === 'object') {
                    kelompok = Object.keys(desa.kelompokDistribusi).join(', ');
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${desa.desa}</strong></td>
                    <td>${desa.kecamatan}</td>
                    <td><span class="badge bg-primary">${desa.jumlahPenerima}</span></td>
                    <td>${desa.totalBantuanBarang} unit</td>
                    <td>${tahunDistribusi}</td>
                    <td>${kelompok}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function addMarker(desa) {
            // Determine marker color based on jumlah penerima
            let markerColor;
            if (desa.jumlahPenerima > 50) markerColor = 'var(--green-high)'; // Green
            else if (desa.jumlahPenerima >= 10) markerColor = 'var(--orange-medium)'; // Orange
            else markerColor = 'var(--red-low)'; // Red
            
            // Create custom icon
            const icon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="
                    background-color: ${markerColor};
                    width: 28px;
                    height: 28px;
                    border-radius: 50%;
                    border: 3px solid white;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-weight: bold;
                    font-size: 11px;
                ">${desa.jumlahPenerima}</div>`,
                iconSize: [28, 28],
                iconAnchor: [14, 14]
            });
            
            // Use provided coordinates or fallback to kecamatan coordinates
            let coords;
            if (desa.koordinat && desa.koordinat.lat && desa.koordinat.lng) {
                coords = [desa.koordinat.lat, desa.koordinat.lng];
            } else if (kecamatanCoordinates[desa.kecamatan]) {
                coords = kecamatanCoordinates[desa.kecamatan];
                // Add small random offset for multiple desa in same kecamatan
                coords = [
                    coords[0] + (Math.random() * 0.02 - 0.01),
                    coords[1] + (Math.random() * 0.02 - 0.01)
                ];
            } else {
                coords = [-7.7 + (Math.random() * 0.2), 113.9 + (Math.random() * 0.3)];
            }
            
            // Create marker
            const marker = L.marker(coords, { icon: icon })
                .addTo(map)
                .bindPopup(createPopupContent(desa))
                .on('click', function() {
                    showDesaDetail(desa);
                });
            
            markers.push(marker);
        }
        
        function createPopupContent(desa) {
            // Format jenis bantuan
            const jenisBantuanHtml = desa.jenisBantuan && desa.jenisBantuan.length > 0 
                ? desa.jenisBantuan.map(jenis => 
                    `<div><strong>${jenis.jenis}:</strong> ${jenis.jumlah} penerima</div>`
                ).join('')
                : `<div><strong>Barang:</strong> ${desa.jumlahPenerima} penerima</div>`;
            
            // Format tahun distribusi
            let tahunDistribusi = '-';
            if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                tahunDistribusi = desa.tahunDistribusi.map(t => `${t.tahun} (${t.jumlah})`).join(', ');
            }
            
            return `
                <div style="min-width: 220px;">
                    <h5 style="margin: 0 0 5px; color: var(--primary-dark);">${desa.desa}</h5>
                    <p style="margin: 0 0 10px; color: #666; font-size: 0.9em;">Kec. ${desa.kecamatan}</p>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                        <div><strong>Jumlah Penerima:</strong> ${desa.jumlahPenerima}</div>
                        <div><strong>Bantuan Barang:</strong> ${desa.totalBantuanBarang} unit</div>
                        ${tahunDistribusi !== '-' ? `<div><strong>Tahun Distribusi:</strong> ${tahunDistribusi}</div>` : ''}
                    </div>
                    <div>
                        <strong>Jenis Bantuan:</strong>
                        ${jenisBantuanHtml}
                    </div>
                </div>
            `;
        }
        
        function showDesaDetail(desa) {
            currentDesaData = desa;
            
            const panelContent = document.getElementById('panelContent');
            
            // Format jenis bantuan list
            const jenisBantuanList = desa.jenisBantuan && desa.jenisBantuan.length > 0 
                ? desa.jenisBantuan.map(jenis => `
                    <div class="jenis-item">
                        <span class="jenis-name">${jenis.jenis}</span>
                        <span class="jenis-count">${jenis.jumlah} penerima</span>
                    </div>
                `).join('')
                : `
                    <div class="jenis-item">
                        <span class="jenis-name">Barang</span>
                        <span class="jenis-count">${desa.jumlahPenerima} penerima</span>
                    </div>
                `;
            
            // Format tahun distribusi
            let tahunDistribusiHtml = '';
            if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                tahunDistribusiHtml = `
                    <h6 style="color: var(--primary-dark); margin-top: 15px; margin-bottom: 10px;">
                        <i class="fas fa-calendar me-2"></i> Tahun Distribusi
                    </h6>
                    <div class="jenis-bantuan-list">
                        ${desa.tahunDistribusi.map(t => `
                            <div class="jenis-item">
                                <span class="jenis-name">${t.tahun}</span>
                                <span class="jenis-count">${t.jumlah} penerima</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            // Format kelompok distribusi
            let kelompokDistribusiHtml = '';
            if (desa.kelompokDistribusi) {
                if (Array.isArray(desa.kelompokDistribusi)) {
                    kelompokDistribusiHtml = `
                        <h6 style="color: var(--primary-dark); margin-top: 15px; margin-bottom: 10px;">
                            <i class="fas fa-users me-2"></i> Kelompok Distribusi
                        </h6>
                        <div class="jenis-bantuan-list">
                            ${desa.kelompokDistribusi.map(k => `
                                <div class="jenis-item">
                                    <span class="jenis-name">${k.kelompok}</span>
                                    <span class="jenis-count">${k.jumlah} penerima</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else if (typeof desa.kelompokDistribusi === 'object') {
                    kelompokDistribusiHtml = `
                        <h6 style="color: var(--primary-dark); margin-top: 15px; margin-bottom: 10px;">
                            <i class="fas fa-users me-2"></i> Kelompok Distribusi
                        </h6>
                        <div class="jenis-bantuan-list">
                            ${Object.entries(desa.kelompokDistribusi).map(([key, value]) => `
                                <div class="jenis-item">
                                    <span class="jenis-name">${key}</span>
                                    <span class="jenis-count">${value} penerima</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
            
            panelContent.innerHTML = `
                <div class="desa-card">
                    <h4 class="desa-name">${desa.desa}</h4>
                    <p class="desa-kecamatan"><i class="fas fa-map-marker-alt me-1"></i> Kecamatan ${desa.kecamatan}</p>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value">${desa.jumlahPenerima}</div>
                            <div class="stat-label">Penerima</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${desa.totalBantuanBarang}</div>
                            <div class="stat-label">Bantuan Barang</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${desa.totalBantuanUang > 0 ? 'Rp ' + formatNumber(desa.totalBantuanUang) : '0'}</div>
                            <div class="stat-label">Bantuan Uang</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${desa.totalBantuanJasa}</div>
                            <div class="stat-label">Bantuan Jasa</div>
                        </div>
                    </div>
                    
                    <h6 style="color: var(--primary-dark); margin-top: 20px; margin-bottom: 10px;">
                        <i class="fas fa-gift me-2"></i> Jenis Bantuan
                    </h6>
                    <div class="jenis-bantuan-list">
                        ${jenisBantuanList}
                    </div>
                    
                    ${tahunDistribusiHtml}
                    ${kelompokDistribusiHtml}
                    
                    <div class="mt-4 pt-3 border-top">
                        <small class="text-muted">
                            <i class="fas fa-info-circle me-1"></i>
                            Data terakhir diperbarui: ${petaData.metadata.lastUpdate}
                        </small>
                    </div>
                </div>
            `;
            
            // Open side panel
            document.getElementById('sidePanel').classList.add('open');
        }
        
        function populateFilters() {
            if (!petaData || !petaData.data) return;
            
            // Get unique kecamatan
            const kecamatanSet = new Set(petaData.data.map(d => d.kecamatan));
            const kecamatanSelect = document.getElementById('filterKecamatan');
            
            // Clear and add options
            kecamatanSelect.innerHTML = '<option value="">Semua Kecamatan</option>';
            kecamatanSet.forEach(kec => {
                kecamatanSelect.add(new Option(kec, kec));
            });
            
            // Get unique years from data
            const tahunSet = new Set();
            petaData.data.forEach(desa => {
                if (desa.tahunDistribusi && Array.isArray(desa.tahunDistribusi)) {
                    desa.tahunDistribusi.forEach(t => {
                        if (t.tahun) tahunSet.add(t.tahun);
                    });
                }
            });
            
            const tahunSelect = document.getElementById('filterTahun');
            tahunSelect.innerHTML = '<option value="">Semua Tahun</option>';
            const tahunArray = Array.from(tahunSet).sort((a, b) => b - a); // Sort descending
            tahunArray.forEach(tahun => {
                tahunSelect.add(new Option(tahun, tahun));
            });
        }
        
        function applyFilters() {
            if (!petaData || !petaData.data) return;
            
            const filterKecamatan = document.getElementById('filterKecamatan').value;
            const filterJenis = document.getElementById('filterJenis').value;
            const filterTahun = document.getElementById('filterTahun').value;
            
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            // Filter data
            const filteredData = petaData.data.filter(desa => {
                // Filter by kecamatan
                if (filterKecamatan && desa.kecamatan !== filterKecamatan) return false;
                
                // Filter by jenis bantuan (if desa has that jenis)
                if (filterJenis) {
                    if (!desa.jenisBantuan || !Array.isArray(desa.jenisBantuan)) return false;
                    const hasJenis = desa.jenisBantuan.some(j => j.jenis === filterJenis);
                    if (!hasJenis) return false;
                }
                
                // Filter by tahun
                if (filterTahun) {
                    if (!desa.tahunDistribusi || !Array.isArray(desa.tahunDistribusi)) return false;
                    const hasTahun = desa.tahunDistribusi.some(t => t.tahun === filterTahun);
                    if (!hasTahun) return false;
                }
                
                return true;
            });
            
            // Add filtered markers
            filteredData.forEach(desa => {
                addMarker(desa);
            });
            
            // Update summary
            document.getElementById('totalDesa').textContent = filteredData.length;
            const totalPenerima = filteredData.reduce((sum, desa) => sum + desa.jumlahPenerima, 0);
            document.getElementById('totalPenerima').textContent = totalPenerima;
            
            // Show filter info
            if (filterKecamatan || filterJenis || filterTahun) {
                showToast(`Menampilkan ${filteredData.length} desa (terfilter)`, 'info');
            }
        }
        
        function toggleSidePanel() {
            document.getElementById('sidePanel').classList.toggle('open');
        }
        
        function reloadDataPeta() {
            showToast('Memuat ulang data peta dari GitHub...', 'info');
            loadDataPeta();
        }
        
        // ========== UTILITY FUNCTIONS ==========
        function formatNumber(num) {
            if (isNaN(num)) return '0';
            return new Intl.NumberFormat('id-ID').format(num);
        }
        
        // ========== FORM PENGADUAN FUNCTIONS ==========
        function kirimKeWA(e) {
            e.preventDefault();

            let nama = document.getElementById('nama').value;
            let nik = document.getElementById('nik').value;
            let wa = document.getElementById('whatsapp').value;
            let email = document.getElementById('email').value || '-';
            let alamat = document.getElementById('alamat').value;
            let perihal = document.getElementById('perihal').value;

            let targetNumber = "6287865614222"; 

            let pesan = `*LAPORAN PENGADUAN NELAYAN*%0A` +
                        `--------------------------------%0A` +
                        `*Nama:* ${nama}%0A` +
                        `*NIK:* ${nik}%0A` +
                        `*Alamat:* ${alamat}%0A` +
                        `*No. WA:* ${wa}%0A` +
                        `*Email:* ${email}%0A` +
                        `--------------------------------%0A` +
                        `*Perihal / Isi Laporan:*%0A` +
                        `${perihal}`;

            let url = `https://api.whatsapp.com/send?phone=${targetNumber}&text=${pesan}`;
            window.open(url, '_blank');
        }
        
        // ========== LIGHTBOX FUNCTIONS ==========
        let currentIndex = 0;
        const photoUrls = [
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg'
        ];

        function openLightbox(index) {
            currentIndex = index;
            updateLightbox();
            const lightboxModal = new bootstrap.Modal(document.getElementById('lightboxModal'));
            lightboxModal.show();
        }

        function updateLightbox() {
            const lightboxImage = document.getElementById('lightboxImage');
            lightboxImage.src = photoUrls[currentIndex];
            lightboxImage.alt = `Kegiatan ${currentIndex + 1}`;
            document.getElementById('lightboxModalLabel').textContent = `Galeri Kegiatan - Foto ${currentIndex + 1}`;
        }
        
        // Keyboard navigation untuk lightbox
        document.addEventListener('keydown', function(e) {
            const lightboxModal = document.getElementById('lightboxModal');
            if (lightboxModal.classList.contains('show')) {
                if (e.key === 'ArrowLeft' && currentIndex > 0) {
                    currentIndex--;
                    updateLightbox();
                } else if (e.key === 'ArrowRight' && currentIndex < photoUrls.length - 1) {
                    currentIndex++;
                    updateLightbox();
                } else if (e.key === 'Escape') {
                    const modal = bootstrap.Modal.getInstance(lightboxModal);
                    if (modal) modal.hide();
                }
            }
        });
    </script>
</body>
</html>
