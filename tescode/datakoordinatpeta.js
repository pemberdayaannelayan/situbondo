/**
 * DATABASE KOORDINAT PETA SIMATA
 * Sistem Pemetaan Nelayan - Dinas Perikanan Kabupaten Situbondo
 * Versi: 2.0 (Database Lengkap)
 */

// ============================================
// DATABASE KOORDINAT LENGKAP KABUPATEN SITUBONDO
// ============================================

const SIMATA_COORDINATES_DATABASE = {
    // 1. KECAMATAN PANARUKAN
    "Panarukan, Alasmalang": [-7.6970, 113.7687],
    "Panarukan, Duwet": [-7.6977, 113.7882],
    "Panarukan, Gelung": [-7.7134, 113.8028],
    "Panarukan, Kilensari": [-7.6843, 113.7656],
    "Panarukan, Paowan": [-7.7298, 113.7800],
    "Panarukan, Peleyan": [-7.6950, 113.8071],
    "Panarukan, Sumberkolak": [-7.7118, 113.7618],
    "Panarukan, Wringinanom": [-7.7061, 113.8256],
    
    // 2. KECAMATAN PANJI
    "Panji, Ardirejo": [-7.7155, 113.6944],
    "Panji, Mimbaan": [-7.7091, 113.6952],
    "Panji, Battal": [-7.7099, 113.6780],
    "Panji, Curah Jeru": [-7.6941, 113.6958],
    "Panji, Juglangan": [-7.6946, 113.6653],
    "Panji, Kayu Putih": [-7.7025, 113.6737],
    "Panji, Klampokan": [-7.7272, 113.6482],
    "Panji, Panji Kidul": [-7.7126, 113.7038],
    "Panji, Panji Lor": [-7.7019, 113.7059],
    "Panji, Sliwung": [-7.7188, 113.6806],
    "Panji, Tenggir": [-7.7163, 113.6579],
    "Panji, Tokelan": [-7.7320, 113.6703],
    
    // 3. KECAMATAN SITUBONDO
    "Situbondo, Kalibagor": [-7.7082, 114.0061],
    "Situbondo, Kotakan": [-7.6814, 114.0225],
    "Situbondo, Olean": [-7.6819, 114.0367],
    "Situbondo, Talkandang": [-7.6681, 114.0475],
    "Situbondo, Dawuhan": [-7.6926, 113.9937],
    "Situbondo, Patokan": [-7.6729, 113.9771],
    
    // 4. KECAMATAN SUBOH
    "Suboh, Buduan": [-7.8523, 113.7659],
    "Suboh, Cemara": [-7.8267, 113.7425],
    "Suboh, Dawuan": [-7.8398, 113.7719],
    "Suboh, Gunung Malang": [-7.8708, 113.7489],
    "Suboh, Gunung Putri": [-7.8647, 113.7325],
    "Suboh, Ketah": [-7.8614, 113.7894],
    "Suboh, Mojodungkol": [-7.8360, 113.7829],
    "Suboh, Suboh": [-7.8475, 113.7580],
    
    // 5. KECAMATAN SUMBERMALANG
    "Sumbermalang, Alastengah": [-7.8771, 113.8437],
    "Sumbermalang, Baderan": [-7.8318, 113.8214],
    "Sumbermalang, Kalirejo": [-7.8203, 113.8525],
    "Sumbermalang, Plalangan": [-7.8630, 113.8629],
    "Sumbermalang, Sumberargo": [-7.8405, 113.8077],
    "Sumbermalang, Taman": [-7.8482, 113.8374],
    "Sumbermalang, Tamankursi": [-7.8641, 113.8256],
    "Sumbermalang, Tamansari": [-7.8618, 113.8125],
    "Sumbermalang, Tlogosari": [-7.8816, 113.8243],
    
    // 6. KECAMATAN ARJASA
    "Arjasa, Arjasa": [-7.7825, 113.7900],
    "Arjasa, Bayeman": [-7.8000, 113.8100],
    "Arjasa, Curah Tatal": [-7.7700, 113.7800],
    "Arjasa, Jatisari": [-7.7900, 113.8000],
    "Arjasa, Kayumas": [-7.7750, 113.7950],
    "Arjasa, Kedungdowo": [-7.7850, 113.8050],
    "Arjasa, Ketowan": [-7.7950, 113.7850],
    "Arjasa, Lamongan": [-7.7800, 113.7900],
    
    // 7. KECAMATAN ASEMBAGUS
    "Asembagus, Asembagus": [-7.7533, 114.2500],
    "Asembagus, Awar-awar": [-7.7400, 114.2300],
    "Asembagus, Bantal": [-7.7450, 114.2400],
    "Asembagus, Gudang": [-7.7500, 114.2550],
    "Asembagus, Kedunglo": [-7.7600, 114.2450],
    "Asembagus, Kertosari": [-7.7550, 114.2350],
    "Asembagus, Mojosari": [-7.7650, 114.2500],
    "Asembagus, Parante": [-7.7580, 114.2600],
    "Asembagus, Trigonco": [-7.7480, 114.2650],
    "Asembagus, Wringin Anom": [-7.7420, 114.2700],
    
    // 8. KECAMATAN BANYUGLUGUR
    "Banyuglugur, Banyuglugur": [-7.8000, 113.8667],
    "Banyuglugur, Kalianget": [-7.8100, 113.8500],
    "Banyuglugur, Kalisari": [-7.8050, 113.8600],
    "Banyuglugur, Lubawang": [-7.8150, 113.8700],
    "Banyuglugur, Selobanteng": [-7.8200, 113.8750],
    "Banyuglugur, Telempong": [-7.7950, 113.8650],
    "Banyuglugur, Tepos": [-7.7900, 113.8550],
    
    // 9. KECAMATAN BANYUPUTIH
    "Banyuputih, Banyuputih": [-7.7167, 114.0833],
    "Banyuputih, Sumberanyar": [-7.7100, 114.0900],
    "Banyuputih, Sumberejo": [-7.7200, 114.0950],
    "Banyuputih, Sumberwaru": [-7.7150, 114.0850],
    "Banyuputih, Wonorejo": [-7.7250, 114.1000],
    
    // 10. KECAMATAN BESUKI
    "Besuki, Besuki": [-7.7333, 113.7000],
    "Besuki, Blimbing": [-7.7400, 113.7100],
    "Besuki, Bloro": [-7.7350, 113.7050],
    "Besuki, Demung": [-7.7300, 113.6950],
    "Besuki, Jetis": [-7.7250, 113.6900],
    "Besuki, Kalimas": [-7.7200, 113.6850],
    "Besuki, Langkap": [-7.7150, 113.6800],
    "Besuki, Pesisir": [-7.7100, 113.6750],
    "Besuki, Sumberejo": [-7.7050, 113.6700],
    "Besuki, Widoropayung": [-7.7000, 113.6650],
    
    // 11. KECAMATAN BUNGATAN
    "Bungatan, Bletok": [-7.6500, 113.8833],
    "Bungatan, Bungatan": [-7.6550, 113.8900],
    "Bungatan, Mlandingan Wetan": [-7.6600, 113.8950],
    "Bungatan, Pasir Putih": [-7.6650, 113.9000],
    "Bungatan, Patemon": [-7.6700, 113.9050],
    "Bungatan, Selowogo": [-7.6750, 113.9100],
    "Bungatan, Sumbertengah": [-7.6800, 113.9150],
    
    // 12. KECAMATAN JANGKAR
    "Jangkar, Agel": [-7.7667, 114.1667],
    "Jangkar, Curah Kalak": [-7.7700, 114.1700],
    "Jangkar, Gadingan": [-7.7750, 114.1750],
    "Jangkar, Jangkar": [-7.7800, 114.1800],
    "Jangkar, Kumbangsari": [-7.7850, 114.1850],
    "Jangkar, Palangan": [-7.7900, 114.1900],
    "Jangkar, Pesanggrahan": [-7.7950, 114.1950],
    "Jangkar, Sopet": [-7.8000, 114.2000],
    
    // 13. KECAMATAN JATIBANTENG
    "Jatibanteng, Curahsuri": [-7.8000, 113.9333],
    "Jatibanteng, Jatibanteng": [-7.8050, 113.9400],
    "Jatibanteng, Kembangsari": [-7.8100, 113.9450],
    "Jatibanteng, Pategalan": [-7.8150, 113.9500],
    "Jatibanteng, Patemon": [-7.8200, 113.9550],
    "Jatibanteng, Semambung": [-7.8250, 113.9600],
    "Jatibanteng, Sumberanyar": [-7.8300, 113.9650],
    "Jatibanteng, Wringinanom": [-7.8350, 113.9700],
    
    // 14. KECAMATAN KAPONGAN
    "Kapongan, Curah Cottok Gebangan": [-7.6833, 114.0667],
    "Kapongan, Kandang": [-7.6900, 114.0700],
    "Kapongan, Kapongan": [-7.6950, 114.0750],
    "Kapongan, Kesambi Rampak": [-7.7000, 114.0800],
    "Kapongan, Landangan": [-7.7050, 114.0850],
    "Kapongan, Peleyan": [-7.7100, 114.0900],
    "Kapongan, Pokaan": [-7.7150, 114.0950],
    "Kapongan, Seletreng": [-7.7200, 114.1000],
    "Kapongan, Wonokoyo": [-7.7250, 114.1050],
    
    // 15. KECAMATAN KENDIT
    "Kendit, Balung": [-7.7167, 113.9167],
    "Kendit, Bugeman": [-7.7200, 113.9200],
    "Kendit, Kendit": [-7.7250, 113.9250],
    "Kendit, Klatakan": [-7.7300, 113.9300],
    "Kendit, Kukusan": [-7.7350, 113.9350],
    "Kendit, Rajekwesi": [-7.7400, 113.9400],
    "Kendit, Tambak Ukir": [-7.7450, 113.9450],
    
    // 16. KECAMATAN MANGARAN
    "Mangaran, Mangaran": [-7.6667, 114.0500],
    "Mangaran, Semiring": [-7.6700, 114.0550],
    "Mangaran, Tanjung Glugur": [-7.6750, 114.0600],
    "Mangaran, Tanjung Kamal": [-7.6800, 114.0650],
    "Mangaran, Tanjung Pecinan": [-7.6850, 114.0700],
    "Mangaran, Trebungan": [-7.6900, 114.0750],
    
    // 17. KECAMATAN MLANDINGAN
    "Mlandingan, Alas Bayur": [-7.6667, 113.8667],
    "Mlandingan, Campoan": [-7.6700, 113.8700],
    "Mlandingan, Mlandingan Kulon": [-7.6750, 113.8750],
    "Mlandingan, Selomukti": [-7.6800, 113.8800],
    "Mlandingan, Sumberanyar": [-7.6850, 113.8850],
    "Mlandingan, Sumber Pinang": [-7.6900, 113.8900],
    "Mlandingan, Trebungan": [-7.6950, 113.8950]
};

// ============================================
// FUNGSI UTILITAS UNTUK PETA
// ============================================

/**
 * Mendapatkan koordinat berdasarkan kecamatan dan desa
 * @param {string} kecamatan - Nama kecamatan
 * @param {string} desa - Nama desa
 * @returns {Array} [latitude, longitude] atau default koordinat Situbondo
 */
function getCoordinatesForLocation(kecamatan, desa) {
    const key = `${kecamatan}, ${desa}`;
    
    if (SIMATA_COORDINATES_DATABASE[key]) {
        return SIMATA_COORDINATES_DATABASE[key];
    }
    
    // Fallback ke koordinat default berdasarkan kecamatan
    const DEFAULT_COORDINATES = {
        "Arjasa": [-7.7825, 113.7900],
        "Asembagus": [-7.7533, 114.2500],
        "Banyuglugur": [-7.8000, 113.8667],
        "Banyuputih": [-7.7167, 114.0833],
        "Besuki": [-7.7333, 113.7000],
        "Bungatan": [-7.6500, 113.8833],
        "Jangkar": [-7.7667, 114.1667],
        "Jatibanteng": [-7.8000, 113.9333],
        "Kapongan": [-7.6833, 114.0667],
        "Kendit": [-7.7167, 113.9167],
        "Mangaran": [-7.6667, 114.0500],
        "Mlandingan": [-7.6667, 113.8667],
        "Panarukan": [-7.7068, 113.8000],
        "Panji": [-7.7120, 113.6800],
        "Situbondo": [-7.7068, 113.9142],
        "Suboh": [-7.8500, 113.7600],
        "Sumbermalang": [-7.8600, 113.8300]
    };
    
    if (DEFAULT_COORDINATES[kecamatan]) {
        return DEFAULT_COORDINATES[kecamatan];
    }
    
    // Default ke pusat Kabupaten Situbondo
    return [-7.7068, 113.9142];
}

/**
 * Mendapatkan semua koordinat yang tersedia
 * @returns {Object} Database lengkap koordinat
 */
function getAllCoordinates() {
    return SIMATA_COORDINATES_DATABASE;
}

/**
 * Mendapatkan koordinat kecamatan tertentu
 * @param {string} kecamatan - Nama kecamatan
 * @returns {Array} Array of [latitude, longitude] untuk setiap desa
 */
function getCoordinatesByKecamatan(kecamatan) {
    const result = [];
    for (const [key, value] of Object.entries(SIMATA_COORDINATES_DATABASE)) {
        if (key.startsWith(kecamatan + ",")) {
            result.push({
                desa: key.split(", ")[1],
                coordinates: value
            });
        }
    }
    return result;
}

/**
 * Validasi koordinat (cek apakah koordinat valid)
 * @param {number} lat - Latitude
 * @param {number} lng - Longitude
 * @returns {boolean} True jika koordinat valid
 */
function isValidCoordinate(lat, lng) {
    return lat >= -90 && lat <= 90 && lng >= -180 && lng <= 180;
}

/**
 * Menambahkan koordinat baru ke database
 * @param {string} kecamatan - Nama kecamatan
 * @param {string} desa - Nama desa
 * @param {number} lat - Latitude
 * @param {number} lng - Longitude
 * @returns {boolean} True jika berhasil ditambahkan
 */
function addCoordinate(kecamatan, desa, lat, lng) {
    if (!isValidCoordinate(lat, lng)) {
        console.error('Koordinat tidak valid');
        return false;
    }
    
    const key = `${kecamatan}, ${desa}`;
    SIMATA_COORDINATES_DATABASE[key] = [lat, lng];
    return true;
}

/**
 * Mengekspor database koordinat ke format JSON
 * @returns {string} JSON string dari database koordinat
 */
function exportCoordinatesToJSON() {
    return JSON.stringify(SIMATA_COORDINATES_DATABASE, null, 2);
}

/**
 * Mengimpor database koordinat dari JSON
 * @param {string} jsonData - JSON string database koordinat
 * @returns {boolean} True jika berhasil diimpor
 */
function importCoordinatesFromJSON(jsonData) {
    try {
        const data = JSON.parse(jsonData);
        Object.assign(SIMATA_COORDINATES_DATABASE, data);
        return true;
    } catch (error) {
        console.error('Gagal mengimpor data koordinat:', error);
        return false;
    }
}

// ============================================
// EKSPOR FUNGSI KE GLOBAL SCOPE
// ============================================

// Ekspor fungsi ke global scope untuk digunakan di file lain
if (typeof window !== 'undefined') {
    window.SIMATA_COORDINATES = {
        getCoordinatesForLocation,
        getAllCoordinates,
        getCoordinatesByKecamatan,
        isValidCoordinate,
        addCoordinate,
        exportCoordinatesToJSON,
        importCoordinatesFromJSON,
        database: SIMATA_COORDINATES_DATABASE
    };
    
    console.log('âœ… Database Koordinat Peta SIMATA v2.0 loaded successfully');
}

// Ekspor untuk environment Node.js (jika diperlukan)
if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        SIMATA_COORDINATES_DATABASE,
        getCoordinatesForLocation,
        getAllCoordinates,
        getCoordinatesByKecamatan,
        isValidCoordinate,
        addCoordinate,
        exportCoordinatesToJSON,
        importCoordinatesFromJSON
    };
}
