<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Bidang Pemberdayaan Nelayan - Dinas Perikanan Situbondo</title>
    <meta name="description" content="Website resmi Bidang Pemberdayaan Nelayan Dinas Perikanan Kabupaten Situbondo. Layanan pengajuan KUSUKA, SIMATA, Bantuan Sarpras, dan Pengaduan Nelayan secara online.">
    <meta name="keywords" content="Dinas Perikanan Situbondo, SIMATA Situbondo, Peta Nelayan, Pemberdayaan Nelayan, Kartu KUSUKA, Bantuan Kapal, Pengaduan Nelayan, Layanan Nelayan">
    <meta name="author" content="Dinas Perikanan Situbondo">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#0284c7">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.dinasperikanansitubondo.com/">
    <meta property="og:title" content="Layanan Pemberdayaan Nelayan - Situbondo">
    <meta property="og:description" content="Akses mudah data KUSUKA, SIMATA, Bantuan Sarpras, dan Saluran Aspirasi Masyarakat Pesisir Situbondo.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS untuk peta -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Chart.js untuk statistik -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Satisfy&display=swap" rel="stylesheet">
    
    <!-- Font Awesome & AOS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            /* Palette Warna Laut Cerah & Profesional */
            --primary: #1a237e;
            --primary-dark: #0c4a6e;
            --secondary: #283593;
            --accent: #1976d2;
            --accent-dark: #1565c0;
            --success-color: #06d6a0;
            --warning-color: #ffd166;
            --danger-color: #ff6b6b;
            --light-bg: #f0f9ff;
            --white: #ffffff;
            
            --text-main: #0f172a;
            --text-sub: #475569;
            --gray-color: #666;

            --font-head: 'Outfit', sans-serif;
            --font-body: 'Plus Jakarta Sans', sans-serif;
            --font-signature: 'Satisfy', cursive;
            
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-sub);
            background-color: var(--light-bg);
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, .navbar-brand {
            font-family: var(--font-head);
            color: var(--text-main);
        }

        /* --- CSS untuk Slogan Signatur (Pemberdayaan Nelayan) --- */
        .slogan-signature {
            font-family: var(--font-signature);
            color: var(--primary);
            font-size: calc(2rem + 1vw); 
            font-weight: 700; 
            line-height: 1.2;
            margin-bottom: 10px;
            display: inline-block;
        }

        /* --- CSS Revisi untuk kata 'untuk' (Kecil & Bersih) --- */
        .connector-text {
            font-family: var(--font-body);
            font-size: 0.5em;
            font-weight: 400;
            font-style: italic;
            color: var(--text-sub);
            vertical-align: middle;
            margin: 0 5px;
            letter-spacing: 1px;
        }

        /* --- CSS Revisi untuk 'Situbondo Naik Kelas' (Orange) --- */
        .text-orange-gradient {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            text-shadow: 0px 4px 10px rgba(245, 158, 11, 0.2);
        }

        /* --- Navbar (Clean & Glassy) --- */
        .navbar {
            padding: 10px 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .navbar-brand img {
            height: 55px; 
            width: auto;
            object-fit: contain;
            transition: transform 0.3s;
        }

        .navbar-brand:hover img {
            transform: scale(1.05);
        }

        .brand-text h5 {
            font-weight: 800;
            margin: 0;
            line-height: 1;
            color: var(--primary-dark);
            letter-spacing: -0.5px;
        }
        .brand-text span {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .nav-link {
            font-weight: 600;
            color: var(--text-main) !important;
            margin: 0 10px;
            position: relative;
            transition: 0.3s;
        }

        .nav-link:hover {
            color: var(--primary) !important;
        }

        .btn-cta {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 10px 30px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(2, 132, 199, 0.3);
            transition: 0.3s;
        }
        
        .btn-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(2, 132, 199, 0.4);
            color: white;
        }

        /* --- Hero Section --- */
        .hero-section {
            min-height: 100vh;
            background: url('https://images.unsplash.com/photo-1583212292454-1fe6229603b7?q=80&w=2074&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            display: flex;
            align-items: center;
            padding-top: 140px; 
            padding-bottom: 80px;
        }

        .hero-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to right, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.7) 60%, rgba(255,255,255,0) 100%);
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-badge {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border: 1px solid var(--primary);
            color: var(--primary-dark);
            padding: 10px 24px;
            border-radius: 30px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        /* --- ANIMASI TOMBOL --- */
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(2, 132, 199, 0); }
            100% { box-shadow: 0 0 0 0 rgba(2, 132, 199, 0); }
        }

        .btn-pulse-primary {
            animation: pulse-glow 2s infinite;
        }

        .btn-pulse-outline {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .btn-pulse-outline:hover {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 0 20px rgba(2, 132, 199, 0.5);
        }

        /* --- Service Cards --- */
        .section-header h2 {
            font-weight: 800;
            color: var(--primary-dark);
        }
        
        .service-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            border: 1px solid rgba(2, 132, 199, 0.1); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
            transition: all 0.4s ease;
            height: 100%;
            position: relative;
            display: block;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .service-card::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            transform: scaleX(0);
            transform-origin: left;
            transition: 0.4s;
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(2, 132, 199, 0.15);
        }

        .service-card:hover::after {
            transform: scaleX(1);
        }

        /* --- LOGO LANGSUNG DI MENU (TANPA ICON BOX) --- */
        .menu-logo {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin: 0 auto 25px auto;
            display: block;
            transition: transform 0.4s ease;
        }

        .service-card:hover .menu-logo {
            transform: scale(1.1);
        }

        .card-link-text {
            color: var(--primary);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: auto; 
            padding-top: 20px;
        }

        /* --- Galeri Foto Thumbnail Styles --- */
        .gallery-thumbnail-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin-top: 20px;
            margin-bottom: 20px;
            height: 180px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .gallery-thumbnail-item {
            position: relative;
            overflow: hidden;
            border-radius: 5px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .gallery-thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .gallery-thumbnail-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 132, 199, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-thumbnail-item:hover .gallery-overlay {
            opacity: 1;
        }

        /* --- LOGO PEMBERDAYAAN NELAYAN DI INFO PANEL --- */
        .info-panel-logo {
            width: 180px;
            height: auto;
            margin: 0 auto 25px auto;
            display: block;
        }

        /* --- STYLE UNTUK PETA STATISTIK NELAYAN --- */
        .peta-statistik-container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .peta-statistik-header {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 25px 40px;
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            position: relative;
            z-index: 2;
        }
        
        .header-bg {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 40%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: cover;
        }
        
        .peta-statistik-title {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .peta-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
            max-width: 800px;
        }
        
        .metadata {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .meta-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 18px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .meta-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
        }
        
        .meta-item i {
            font-size: 1.1rem;
        }
        
        .peta-content {
            display: flex;
            flex-wrap: wrap;
            min-height: 700px;
        }
        
        .peta-sidebar {
            flex: 1;
            min-width: 350px;
            background: #f8f9fa;
            padding: 25px;
            border-right: 1px solid #e0e0e0;
            overflow-y: auto;
            max-height: 800px;
        }
        
        .peta-map-container {
            flex: 2;
            min-width: 600px;
            height: 700px;
            position: relative;
        }
        
        #statistikMap {
            width: 100%;
            height: 100%;
            border-radius: 0 0 20px 0;
        }
        
        .stats-box {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
            border-left: 6px solid var(--accent);
            transition: var(--transition);
        }
        
        .stats-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stats-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 18px 12px;
            background: #f5f7ff;
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--accent), var(--primary));
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
            background: #e8eeff;
            box-shadow: 0 8px 15px rgba(25, 118, 210, 0.15);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: var(--gray-color);
        }
        
        .desa-list {
            max-height: 350px;
            overflow-y: auto;
            border-radius: 12px;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .desa-list-header {
            padding: 12px 18px;
            background: var(--primary);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .desa-item {
            padding: 15px 18px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .desa-item:hover {
            background: #e8eeff;
            padding-left: 22px;
        }
        
        .desa-item.active {
            background: #d1e7ff;
            border-left: 5px solid var(--accent);
        }
        
        .desa-name {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 0.95rem;
        }
        
        .desa-details {
            font-size: 0.8rem;
            color: var(--gray-color);
            display: flex;
            gap: 12px;
        }
        
        .peta-legend {
            position: absolute;
            bottom: 25px;
            right: 25px;
            background: white;
            padding: 18px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 250px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .legend-title {
            font-weight: bold;
            margin-bottom: 12px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            border: 3px solid white;
            box-shadow: 0 0 8px rgba(0,0,0,0.3);
        }
        
        .legend-label {
            font-size: 0.85rem;
        }
        
        .peta-controls {
            position: absolute;
            top: 25px;
            right: 25px;
            z-index: 1000;
            display: flex;
            gap: 12px;
        }
        
        .control-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .control-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
        }
        
        .peta-footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            color: var(--gray-color);
            font-size: 0.9rem;
            border-top: 1px solid #e0e0e0;
        }
        
        .peta-footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .peta-footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            color: var(--primary);
            font-size: 0.9rem;
        }
        
        @media (max-width: 1200px) {
            .peta-content {
                flex-direction: column;
            }
            
            .peta-sidebar, .peta-map-container {
                min-width: 100%;
            }
            
            #statistikMap {
                border-radius: 0;
            }
            
            .peta-footer-content {
                flex-direction: column;
                text-align: center;
            }
        }
        
        @media (max-width: 768px) {
            .peta-statistik-title {
                font-size: 1.8rem;
            }
            
            .metadata {
                flex-direction: column;
                gap: 10px;
            }
            
            .peta-controls {
                flex-direction: column;
                top: 15px;
                right: 15px;
            }
            
            .peta-legend {
                bottom: 15px;
                right: 15px;
                left: 15px;
                max-width: none;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            width: 70px;
            height: 70px;
            border: 6px solid #f0f0f0;
            border-top: 6px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .chart-container {
            height: 180px;
            margin-top: 15px;
            position: relative;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            color: var(--gray-color);
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            font-size: 0.9rem;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--accent);
        }
        
        .tab:hover {
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .search-box {
            margin-bottom: 20px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 18px 12px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 50px;
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);
        }
        
        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-color);
        }
        
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 10000;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease-out;
            max-width: 400px;
            font-size: 0.9rem;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification.success {
            background: linear-gradient(to right, #06d6a0, #04b486);
            color: white;
        }
        
        .notification.error {
            background: linear-gradient(to right, #ff6b6b, #ff5252);
            color: white;
        }
        
        .notification.info {
            background: linear-gradient(to right, var(--accent), #1565c0);
            color: white;
        }
        
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .detail-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .detail-modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            background: linear-gradient(to right, var(--primary), var(--accent));
            color: white;
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        
        .modal-body {
            padding: 25px;
            overflow-y: auto;
            max-height: calc(90vh - 100px);
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .detail-item {
            padding: 18px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid var(--accent);
        }
        
        .detail-item-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 1rem;
        }
        
        .detail-item-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--text-main);
        }
        
        .auto-update-info {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 18px;
            border-radius: 50px;
            font-size: 0.85rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        /* --- Form Section --- */
        .aduan-section {
            padding: 100px 0;
            background-color: white; 
            position: relative;
        }

        .form-container {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08); 
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .info-panel {
            background: linear-gradient(160deg, var(--primary-dark) 0%, var(--primary) 100%);
            padding: 50px;
            color: white;
            position: relative;
        }

        .info-panel h3 { color: white !important; }
        .info-panel p { color: rgba(255,255,255,0.8); }

        .form-panel {
            padding: 50px;
            background-color: white;
        }

        .form-label {
            color: var(--text-main); 
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .form-control {
            background-color: #f8fafc;
            border: 2px solid #cbd5e1;
            color: #334155;
            padding: 12px 15px;
            border-radius: 10px;
            font-weight: 500;
        }

        .form-control:focus {
            background-color: white;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(2, 132, 199, 0.1);
            color: #000;
        }
        
        .form-control::placeholder {
            color: #94a3b8;
        }

        .btn-wa {
            background-color: #25D366;
            color: white;
            font-weight: 700;
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
            transition: 0.3s;
        }
        .btn-wa:hover {
            background-color: #1ebc57;
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
            color: white;
        }

        /* --- Peta Section --- */
        .peta-section {
            padding: 100px 0;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }

        /* --- Lightbox Modal Styles --- */
        .lightbox-modal .modal-dialog {
            max-width: 95%;
            max-height: 95vh;
            margin: 10px auto;
        }

        .lightbox-modal .modal-content {
            background: rgba(0, 0, 0, 0.9);
            border: none;
            border-radius: 10px;
            overflow: hidden;
        }

        .lightbox-modal .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
        }

        .lightbox-modal .modal-title {
            color: white;
            font-size: 1.2rem;
        }

        .lightbox-modal .btn-close {
            background-color: white;
            opacity: 1;
            padding: 8px;
            border-radius: 50%;
        }

        .lightbox-modal .modal-body {
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            max-height: 70vh;
            overflow: hidden;
        }

        .lightbox-modal .lightbox-image {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 5px;
        }

        .lightbox-modal .modal-footer {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lightbox-nav {
            display: flex;
            gap: 10px;
        }

        .lightbox-nav-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .lightbox-nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .lightbox-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .lightbox-zoom-controls {
            display: flex;
            gap: 10px;
        }

        .lightbox-counter {
            color: white;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }

        /* --- Footer --- */
        footer {
            background-color: var(--primary-dark);
            color: #cbd5e1;
            padding-top: 0;
            position: relative;
            margin-top: 50px;
        }

        .footer-wave {
            line-height: 0;
            width: 100%;
            background-color: white; 
        }
        .footer-wave svg {
            display: block;
            width: 100%;
            height: 60px;
            fill: var(--primary-dark);
        }

        .footer-content {
            padding: 60px 0 40px;
        }

        footer h5 {
            color: white;
            font-weight: 700;
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
        }

        footer h5::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -8px;
            width: 40px;
            height: 3px;
            background-color: #f59e0b;
            border-radius: 2px;
        }

        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            color: var(--secondary);
            padding-left: 5px;
        }

        .contact-item {
            display: flex;
            align-items: start;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .contact-icon {
            background: rgba(255,255,255,0.1);
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary);
            flex-shrink: 0;
        }

        .copyright {
            background-color: rgba(0,0,0,0.2);
            padding: 20px 0;
            text-align: center;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
        }

        /* --- RESPONSIVE MEDIA QUERIES --- */
        @media (max-width: 991px) {
            .hero-section {
                padding-top: 120px;
                text-align: center;
                background-position: left center;
            }
            .hero-overlay {
                background: linear-gradient(to bottom, rgba(240, 249, 255, 0.95) 0%, rgba(240, 249, 255, 0.8) 100%);
            }
            .hero-badge {
                margin: 0 auto 20px auto;
            }
            .d-flex.gap-3 {
                justify-content: center;
                flex-wrap: wrap;
            }
            .form-panel {
                padding: 30px 20px;
            }
            .info-panel {
                padding: 30px 20px;
            }
            .gallery-thumbnail-container {
                height: 150px;
            }
            .lightbox-modal .modal-dialog {
                max-width: 98%;
                margin: 5px auto;
            }
            .menu-logo {
                width: 100px;
                height: 100px;
            }
            .info-panel-logo {
                width: 150px;
            }
        }

        @media (max-width: 768px) {
            .gallery-thumbnail-container {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
                height: 200px;
            }
            .lightbox-modal .modal-footer {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            .lightbox-nav, .lightbox-zoom-controls {
                justify-content: center;
            }
            .menu-logo {
                width: 90px;
                height: 90px;
            }
            .info-panel-logo {
                width: 120px;
            }
            .peta-statistik-title {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 576px) {
            .display-3 {
                font-size: 2.5rem; 
            }
            .slogan-signature {
                font-size: 2rem;
                margin-bottom: 15px;
            }
            .lead {
                font-size: 1rem;
            }
            .hero-section {
                padding-top: 130px; 
                padding-bottom: 50px;
            }
            .navbar-brand div h5 {
                font-size: 1rem;
            }
            .navbar-brand div span {
                font-size: 0.65rem;
            }
            .btn-cta {
                width: 100%; 
                margin-bottom: 10px;
            }
            .btn-outline-primary {
                width: 100%;
            }
            .gallery-thumbnail-container {
                height: 160px;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
            }
            .lightbox-modal .modal-body {
                max-height: 60vh;
            }
            .menu-logo {
                width: 80px;
                height: 80px;
                margin-bottom: 20px;
            }
            .service-card {
                padding: 30px 20px;
            }
            .info-panel-logo {
                width: 100px;
                margin-bottom: 20px;
            }
            .peta-statistik-title {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 400px) {
            .gallery-thumbnail-container {
                height: 140px;
            }
            .menu-logo {
                width: 70px;
                height: 70px;
            }
            .info-panel-logo {
                width: 80px;
            }
        }
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div class="loading hidden" id="loadingScreen">
        <div class="spinner"></div>
        <h2 style="color: var(--primary); margin-bottom: 10px;">Memuat Peta Statistik</h2>
        <p style="color: var(--gray-color); max-width: 400px; text-align: center;">
            Sedang memuat data statistik nelayan Kabupaten Situbondo...
        </p>
    </div>

    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-3" href="https://www.dinasperikanansitubondo.com">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Pemerintah Kabupaten Situbondo">
                <div class="brand-text d-flex flex-column">
                    <h5>DINAS PERIKANAN</h5>
                    <span>KAB. SITUBONDO</span>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center gap-2">
                    <li class="nav-item"><a class="nav-link" href="https://www.dinasperikanansitubondo.com">Beranda</a></li>
                    <li class="nav-item ms-lg-3">
                        <a href="#aduan" class="btn btn-cta">Hubungi Kami</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="hero-section">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <div class="row">
                <div class="col-lg-7" data-aos="fade-right">
                    <div class="hero-badge text-nowrap">
                        <i class="fas fa-water"></i> <span>Dinas Perikanan Situbondo</span>
                    </div>
                    
                    <div class="slogan-signature">
                        Pemberdayaan Nelayan
                    </div>
                    <h1 class="display-3 fw-bold mb-4" style="color: var(--text-main);">
                        Dari Hulu ke Hilir <span class="connector-text">untuk</span> <br>
                        <span class="text-orange-gradient">Situbondo Naik Kelas</span>
                    </h1>
                    
                    <p class="lead mb-5" style="color: var(--text-sub); font-weight: 500;">
                        Program kegiatan Bidang Bina Pemberdayaan Nelayan yg merujuk pada rantai nilai perikanan, mulai dari kegiatan penangkapan ikan di laut (hulu) hingga proses pengolahan, distribusi, pemasaran, hingga akhirnya sampai ke konsumen (hilir), yang tujuannya meningkatkan kesejahteraan nelayan melalui data basis  nelayan yang terintegrasi, pemberdayaan, dan dukungan infrastruktur agar nelayan tidak tertinggal dan memiliki perlindungan sosial.
                    </p>
                    <div class="d-flex gap-3">
                        <a href="#layanan" class="btn btn-cta px-4 py-3 shadow btn-pulse-primary">Layanan Kami</a>
                        <a href="https://portaldata.kkp.go.id/" target="_blank" class="btn btn-outline-primary px-4 py-3 rounded-pill fw-bold btn-pulse-outline" style="border-width: 2px;">Portal Data KKP</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="layanan" class="py-5">
        <div class="container py-5">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Menu Layanan</span>
                <h2 class="display-6 mt-2">Akses Program Nelayan</h2>
                <div style="width: 80px; height: 4px; background: #f59e0b; margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Pilih menu di bawah ini untuk mengakses layanan digital dan program bantuan pemerintah.</p>
            </div>

            <div class="row g-4">
                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <a href="https://portaldata.kkp.go.id/" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kusuka.png" alt="Logo KUSUKA" class="menu-logo">
                        <h4 class="fw-bold mb-3">Kartu KUSUKA</h4>
                        <p class="text-muted">Akses Portal Data KKP untuk pendaftaran dan cek status identitas pelaku usaha perikanan (KUSUKA).</p>
                        <span class="card-link-text">Buka Portal <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="150">
                    <a href="#statistik" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logoku.png" alt="Logo SIMATA" class="menu-logo">
                        <h4 class="fw-bold mb-3">SIMATA</h4>
                        <p class="text-muted">Sistem Manajemen & Pemetaan Data. Monitoring data nelayan dan potensi tangkapan dalam satu peta.</p>
                        <span class="card-link-text">Lihat Peta Data <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="170">
                    <a href="https://www.dinasperikanansitubondo.com/kilat" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kilat.png" alt="Logo KILAT" class="menu-logo">
                        <h4 class="fw-bold mb-3">KILAT</h4>
                        <p class="text-muted">Kamera Interaktif Lacak Aktifitas Terkini. Aplikasi dokumentasi kegiatan dengan watermark lokasi dan waktu otomatis.</p>
                        <span class="card-link-text">Akses Kamera <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="190">
                    <a href="https://www.dinasperikanansitubondo.com/sismat" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/surat.png" alt="Logo SISMAT" class="menu-logo">
                        <h4 class="fw-bold mb-3">SISMAT</h4>
                        <p class="text-muted">Sistem Manajemen Surat. Layanan administrasi dan persuratan digital dinas perikanan.</p>
                        <span class="card-link-text">Buka Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <a href="https://www.dinasperikanansitubondo.com/barjas" target="_blank" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kapal.png" alt="Logo Bantuan Sarpras" class="menu-logo">
                        <h4 class="fw-bold mb-3">Bantuan Sarpras</h4>
                        <p class="text-muted">Informasi dan pengajuan bantuan sarana prasarana seperti mesin, jaring, dan perahu nelayan.</p>
                        <span class="card-link-text">Akses Aplikasi <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="210">
                    <a href="https://www.dinasperikanansitubondo.com/peraturankkp" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/peraturan.png" alt="Logo Peraturan Kemen-KP" class="menu-logo">
                        <h4 class="fw-bold mb-3">Peraturan Kemen-KP</h4>
                        <p class="text-muted">Akses kumpulan peraturan dan kebijakan Kementerian Kelautan dan Perikanan yang berlaku untuk nelayan dan pelaku usaha perikanan.</p>
                        <span class="card-link-text">Lihat Peraturan <i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="230">
                    <!-- GALERI FOTO THUMBNAIL BARU DENGAN LIGHTBOX -->
                    <div class="service-card" onclick="window.open('https://www.dinasperikanansitubondo.com/kegiatan/', '_blank')">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/galeri.png" alt="Logo Galeri" class="menu-logo">
                        <h4 class="fw-bold mb-3">Galeri Kegiatan</h4>
                        <p class="text-muted">Lihat dokumentasi kegiatan lapangan, pelatihan, dan program pemberdayaan nelayan Situbondo.</p>
                        
                        <!-- Grid Thumbnail Galeri dengan Lightbox -->
                        <div class="gallery-thumbnail-container">
                            <!-- Foto 1 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(0)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg" alt="Kegiatan 1" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 2 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(1)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg" alt="Kegiatan 2" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 3 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(2)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg" alt="Kegiatan 3" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 4 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(3)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg" alt="Kegiatan 4" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 5 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(4)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg" alt="Kegiatan 5" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 6 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(5)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg" alt="Kegiatan 6" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 7 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(6)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg" alt="Kegiatan 7" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 8 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(7)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg" alt="Kegiatan 8" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                            <!-- Foto 9 -->
                            <div class="gallery-thumbnail-item" onclick="event.stopPropagation(); openLightbox(8)">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg" alt="Kegiatan 9" loading="lazy">
                                <div class="gallery-overlay">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>
                        </div>
                        
                        <span class="card-link-text">Lihat Galeri Lengkap <i class="fas fa-arrow-right"></i></span>
                    </div>
                </div>

                <div class="col-xl-4 col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="310">
                    <a href="#aduan" class="service-card">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/layanan%20info.png" alt="Logo Layanan Aduan" class="menu-logo">
                        <h4 class="fw-bold mb-3">Layanan Aduan</h4>
                        <p class="text-muted">Sampaikan aspirasi, keluhan, atau permohonan informasi langsung kepada dinas secara online.</p>
                        <span class="card-link-text">Isi Formulir <i class="fas fa-arrow-down"></i></span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Peta Statistik Section -->
    <section id="statistik" class="peta-section">
        <div class="container">
            <div class="text-center mb-5 section-header" data-aos="fade-up">
                <span class="text-primary fw-bold text-uppercase letter-spacing-2">Data Statistik</span>
                <h2 class="display-6 mt-2">Peta Statistik Nelayan Kab. Situbondo</h2>
                <div style="width: 80px; height: 4px; background: #f59e0b; margin: 15px auto; border-radius: 2px;"></div>
                <p class="text-muted col-lg-6 mx-auto">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</p>
            </div>

            <div class="peta-statistik-container">
                <div class="peta-statistik-header">
                    <div class="header-bg"></div>
                    <div class="header-content">
                        <h1 class="peta-statistik-title"><i class="fas fa-map-marked-alt"></i> Peta Statistik Nelayan Kab. Situbondo</h1>
                        <div class="peta-subtitle">Visualisasi Data Bantuan Nelayan Berbasis Peta Digital - Sistem Pemantauan Terintegrasi</div>
                        <div class="metadata">
                            <div class="meta-item"><i class="fas fa-calendar-alt"></i> Terakhir Update: <span id="lastUpdate">9 Desember 2025</span></div>
                            <div class="meta-item"><i class="fas fa-village"></i> Total Desa: <span id="totalDesa">27</span></div>
                            <div class="meta-item"><i class="fas fa-users"></i> Total Penerima: <span id="totalPenerima">393</span></div>
                            <div class="meta-item"><i class="fas fa-box"></i> Total Bantuan: <span id="totalBantuan">424</span> Unit</div>
                            <div class="meta-item"><i class="fas fa-sync-alt"></i> Auto-update: <span id="autoReloadStatus">Aktif</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="peta-content">
                    <div class="peta-sidebar">
                        <div class="tabs">
                            <div class="tab active" data-tab="stats">Statistik</div>
                            <div class="tab" data-tab="desa">Daftar Desa</div>
                            <div class="tab" data-tab="charts">Grafik</div>
                        </div>
                        
                        <div class="tab-content active" id="stats-tab">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" id="searchDesa" placeholder="Cari desa atau kecamatan...">
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-bar"></i> Ringkasan Statistik</div>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryDesa">27</div>
                                        <div class="stat-label">Desa Terdata</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryPenerima">393</div>
                                        <div class="stat-label">Penerima Bantuan</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryBarang">424</div>
                                        <div class="stat-label">Bantuan Barang</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value" id="summaryUang">0</div>
                                        <div class="stat-label">Bantuan Uang</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-star"></i> Top 5 Desa Penerima</div>
                                <div id="topDesaList">
                                    <!-- Akan diisi oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="desa-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-list"></i> Daftar Desa/Kelurahan</div>
                                <div class="desa-list-header">
                                    <span>Nama Desa</span>
                                    <span>Penerima</span>
                                </div>
                                <div class="desa-list" id="desaList">
                                    <!-- Akan diisi oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="charts-tab">
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-pie"></i> Distribusi Bantuan</div>
                                <div class="chart-container">
                                    <canvas id="bantuanChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="stats-box">
                                <div class="stats-title"><i class="fas fa-chart-line"></i> Tren Tahun Distribusi</div>
                                <div class="chart-container">
                                    <canvas id="tahunChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="peta-map-container">
                        <div id="statistikMap"></div>
                        
                        <div class="peta-controls">
                            <button class="control-btn" id="reloadBtn">
                                <i class="fas fa-sync-alt"></i> Update Data
                            </button>
                            <button class="control-btn" id="resetViewBtn">
                                <i class="fas fa-globe-asia"></i> Reset Peta
                            </button>
                            <button class="control-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i> Layar Penuh
                            </button>
                        </div>
                        
                        <div class="peta-legend">
                            <div class="legend-title"><i class="fas fa-map-pin"></i> Kepadatan Penerima</div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--danger-color);"></div>
                                <div class="legend-label">Tinggi ( 50 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--warning-color);"></div>
                                <div class="legend-label">Sedang (20-49 penerima)</div>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: var(--success-color);"></div>
                                <div class="legend-label">Rendah ( 19 penerima)</div>
                            </div>
                        </div>
                        
                        <div class="auto-update-info">
                            <i class="fas fa-sync-alt"></i> Data diperbarui setiap <span id="reloadInterval">120</span> detik
                        </div>
                    </div>
                </div>
                
                <div class="peta-footer">
                    <div class="peta-footer-content">
                        <div class="peta-footer-logo">
                            <i class="fas fa-fish"></i>
                            <span>Sistem Bantuan Nelayan Kab. Situbondo</span>
                        </div>
                        <div>
                            <p><i class="fas fa-database"></i> Sumber Data: Dinas Peternakan dan Perikanan Kab. Situbondo</p>
                            <p><i class="fas fa-code"></i> Aplikasi Peta Statistik v3.0 | Data terakhir: <span id="footerUpdate">9 Desember 2025 pukul 18.54</span></p>
                        </div>
                        <div>
                            <p><i class="fas fa-clock"></i> Auto-update: <span id="footerReloadStatus">Aktif</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="aduan" class="aduan-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-10">
                    <div class="form-container" data-aos="zoom-in">
                        <div class="row g-0">
                            <div class="col-lg-4 info-panel d-flex flex-column justify-content-center">
                                <!-- LOGO PEMBERDAYAAN NELAYAN DIATAS TEKS -->
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo%20pemberdayaan%20nelayan.png" alt="Logo Pemberdayaan Nelayan" class="info-panel-logo">
                                
                                <h3 class="fw-bold mb-4 text-center">Pusat Bantuan</h3>
                                <p class="mb-4 text-center">Data yang Anda kirimkan akan diteruskan ke sistem WhatsApp Center kami. Privasi pelapor dijamin aman.</p>
                                
                                <div class="mt-4">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-check-circle text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Respon Cepat</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-user-shield text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Data Aman</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <i class="fab fa-whatsapp text-warning me-3 fa-lg"></i>
                                        <span class="fw-bold">Langsung ke Admin</span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-8 form-panel">
                                <h4 class="fw-bold mb-4 text-dark">Formulir Pengaduan</h4>
                                <form id="waForm" onsubmit="kirimKeWA(event)">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="nama" placeholder="Nama Sesuai KTP" required>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label class="form-label">NIK (16 Digit) <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="nik" placeholder="Masukkan NIK" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Nomor WhatsApp <span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="whatsapp" placeholder="0812xxxx" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="form-label">Email <small class="text-muted fw-normal">(Opsional)</small></label>
                                            <input type="email" class="form-control" id="email" placeholder="nama@email.com">
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Alamat Lengkap <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="alamat" rows="2" placeholder="Desa, Kecamatan, Kabupaten..." required></textarea>
                                        </div>

                                        <div class="col-12">
                                            <label class="form-label">Isi Laporan / Perihal <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="perihal" rows="4" placeholder="Tuliskan detail laporan Anda di sini..." required></textarea>
                                        </div>

                                        <div class="col-12 mt-4">
                                            <button type="submit" class="btn btn-wa">
                                                <i class="fab fa-whatsapp fa-lg"></i> KIRIM SEKARANG
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-wave">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
                <path fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>

        <div class="container footer-content">
            <div class="row gy-5">
                <div class="col-lg-5 col-md-12">
                    <div class="d-flex align-items-center gap-3 mb-4">
                        <i class="fas fa-ship fa-3x text-white"></i> <div>
                            <h4 class="text-white mb-0 fw-bold">DINAS PERIKANAN</h4>
                            <small class="text-white-50" style="letter-spacing: 2px;">KABUPATEN SITUBONDO</small>
                        </div>
                    </div>
                    <p class="pe-lg-5" style="line-height: 1.8;">
                        Berkomitmen untuk memajukan sektor perikanan tangkap dan memberdayakan masyarakat pesisir melalui pelayanan yang transparan, akuntabel, dan inovatif.
                    </p>
                    <div class="d-flex gap-2 mt-4">
                        <a href="#" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.dinasperikanansitubondo.com" class="btn btn-outline-light rounded-circle" style="width: 40px; height: 40px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-globe"></i></a>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <h5>Tautan Cepat</h5>
                    <ul class="list-unstyled footer-links mt-3">
                        <li><a href="#"><i class="fas fa-chevron-right fa-xs"></i> Beranda</a></li>
                        <li><a href="#layanan"><i class="fas fa-chevron-right fa-xs"></i> Layanan Kami</a></li>
                        <li><a href="#statistik"><i class="fas fa-chevron-right fa-xs"></i> SIMATA</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/kegiatan/" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Dokumentasi Kegiatan</a></li>
                        <li><a href="https://www.dinasperikanansitubondo.com/peraturankkp" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Peraturan KKP</a></li>
                        <li><a href="https://situbondokab.go.id/" target="_blank"><i class="fas fa-chevron-right fa-xs"></i> Pemkab Situbondo</a></li>
                    </ul>
                </div>

                <div class="col-lg-4 col-md-6">
                    <h5>Kontak Kami</h5>
                    <div class="mt-3">
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                            <div>
                                <span class="d-block text-white fw-bold">Alamat Kantor</span>
                                <small>Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur 68312</small>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-phone-alt"></i></div>
                            <div>
                                <span class="d-block text-white fw-bold">Telepon / WhatsApp</span>
                                <small>0878-6561-4222</small>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-clock"></i></div>
                            <div>
                                <span class="d-block text-white fw-bold">Jam Pelayanan</span>
                                <small>Senin - Jumat: 08.00 - 15.00 WIB</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="copyright">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 text-md-start mb-2 mb-md-0">
                        &copy; 2025 <strong>Dinas Perikanan Situbondo</strong>. All Rights Reserved.
                    </div>
                    <div class="col-md-6 text-md-end">
                        <small class="text-white-50">Bidang Pemberdayaan Nelayan</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Detail Modal untuk Peta Statistik -->
    <div class="detail-modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detail Desa</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Akan diisi oleh JavaScript -->
            </div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="modal fade lightbox-modal" id="lightboxModal" tabindex="-1" aria-labelledby="lightboxModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lightboxModalLabel">Galeri Kegiatan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="lightboxImage" src="" alt="Kegiatan" class="lightbox-image">
                </div>
                <div class="modal-footer">
                    <div class="lightbox-nav">
                        <button type="button" class="lightbox-nav-btn" id="prevBtn">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="nextBtn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="lightbox-counter">
                        <span id="currentIndex">1</span> / <span id="totalImages">9</span>
                    </div>
                    <div class="lightbox-zoom-controls">
                        <button type="button" class="lightbox-nav-btn" id="zoomInBtn">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="zoomOutBtn">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button type="button" class="lightbox-nav-btn" id="resetZoomBtn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS untuk peta -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // ============================================
        // SISTEM PETA STATISTIK NELAYAN
        // ============================================
        
        // Inisialisasi variabel global untuk peta statistik
        let statistikMap;
        let statistikMarkers = [];
        let statistikMarkerLayerGroup;
        let dataDesa = [];
        let autoReloadInterval;
        let updateCount = 0;
        let bantuanChart = null;
        let tahunChart = null;
        let isFullscreen = false;
        
        // Konfigurasi aplikasi
        const APP_CONFIG = {
            autoReload: true,
            reloadInterval: 120000, // 120 detik (2 menit)
            showNotifications: true,
            defaultMapZoom: 10,
            situbondoCenter: [-7.7069, 113.6347],
            maxMarkers: 100
        };
        
        // Fungsi untuk menginisialisasi peta statistik
        function initStatistikMap() {
            // Inisialisasi peta
            statistikMap = L.map('statistikMap').setView(APP_CONFIG.situbondoCenter, APP_CONFIG.defaultMapZoom);
            
            // Tambahkan tile layer (peta dasar)
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18,
                minZoom: 8
            }).addTo(statistikMap);
            
            // Tambahkan layer group untuk marker
            statistikMarkerLayerGroup = L.layerGroup().addTo(statistikMap);
            
            // Tambahkan kontrol skala
            L.control.scale({position: 'bottomleft'}).addTo(statistikMap);
            
            // Setup event listeners
            setupEventListeners();
            
            // Load data pertama kali
            loadData();
            
            // Setup auto-update jika diaktifkan
            if (APP_CONFIG.autoReload) {
                setupAutoUpdate();
            }
        }
        
        // Fungsi untuk setup event listeners peta statistik
        function setupEventListeners() {
            // Tombol update
            document.getElementById('reloadBtn').addEventListener('click', updateData);
            
            // Tombol reset view
            document.getElementById('resetViewBtn').addEventListener('click', resetView);
            
            // Tombol fullscreen
            document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
            
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Hapus class active dari semua tab
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Tambah class active ke tab yang diklik
                    this.classList.add('active');
                    
                    // Tampilkan konten tab yang sesuai
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Pencarian desa
            document.getElementById('searchDesa').addEventListener('input', function(e) {
                filterDesaList(e.target.value);
            });
            
            // Modal close
            document.getElementById('modalClose').addEventListener('click', closeModal);
            
            // Close modal dengan klik di luar
            document.getElementById('detailModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // Close modal dengan ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
            
            // Fullscreen change event
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.addEventListener('mozfullscreenchange', handleFullscreenChange);
            document.addEventListener('MSFullscreenChange', handleFullscreenChange);
        }
        
        // Fungsi untuk setup auto-update
        function setupAutoUpdate() {
            // Update UI untuk menunjukkan auto-update aktif
            document.getElementById('autoReloadStatus').textContent = 'Aktif';
            document.getElementById('footerReloadStatus').textContent = 'Aktif';
            document.getElementById('reloadInterval').textContent = APP_CONFIG.reloadInterval / 1000;
            
            // Setup interval untuk auto-update
            autoReloadInterval = setInterval(() => {
                updateData();
                updateCount++;
                
                // Tampilkan notifikasi setiap 5 update
                if (updateCount % 5 === 0 && APP_CONFIG.showNotifications) {
                    showNotification(`Data telah diperbarui ${updateCount} kali`, 'info');
                }
            }, APP_CONFIG.reloadInterval);
            
            // Tampilkan notifikasi
            if (APP_CONFIG.showNotifications) {
                showNotification('Auto-update diaktifkan. Data akan diperbarui setiap 120 detik.', 'info');
            }
        }
        
        // Fungsi untuk memuat data dari datapeta.js
        function loadData() {
            // Tampilkan loading
            showLoading(true);
            
            // Cek apakah data sudah tersedia di window object
            if (window.DATA_PETA_STATISTIK) {
                processData(window.DATA_PETA_STATISTIK);
                showLoading(false);
                return;
            }
            
            // Jika data belum tersedia, load dari file
            loadDataFile();
        }
        
        // Fungsi untuk load data file dengan timestamp untuk menghindari cache
        function loadDataFile() {
            const timestamp = new Date().getTime();
            const script = document.createElement('script');
            script.src = `datapeta.js?t=${timestamp}`;
            script.onload = function() {
                if (window.DATA_PETA_STATISTIK) {
                    processData(window.DATA_PETA_STATISTIK);
                } else {
                    console.error('Data tidak ditemukan setelah memuat file.');
                    showNotification('Gagal memuat data. Format file mungkin tidak sesuai.', 'error');
                }
                showLoading(false);
            };
            script.onerror = function() {
                console.error('Gagal memuat file datapeta.js');
                showNotification('Gagal memuat file data. Periksa koneksi atau keberadaan file.', 'error');
                showLoading(false);
                
                // Coba lagi setelah 5 detik
                setTimeout(loadDataFile, 5000);
            };
            
            document.head.appendChild(script);
        }
        
        // Fungsi untuk memproses data yang telah dimuat
        function processData(data) {
            dataDesa = data.data || [];
            
            // Update informasi metadata
            document.getElementById('lastUpdate').textContent = data.metadata.lastUpdate;
            document.getElementById('totalDesa').textContent = data.metadata.totalDesa;
            document.getElementById('totalPenerima').textContent = data.metadata.totalPenerima;
            document.getElementById('totalBantuan').textContent = data.summary.totalBantuanBarang;
            document.getElementById('footerUpdate').textContent = data.metadata.lastUpdate;
            
            // Update ringkasan statistik
            document.getElementById('summaryDesa').textContent = data.metadata.totalDesa;
            document.getElementById('summaryPenerima').textContent = data.metadata.totalPenerima;
            document.getElementById('summaryBarang').textContent = data.summary.totalBantuanBarang;
            document.getElementById('summaryUang').textContent = data.summary.totalBantuanUang;
            
            // Tampilkan desa terbanyak penerima
            displayTopDesa(dataDesa);
            
            // Tampilkan daftar desa
            displayDesaList(dataDesa);
            
            // Tampilkan marker di peta
            displayMapMarkers(dataDesa);
            
            // Update charts
            updateCharts(dataDesa);
            
            // Tampilkan notifikasi sukses
            if (APP_CONFIG.showNotifications) {
                showNotification('Data berhasil dimuat', 'success');
            }
        }
        
        // Fungsi untuk menampilkan top 5 desa dengan penerima terbanyak
        function displayTopDesa(desaData) {
            const topDesaList = document.getElementById('topDesaList');
            topDesaList.innerHTML = '';
            
            // Urutkan berdasarkan jumlah penerima (descending) dan ambil 5 teratas
            const sortedDesa = [...desaData]
                .sort((a, b) => b.jumlahPenerima - a.jumlahPenerima)
                .slice(0, 5);
            
            if (sortedDesa.length === 0) {
                topDesaList.innerHTML = '<p style="text-align: center; color: var(--gray-color); padding: 20px;">Data tidak tersedia</p>';
                return;
            }
            
            sortedDesa.forEach((desa, index) => {
                const desaItem = document.createElement('div');
                desaItem.className = 'desa-item';
                if (index === 0) desaItem.classList.add('pulse');
                
                // Tentukan ranking badge
                let rankBadge = '';
                if (index === 0) rankBadge = '<span style="background: gold; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;"><i class="fas fa-crown"></i> 1</span>';
                else if (index === 1) rankBadge = '<span style="background: silver; color: #333; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">2</span>';
                else if (index === 2) rankBadge = '<span style="background: #cd7f32; color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">3</span>';
                else rankBadge = `<span style="background: var(--primary); color: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 8px;">${index + 1}</span>`;
                
                desaItem.innerHTML = `
                    <div>
                        <div class="desa-name">${rankBadge} ${desa.desa}, ${desa.kecamatan}</div>
                        <div class="desa-details">
                            <span><i class="fas fa-users"></i> ${desa.jumlahPenerima} Penerima</span>
                            <span><i class="fas fa-box"></i> ${desa.totalBantuanBarang} Unit</span>
                        </div>
                    </div>
                    <div>
                        <button class="control-btn" style="padding: 8px 12px; font-size: 0.9rem;" data-id="${desa.id}">
                            <i class="fas fa-info-circle"></i> Detail
                        </button>
                    </div>
                `;
                
                // Tambahkan event click untuk zoom ke desa tersebut
                desaItem.addEventListener('click', function(e) {
                    if (!e.target.closest('button')) {
                        zoomToDesa(desa.id);
                    }
                });
                
                // Tambahkan event click untuk button detail
                const detailBtn = desaItem.querySelector('button');
                detailBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    showDesaDetail(desa.id);
                });
                
                topDesaList.appendChild(desaItem);
            });
        }
        
        // Fungsi untuk menampilkan daftar desa
        function displayDesaList(desaData) {
            const desaList = document.getElementById('desaList');
            desaList.innerHTML = '';
            
            // Urutkan berdasarkan jumlah penerima (descending)
            const sortedDesa = [...desaData].sort((a, b) => b.jumlahPenerima - a.jumlahPenerima);
            
            sortedDesa.forEach(desa => {
                const desaItem = document.createElement('div');
                desaItem.className = 'desa-item';
                desaItem.dataset.id = desa.id;
                
                desaItem.innerHTML = `
                    <div>
                        <div class="desa-name">${desa.desa}, ${desa.kecamatan}</div>
                        <div class="desa-details">
                            <span><i class="fas fa-calendar"></i> ${desa.tahunDistribusi.map(t => t.tahun).join(', ')}</span>
                        </div>
                    </div>
                    <div>
                        <span style="background: ${getColorByPenerima(desa.jumlahPenerima)}; color: white; padding: 5px 12px; border-radius: 20px; font-weight: bold;">
                            ${desa.jumlahPenerima}
                        </span>
                    </div>
                `;
                
                // Tambahkan event click
                desaItem.addEventListener('click', function() {
                    zoomToDesa(desa.id);
                });
                
                desaList.appendChild(desaItem);
            });
        }
        
        // Fungsi untuk filter daftar desa berdasarkan pencarian
        function filterDesaList(query) {
            const desaItems = document.querySelectorAll('#desaList .desa-item');
            const lowerQuery = query.toLowerCase();
            
            desaItems.forEach(item => {
                const desaName = item.querySelector('.desa-name').textContent.toLowerCase();
                if (desaName.includes(lowerQuery) || query === '') {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        // Fungsi untuk menampilkan marker di peta
        function displayMapMarkers(desaData) {
            // Hapus marker lama
            statistikMarkerLayerGroup.clearLayers();
            statistikMarkers = [];
            
            // Batasi jumlah marker jika terlalu banyak
            const displayData = desaData.slice(0, APP_CONFIG.maxMarkers);
            
            displayData.forEach(desa => {
                if (!desa.koordinat || !desa.koordinat.lat || !desa.koordinat.lng) {
                    console.warn(`Koordinat tidak valid untuk desa ${desa.desa}`);
                    return;
                }
                
                // Tentukan warna marker berdasarkan jumlah penerima
                const markerColor = getColorByPenerima(desa.jumlahPenerima);
                
                // Buat custom icon untuk marker
                const markerIcon = L.divIcon({
                    html: `<div style="
                        background-color: ${markerColor};
                        width: 24px;
                        height: 24px;
                        border-radius: 50%;
                        border: 3px solid white;
                        box-shadow: 0 0 10px rgba(0,0,0,0.5);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-weight: bold;
                        font-size: 11px;
                        cursor: pointer;
                    ">${desa.jumlahPenerima}</div>`,
                    className: 'custom-marker',
                    iconSize: [28, 28],
                    iconAnchor: [14, 14]
                });
                
                // Buat marker
                const marker = L.marker([desa.koordinat.lat, desa.koordinat.lng], {
                    icon: markerIcon,
                    title: `${desa.desa}, ${desa.kecamatan} - ${desa.jumlahPenerima} penerima`
                });
                
                // Tambahkan popup dengan informasi desa
                const popupContent = createPopupContent(desa);
                marker.bindPopup(popupContent);
                
                // Tambahkan event click untuk highlight
                marker.on('click', function() {
                    highlightDesa(desa.id);
                });
                
                // Tambahkan ke layer group
                marker.addTo(statistikMarkerLayerGroup);
                
                // Simpan reference
                statistikMarkers.push({
                    id: desa.id,
                    marker: marker,
                    desa: desa
                });
            });
            
            // Jika ada data, fit bounds ke semua marker
            if (statistikMarkers.length > 0) {
                const markerBounds = L.latLngBounds(statistikMarkers.map(m => [m.marker.getLatLng().lat, m.marker.getLatLng().lng]));
                statistikMap.fitBounds(markerBounds, { padding: [100, 100], maxZoom: 12 });
            }
        }
        
        // Fungsi untuk membuat konten popup
        function createPopupContent(desa) {
            return `
                <div style="max-width: 300px;">
                    <h3 style="margin: 0 0 10px 0; color: var(--primary);">${desa.desa}, ${desa.kecamatan}</h3>
                    <p><strong><i class="fas fa-users"></i> Jumlah Penerima:</strong> ${desa.jumlahPenerima} orang</p>
                    <p><strong><i class="fas fa-box"></i> Total Bantuan Barang:</strong> ${desa.totalBantuanBarang} unit</p>
                    <p><strong><i class="fas fa-calendar"></i> Tahun Distribusi:</strong> ${desa.tahunDistribusi.map(t => t.tahun).join(', ')}</p>
                    <p><strong><i class="fas fa-users"></i> Kelompok:</strong> ${desa.kelompokDistribusi.map(k => k.kelompok).join(', ')}</p>
                    <hr style="margin: 15px 0;">
                    <div style="text-align: center;">
                        <button onclick="showDesaDetail('${desa.id}')" style="
                            background: var(--accent);
                            color: white;
                            border: none;
                            padding: 8px 15px;
                            border-radius: 5px;
                            cursor: pointer;
                            font-weight: bold;
                            width: 100%;
                        ">
                            <i class="fas fa-info-circle"></i> Lihat Detail Lengkap
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Fungsi untuk mendapatkan warna berdasarkan jumlah penerima
        function getColorByPenerima(jumlah) {
            if (jumlah >= 50) return 'var(--danger-color)';
            if (jumlah >= 20) return 'var(--warning-color)';
            return 'var(--success-color)';
        }
        
        // Fungsi untuk zoom ke desa tertentu
        function zoomToDesa(desaId) {
            const selectedMarker = statistikMarkers.find(m => m.id === desaId);
            if (selectedMarker) {
                statistikMap.setView(selectedMarker.marker.getLatLng(), 13);
                selectedMarker.marker.openPopup();
                highlightDesa(desaId);
            }
        }
        
        // Fungsi untuk highlight desa
        function highlightDesa(desaId) {
            // Reset semua marker
            statistikMarkers.forEach(m => {
                const markerEl = m.marker.getElement();
                if (markerEl) {
                    markerEl.style.transform = 'scale(1)';
                    markerEl.style.zIndex = '1';
                }
            });
            
            // Highlight marker yang dipilih
            const selectedMarker = statistikMarkers.find(m => m.id === desaId);
            if (selectedMarker) {
                const markerEl = selectedMarker.marker.getElement();
                if (markerEl) {
                    markerEl.style.transform = 'scale(1.4)';
                    markerEl.style.zIndex = '1000';
                    markerEl.classList.add('pulse');
                    
                    // Hentikan animasi setelah 2 detik
                    setTimeout(() => {
                        markerEl.classList.remove('pulse');
                    }, 2000);
                }
                
                // Highlight item di daftar desa
                highlightDesaListItem(desaId);
            }
        }
        
        // Fungsi untuk highlight item di daftar desa
        function highlightDesaListItem(desaId) {
            // Hapus class active dari semua item
            const desaItems = document.querySelectorAll('.desa-item');
            desaItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Tambahkan class active ke item yang dipilih
            const selectedItem = document.querySelector(`.desa-item[data-id="${desaId}"]`);
            if (selectedItem) {
                selectedItem.classList.add('active');
                
                // Scroll ke item yang dipilih
                selectedItem.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }
        }
        
        // Fungsi untuk menampilkan detail desa di modal
        function showDesaDetail(desaId) {
            const desaData = dataDesa.find(d => d.id === desaId);
            if (!desaData) return;
            
            document.getElementById('modalTitle').textContent = `${desaData.desa}, ${desaData.kecamatan}`;
            
            // Buat konten modal
            let modalHtml = `
                <div class="detail-grid">
                    <div class="detail-item">
                        <div class="detail-item-title">Jumlah Penerima</div>
                        <div class="detail-item-value">${desaData.jumlahPenerima} orang</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-item-title">Total Bantuan Barang</div>
                        <div class="detail-item-value">${desaData.totalBantuanBarang} unit</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-item-title">Jenis Bantuan</div>
                        <div class="detail-item-value">${desaData.jenisBantuan.map(b => b.jenis).join(', ')}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-item-title">Rata-rata Bantuan</div>
                        <div class="detail-item-value">${desaData.rataBantuan.toFixed(2)} unit/orang</div>
                    </div>
                </div>
                
                <h4 style="margin: 25px 0 15px 0; color: var(--primary);"><i class="fas fa-calendar"></i> Tahun Distribusi</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 25px;">
            `;
            
            desaData.tahunDistribusi.forEach(tahun => {
                modalHtml += `<span style="background: #e8eeff; padding: 8px 15px; border-radius: 20px; color: var(--primary);">${tahun.tahun}</span>`;
            });
            
            modalHtml += `
                </div>
                
                <h4 style="margin: 25px 0 15px 0; color: var(--primary);"><i class="fas fa-users"></i> Kelompok Distribusi</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 25px;">
            `;
            
            desaData.kelompokDistribusi.forEach(kelompok => {
                modalHtml += `<span style="background: #f0f7ff; padding: 8px 15px; border-radius: 20px; color: var(--accent);">${kelompok.kelompok} (${kelompok.jumlah})</span>`;
            });
            
            modalHtml += `
                </div>
                
                <h4 style="margin: 25px 0 15px 0; color: var(--primary);"><i class="fas fa-map-marker-alt"></i> Koordinat</h4>
                <p>Latitude: ${desaData.koordinat.lat}, Longitude: ${desaData.koordinat.lng}</p>
                
                <div style="margin-top: 30px; text-align: center;">
                    <button onclick="zoomToDesa('${desaId}'); closeModal();" style="
                        background: var(--accent);
                        color: white;
                        border: none;
                        padding: 12px 25px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: bold;
                        margin-right: 10px;
                    ">
                        <i class="fas fa-map-marker-alt"></i> Zoom ke Lokasi
                    </button>
                    <button onclick="closeModal()" style="
                        background: #f0f0f0;
                        color: var(--gray-color);
                        border: none;
                        padding: 12px 25px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: bold;
                    ">
                        <i class="fas fa-times"></i> Tutup
                    </button>
                </div>
            `;
            
            document.getElementById('modalBody').innerHTML = modalHtml;
            document.getElementById('detailModal').classList.add('active');
        }
        
        // Fungsi untuk menutup modal
        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }
        
        // Fungsi untuk update data
        function updateData() {
            // Tampilkan loading
            showLoading(true);
            
            // Hapus script lama jika ada
            const oldScripts = document.querySelectorAll('script[src^="datapeta.js"]');
            oldScripts.forEach(script => script.remove());
            
            // Load data baru
            loadDataFile();
            
            // Tampilkan notifikasi
            if (APP_CONFIG.showNotifications) {
                showNotification('Memperbarui data terbaru...', 'info');
            }
        }
        
        // Fungsi untuk reset view peta
        function resetView() {
            statistikMap.setView(APP_CONFIG.situbondoCenter, APP_CONFIG.defaultMapZoom);
            
            // Reset highlight
            const desaItems = document.querySelectorAll('.desa-item');
            desaItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Reset marker
            statistikMarkers.forEach(m => {
                const markerEl = m.marker.getElement();
                if (markerEl) {
                    markerEl.style.transform = 'scale(1)';
                    markerEl.style.zIndex = '1';
                }
                m.marker.closePopup();
            });
        }
        
        // Fungsi untuk toggle fullscreen
        function toggleFullscreen() {
            const container = document.querySelector('.peta-statistik-container');
            
            if (!isFullscreen) {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.mozRequestFullScreen) {
                    container.mozRequestFullScreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
        
        // Fungsi untuk handle fullscreen change
        function handleFullscreenChange() {
            isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || 
                            document.mozFullScreenElement || document.msFullscreenElement);
            
            // Update tombol
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            if (isFullscreen) {
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i> Keluar Layar Penuh';
                showNotification('Mode layar penuh diaktifkan', 'info');
            } else {
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i> Layar Penuh';
            }
        }
        
        // Fungsi untuk update charts
        function updateCharts(desaData) {
            // Data untuk chart distribusi bantuan
            const bantuanLabels = ['Tinggi (50)', 'Sedang (20-49)', 'Rendah (19)'];
            const bantuanCounts = [0, 0, 0];
            
            desaData.forEach(desa => {
                if (desa.jumlahPenerima >= 50) bantuanCounts[0]++;
                else if (desa.jumlahPenerima >= 20) bantuanCounts[1]++;
                else bantuanCounts[2]++;
            });
            
            // Data untuk chart tahun distribusi
            const tahunMap = {};
            desaData.forEach(desa => {
                desa.tahunDistribusi.forEach(t => {
                    if (tahunMap[t.tahun]) {
                        tahunMap[t.tahun] += t.jumlah;
                    } else {
                        tahunMap[t.tahun] = t.jumlah;
                    }
                });
            });
            
            const tahunLabels = Object.keys(tahunMap).sort();
            const tahunData = tahunLabels.map(tahun => tahunMap[tahun]);
            
            // Hancurkan chart lama jika ada
            if (bantuanChart) bantuanChart.destroy();
            if (tahunChart) tahunChart.destroy();
            
            // Buat chart distribusi bantuan
            const bantuanCtx = document.getElementById('bantuanChart').getContext('2d');
            bantuanChart = new Chart(bantuanCtx, {
                type: 'doughnut',
                data: {
                    labels: bantuanLabels,
                    datasets: [{
                        data: bantuanCounts,
                        backgroundColor: [
                            'var(--danger-color)',
                            'var(--warning-color)',
                            'var(--success-color)'
                        ],
                        borderWidth: 2,
                        borderColor: 'white'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Buat chart tahun distribusi
            const tahunCtx = document.getElementById('tahunChart').getContext('2d');
            tahunChart = new Chart(tahunCtx, {
                type: 'bar',
                data: {
                    labels: tahunLabels,
                    datasets: [{
                        label: 'Jumlah Penerima per Tahun',
                        data: tahunData,
                        backgroundColor: 'var(--accent)',
                        borderColor: 'var(--primary)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 10
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // Fungsi untuk menampilkan loading
        function showLoading(show) {
            const loadingScreen = document.getElementById('loadingScreen');
            if (show) {
                loadingScreen.classList.remove('hidden');
            } else {
                // Tambahkan delay kecil untuk animasi yang lebih halus
                setTimeout(() => {
                    loadingScreen.classList.add('hidden');
                }, 500);
            }
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type = 'info') {
            if (!APP_CONFIG.showNotifications) return;
            
            // Buat elemen notifikasi
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            // Icon berdasarkan type
            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            else if (type === 'error') icon = 'exclamation-circle';
            
            notification.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Hapus notifikasi setelah 4 detik
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.3s ease-out reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }
        
        // ============================================
        // SISTEM WEBSITE UTAMA (FUNGSI LAINNYA)
        // ============================================
        
        // Init Animation
        AOS.init({
            once: true,
            offset: 100,
            duration: 800,
        });

        // Script Kirim ke WhatsApp
        function kirimKeWA(e) {
            e.preventDefault();

            let nama = document.getElementById('nama').value;
            let nik = document.getElementById('nik').value;
            let wa = document.getElementById('whatsapp').value;
            let email = document.getElementById('email').value || '-';
            let alamat = document.getElementById('alamat').value;
            let perihal = document.getElementById('perihal').value;

            let targetNumber = "6287865614222"; 

            let pesan = `*LAPORAN PENGADUAN NELAYAN*%0A` +
                        `--------------------------------%0A` +
                        `*Nama:* ${nama}%0A` +
                        `*NIK:* ${nik}%0A` +
                        `*Alamat:* ${alamat}%0A` +
                        `*No. WA:* ${wa}%0A` +
                        `*Email:* ${email}%0A` +
                        `--------------------------------%0A` +
                        `*Perihal / Isi Laporan:*%0A` +
                        `${perihal}`;

            let url = `https://api.whatsapp.com/send?phone=${targetNumber}&text=${pesan}`;
            window.open(url, '_blank');
        }

        // Efek Navbar saat scroll
        window.addEventListener('scroll', function() {
            const nav = document.getElementById('mainNav');
            if (window.scrollY > 50) {
                nav.style.boxShadow = "0 10px 30px rgba(0,0,0,0.1)";
                nav.style.background = "rgba(255, 255, 255, 0.98)";
            } else {
                nav.style.boxShadow = "0 4px 20px rgba(0,0,0,0.05)";
                nav.style.background = "rgba(255, 255, 255, 0.95)";
            }
        });

        // Lightbox functionality
        const photoUrls = [
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto1.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto2.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto3.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto4.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto5.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto6.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto7.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto8.jpeg',
            'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/foto9.jpeg'
        ];

        let currentIndex = 0;
        let zoomLevel = 1;
        const maxZoom = 3;
        const minZoom = 1;
        const zoomStep = 0.2;

        function openLightbox(index) {
            currentIndex = index;
            updateLightbox();
            const lightboxModal = new bootstrap.Modal(document.getElementById('lightboxModal'));
            lightboxModal.show();
        }

        function updateLightbox() {
            const lightboxImage = document.getElementById('lightboxImage');
            const currentIndexElement = document.getElementById('currentIndex');
            const totalImagesElement = document.getElementById('totalImages');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            zoomLevel = 1;
            lightboxImage.style.transform = `scale(${zoomLevel})`;
            
            lightboxImage.src = photoUrls[currentIndex];
            lightboxImage.alt = `Kegiatan ${currentIndex + 1}`;
            
            currentIndexElement.textContent = currentIndex + 1;
            totalImagesElement.textContent = photoUrls.length;
            
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === photoUrls.length - 1;
            
            document.getElementById('lightboxModalLabel').textContent = `Galeri Kegiatan - Foto ${currentIndex + 1}`;
        }

        function navigateLightbox(direction) {
            if (direction === 'prev' && currentIndex > 0) {
                currentIndex--;
            } else if (direction === 'next' && currentIndex < photoUrls.length - 1) {
                currentIndex++;
            }
            updateLightbox();
        }

        function zoomImage(action) {
            const lightboxImage = document.getElementById('lightboxImage');
            
            if (action === 'in' && zoomLevel < maxZoom) {
                zoomLevel += zoomStep;
            } else if (action === 'out' && zoomLevel > minZoom) {
                zoomLevel -= zoomStep;
            } else if (action === 'reset') {
                zoomLevel = 1;
            }
            
            zoomLevel = Math.max(minZoom, Math.min(maxZoom, zoomLevel));
            lightboxImage.style.transform = `scale(${zoomLevel})`;
            lightboxImage.style.transition = 'transform 0.3s ease';
        }

        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi peta statistik
            initStatistikMap();
            
            // Navigation buttons untuk lightbox
            document.getElementById('prevBtn').addEventListener('click', () => navigateLightbox('prev'));
            document.getElementById('nextBtn').addEventListener('click', () => navigateLightbox('next'));
            
            // Zoom buttons untuk lightbox
            document.getElementById('zoomInBtn').addEventListener('click', () => zoomImage('in'));
            document.getElementById('zoomOutBtn').addEventListener('click', () => zoomImage('out'));
            document.getElementById('resetZoomBtn').addEventListener('click', () => zoomImage('reset'));
            
            // Keyboard navigation untuk lightbox
            document.addEventListener('keydown', function(e) {
                const lightboxModal = document.getElementById('lightboxModal');
                if (lightboxModal.classList.contains('show')) {
                    if (e.key === 'ArrowLeft') {
                        navigateLightbox('prev');
                    } else if (e.key === 'ArrowRight') {
                        navigateLightbox('next');
                    } else if (e.key === 'Escape') {
                        const modal = bootstrap.Modal.getInstance(lightboxModal);
                        if (modal) modal.hide();
                    } else if (e.key === '+' || e.key === '=') {
                        zoomImage('in');
                        e.preventDefault();
                    } else if (e.key === '-' || e.key === '_') {
                        zoomImage('out');
                        e.preventDefault();
                    } else if (e.key === '0') {
                        zoomImage('reset');
                    }
                }
            });
            
            // Tampilkan pesan selamat datang untuk peta statistik
            setTimeout(() => {
                showNotification('Peta Statistik Nelayan Kab. Situbondo dimuat', 'success');
                showNotification('Auto-update aktif. Data akan diperbarui setiap 120 detik.', 'info');
            }, 1500);
        });
        
        // Ekspos fungsi ke global scope untuk digunakan di popup
        window.showDesaDetail = showDesaDetail;
        window.zoomToDesa = zoomToDesa;
        window.closeModal = closeModal;
        window.openLightbox = openLightbox;
    </script>
</body>
</html>
