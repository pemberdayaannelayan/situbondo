<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    
    <title>Karya Bakti Bersih Pantai Desa Kilensari – Dinas Peternakan & Perikanan Situbondo</title>
    
    <meta name="description" content="Dinas Peternakan dan Perikanan Kabupaten Situbondo bersama Kodim 0823 dan seluruh OPD melaksanakan karya bakti pembersihan kawasan Dermaga Lama Panarukan, Kamis 12 Februari 2026. Wujud sinergi TNI-Pemda dalam Gerakan ASRI.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Karya Bakti Bersih Pantai Desa Kilensari – Dinas Peternakan & Perikanan Situbondo">
    <meta property="og:description" content="20 personel Dinas Peternakan & Perikanan bersama Kodim 0823 dan seluruh OPD Kab. Situbondo gotong royong bersihkan kawasan Dermaga Lama Panarukan.">
    <meta property="og:image" content="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-kabid-dan-staff-selesai-kegiatan.jpeg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://www.dinasperikanansitubondo.com/kerja-bakti-kilensari">
    <meta property="og:type" content="article">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Karya Bakti Bersih Pantai Desa Kilensari">
    <meta name="twitter:description" content="Dinas Peternakan & Perikanan Situbondo turut serta dalam Karya Bakti Kodim 0823 di Dermaga Lama Panarukan.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-kabid-dan-staff-selesai-kegiatan.jpeg">
    
    <!-- CSS & Fonts -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- jsPDF, html2canvas, qrcode-generator -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --secondary-blue: #2563eb;
            --orange-primary: #f97316;
            --orange-dark: #ea580c;
            --orange-light: #ffedd5;
            --text-dark: #1f2937;
            --text-gray: #4b5563;
            --light-gray: #f9fafb;
            --white: #ffffff;
        }
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-gray);
            line-height: 1.7;
            background-color: var(--light-gray);
            padding-top: 90px;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
            font-weight: 600;
        }
        /* ===== NAVBAR ===== */
        .navbar {
            background: rgba(255,255,255,0.98);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            padding: 0.5rem 0;
            transition: all 0.3s;
        }
        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .brand-logo { height: 55px; width: auto; }
        .naik-kelas-logo { height: 50px; width: auto; }
        .brand-text {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
            border-right: 2px solid rgba(249,115,22,0.3);
            padding-right: 15px;
            margin-right: 5px;
        }
        .brand-line-1, .brand-line-2 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 700;
            color: #f97316;
            letter-spacing: 0.5px;
        }
        .brand-line-2 { font-size: 1.1rem; }
        .brand-line-3 {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--primary-blue);
            letter-spacing: 0.8px;
            margin-top: 2px;
        }
        .nav-link {
            color: var(--text-dark) !important;
            font-weight: 500;
            padding: 0.5rem 1rem !important;
            margin: 0 0.2rem;
            border-radius: 8px;
            transition: 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: var(--orange-primary) !important;
            background-color: rgba(249,115,22,0.08);
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--orange-primary), #f59e0b);
            border: none;
            transition: 0.3s;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #ea580c, #d97706);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(249,115,22,0.25);
        }
        .btn-orange {
            background: linear-gradient(135deg, var(--orange-primary), #f59e0b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
        }
        .btn-orange:hover {
            background: linear-gradient(135deg, #ea580c, #d97706);
            color: white;
        }
        /* ===== HERO SECTION ===== */
        .hero-section {
            background: linear-gradient(135deg, rgba(30,58,138,0.92), rgba(249,115,22,0.85)),
                        url('https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-saat-upel-sebelum-kegiatan-dipimpin-kodim.jpeg');
            background-size: cover;
            background-position: center 30%;
            color: white;
            padding: 90px 0 70px;
            position: relative;
            margin-top: -90px;
        }
        .hero-section h1 {
            color: white;
            font-size: 2.6rem;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .badge-category {
            background: rgba(249,115,22,0.3);
            color: white;
            padding: 8px 26px;
            border-radius: 50px;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255,255,255,0.4);
            backdrop-filter: blur(5px);
        }
        .info-card {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            padding: 1.8rem 1rem;
            border: 1px solid rgba(255,255,255,0.25);
            transition: 0.3s;
            height: 100%;
        }
        .info-card:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-5px);
        }
        .info-icon {
            width: 64px;
            height: 64px;
            background: rgba(249,115,22,0.4);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.2rem;
            color: white;
            font-size: 2rem;
        }
        /* ===== CONTENT BOX ===== */
        .section-title {
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
            color: var(--primary-blue);
            font-weight: 700;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--orange-primary), #fbbf24);
            border-radius: 4px;
        }
        .content-box {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.04);
            margin-bottom: 30px;
            border: 1px solid #edf2f7;
            transition: 0.3s;
        }
        .content-box:hover {
            box-shadow: 0 15px 40px rgba(249,115,22,0.08);
            transform: translateY(-3px);
        }
        .highlight-box {
            background: linear-gradient(145deg, #fff7ed, #ffedd5);
            border-left: 6px solid var(--orange-primary);
            padding: 28px;
            border-radius: 16px;
            margin: 30px 0;
        }
        /* ===== SPEAKER CARDS ===== */
        .speakers-section { padding: 80px 0; background: #f8fafc; }
        .speaker-card {
            background: white;
            border-radius: 28px;
            padding: 35px 20px;
            text-align: center;
            box-shadow: 0 12px 35px rgba(0,0,0,0.05);
            height: 100%;
            transition: 0.4s;
            border: 1px solid #e9eef2;
        }
        .speaker-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 25px 50px rgba(249,115,22,0.15);
        }
        .speaker-image {
            width: 170px;
            height: 170px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 20px;
            border: 5px solid var(--orange-light);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .speaker-name {
            color: var(--primary-blue);
            font-size: 1.4rem;
            margin-bottom: 8px;
        }
        .speaker-role {
            color: var(--orange-primary);
            background: rgba(249,115,22,0.1);
            padding: 6px 20px;
            border-radius: 50px;
            display: inline-block;
            font-weight: 600;
            font-size: 0.9rem;
        }
        /* ===== GALLERY ===== */
        .gallery-item {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            height: 260px;
            margin-bottom: 25px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            transition: 0.4s;
        }
        .gallery-item:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 35px rgba(249,115,22,0.25);
        }
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: 0.6s;
        }
        .gallery-item:hover img { transform: scale(1.1); }
        /* ===== FOOTER ===== */
        .footer {
            background: var(--primary-blue);
            color: white;
            padding: 70px 0 30px;
            margin-top: 80px;
        }
        .footer h5 {
            color: white;
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
            font-size: 1.2rem;
            font-weight: 600;
        }
        .footer h5::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 45px;
            height: 3px;
            background: var(--orange-primary);
            border-radius: 3px;
        }
        .footer-links a {
            color: #d1d5db;
            text-decoration: none;
            display: block;
            margin-bottom: 12px;
            transition: 0.3s;
            font-size: 0.95rem;
        }
        .footer-links a:hover {
            color: white;
            padding-left: 8px;
        }
        .social-icons a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 42px;
            height: 42px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            color: white;
            margin-right: 12px;
            transition: 0.3s;
        }
        .social-icons a:hover {
            background: var(--orange-primary);
            transform: translateY(-3px);
        }
        /* ===== MODAL ===== */
        .pdf-auth-modal, .pdf-data-form-modal, .pdf-preview-modal, .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            z-index: 999999;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        .pdf-auth-content, .pdf-data-form-content, .pdf-preview-content, .share-modal-content {
            background: white;
            border-radius: 24px;
            padding: 35px;
            max-width: 550px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }
        .pdf-preview-content { max-width: 800px; }
        .pdf-preview {
            background: white;
            padding: 25px;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            font-family: 'Times New Roman', Times, serif;
            line-height: 1.5;
        }
        @media (max-width: 992px) {
            body { padding-top: 80px; }
            .hero-section h1 { font-size: 2.2rem; }
        }
        @media (max-width: 768px) {
            .hero-section h1 { font-size: 1.8rem; }
            .content-box { padding: 25px; }
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes shake { 0%,100%{transform:translateX(0)} 10%,30%,50%,70%,90%{transform:translateX(-5px)} 20%,40%,60%,80%{transform:translateX(5px)} }
    </style>
</head>
<body>

    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:999999; justify-content:center; align-items:center;">
        <div style="width:50px; height:50px; border:5px solid #f3f3f3; border-top:5px solid var(--orange-primary); border-radius:50%; animation:spin 1s linear infinite;"></div>
    </div>

    <!-- SHARE MODAL -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <h3 class="section-title">Bagikan Kegiatan Ini</h3>
            <p class="text-muted mb-4">Sebarkan informasi kegiatan karya bakti kepada masyarakat.</p>
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button class="btn btn-success d-flex align-items-center justify-content-center gap-2 py-3" onclick="shareToWhatsApp()" style="border-radius: 14px;">
                    <i class="fab fa-whatsapp fa-lg"></i> WhatsApp
                </button>
                <button class="btn btn-primary d-flex align-items-center justify-content-center gap-2 py-3" onclick="copyLink()" style="background: #2563eb; border-radius: 14px;">
                    <i class="fas fa-copy fa-lg"></i> Salin Tautan
                </button>
            </div>
            <button class="btn btn-secondary w-100 mt-4 py-2" onclick="closeShareModal()">Tutup</button>
        </div>
    </div>

    <!-- PDF AUTH MODAL -->
    <div class="pdf-auth-modal" id="pdfAuthModal">
        <div class="pdf-auth-content">
            <div style="width:80px; height:80px; background:var(--orange-light); border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:var(--orange-primary); font-size:2rem;">
                <i class="fas fa-lock"></i>
            </div>
            <h3 class="section-title text-center">Akses Dokumen Resmi</h3>
            <div class="alert alert-warning d-flex align-items-center">
                <i class="fas fa-exclamation-triangle me-2"></i> Anda akan mengakses laporan resmi kegiatan.
            </div>
            <div class="bg-light p-3 rounded-3 mb-4" style="border-left:4px solid var(--orange-primary);">
                <i class="fas fa-info-circle me-2 text-orange"></i> <strong>Kode keamanan:</strong> Hubungi petugas Dinas Peternakan & Perikanan.
            </div>
            <div class="mb-4">
                <label for="securityCodeInput" class="form-label fw-bold">Masukkan Kode (8 digit angka)</label>
                <div style="position:relative;">
                    <input type="password" class="form-control form-control-lg" id="securityCodeInput" placeholder="Contoh: 12022026" maxlength="8" onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                    <button type="button" class="password-toggle" id="passwordToggle" style="position:absolute; right:15px; top:50%; transform:translateY(-50%); background:none; border:none; color:#6b7280;">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="error-message text-danger mt-2" id="errorMessage" style="display:none;">
                    <i class="fas fa-times-circle me-1"></i><span id="errorText">Kode salah.</span>
                </div>
            </div>
            <div class="attempts-counter mb-3 text-muted"><i class="fas fa-shield-alt me-2"></i>Percobaan tersisa: <span id="attemptsLeft">3</span></div>
            <div class="d-flex justify-content-between gap-3">
                <button class="btn btn-secondary w-50" onclick="closePdfAuthModal()">Batal</button>
                <button class="btn btn-orange w-50" onclick="verifySecurityCode()">Verifikasi</button>
            </div>
        </div>
    </div>

    <!-- FORM DATA PELAPOR -->
    <div class="pdf-data-form-modal" id="pdfDataFormModal">
        <div class="pdf-data-form-content">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="section-title mb-0">Data Pelapor</h3>
                <button class="btn-close" onclick="closePdfDataFormModal()"></button>
            </div>
            <p class="text-muted mb-4">Isi dengan benar. Nama dan NIP akan tercetak otomatis di laporan PDF.</p>
            <form id="pdfDataForm" onsubmit="event.preventDefault(); submitPdfDataForm();">
                <div class="mb-3">
                    <label for="namaPelapor" class="form-label fw-bold">Nama Lengkap <span class="text-danger">*</span></label>
                    <input type="text" class="form-control form-control-lg" id="namaPelapor" placeholder="Contoh: SUGENG PURWO PRIYANTO, S.E., M.M.">
                    <div class="invalid-feedback">Nama harus diisi.</div>
                </div>
                <div class="mb-3">
                    <label for="nipPelapor" class="form-label fw-bold">NIP <span class="text-danger">* (18 digit)</span></label>
                    <input type="text" class="form-control form-control-lg" id="nipPelapor" placeholder="197501012006041002" maxlength="18" pattern="\d{18}" inputmode="numeric" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                    <div class="invalid-feedback">NIP harus 18 digit angka.</div>
                </div>
                <div class="mb-4">
                    <label class="form-label fw-bold">Verifikasi Keamanan</label>
                    <div class="captcha-box mb-2" id="captchaQuestion" style="background:#f1f5f9; padding:12px; border-radius:12px; font-size:1.3rem; font-weight:700; color:var(--primary-blue); text-align:center;">2 + 3 = ?</div>
                    <input type="text" class="form-control" id="captchaInput" placeholder="Hasil penjumlahan">
                    <div id="captchaError" class="text-danger small mt-2" style="display: none;">Captcha salah, coba lagi.</div>
                </div>
                <div class="mb-4">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="agreementCheck">
                        <label class="form-check-label" for="agreementCheck" style="font-size:0.9rem;">
                            Saya menyatakan bahwa data yang saya masukkan adalah benar dan bertanggung jawab penuh atas penggunaan dokumen ini sesuai peraturan perundang-undangan. <span class="text-danger">(wajib)</span>
                        </label>
                    </div>
                </div>
                <div class="d-flex justify-content-between gap-3">
                    <button type="button" class="btn btn-secondary w-50" onclick="closePdfDataFormModal()">Batal</button>
                    <button type="submit" class="btn btn-orange w-50">Buat Laporan PDF</button>
                </div>
            </form>
        </div>
    </div>

    <!-- PREVIEW PDF MODAL -->
    <div class="pdf-preview-modal" id="pdfPreviewModal">
        <div class="pdf-preview-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="section-title mb-0">Pratinjau Laporan</h3>
                <button class="btn-close" onclick="closePdfPreview()"></button>
            </div>
            <div class="pdf-preview" id="pdfPreviewContent" style="background:white; padding:25px; border-radius:16px;"></div>
            <div class="d-flex justify-content-between mt-4 gap-3">
                <button class="btn btn-secondary w-50" onclick="closePdfPreview()">Tutup</button>
                <button class="btn btn-orange w-50" onclick="downloadPDF()">Download PDF</button>
            </div>
        </div>
    </div>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-3" href="#">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Pemkab Situbondo" class="brand-logo">
                <div class="brand-text d-flex flex-column">
                    <h5 class="brand-line-1">DINAS PETERNAKAN</h5>
                    <h5 class="brand-line-2">DAN PERIKANAN</h5>
                    <span class="brand-line-3">KABUPATEN SITUBONDO</span>
                </div>
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/naikkelas.png" alt="Situbondo Naik Kelas" class="naik-kelas-logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="fas fa-bars" style="color:var(--orange-primary);"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item"><a class="nav-link" href="https://www.dinasperikanansitubondo.com">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://www.dinasperikanansitubondo.com/kegiatan">Kegiatan</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Karya Bakti</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://www.dinasperikanansitubondo.com/simpadan">SIMPADAN</a></li>
                    <li class="nav-item ms-2">
                        <a href="https://www.dinasperikanansitubondo.com#aduan" class="btn btn-primary" style="padding: 10px 24px; border-radius: 12px;">
                            <i class="fas fa-phone-alt me-2"></i>Kontak
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="hero-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto text-center">
                    <span class="badge-category mb-4"><i class="fas fa-broom"></i> KARYA BAKTI – GERAKAN ASRI</span>
                    <h1 data-aos="fade-up" class="mb-4">Kerja Bakti Bersih Pantai Desa Kilensari, Kecamatan Panarukan</h1>
                    <p class="lead mb-5" data-aos="fade-up" data-aos-delay="100" style="color:rgba(255,255,255,0.95); font-size:1.2rem;">
                        Dinas Peternakan dan Perikanan Kabupaten Situbondo bersama Kodim 0823 serta seluruh OPD 
                        melaksanakan karya bakti pembersihan kawasan Dermaga Lama Panarukan. Kegiatan ini merupakan 
                        wujud nyata sinergi TNI-Pemerintah Daerah dalam mewujudkan lingkungan pesisir yang bersih, sehat, dan indah.
                    </p>
                    <div class="row g-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon"><i class="fas fa-calendar-alt"></i></div>
                                <h5 class="text-white mb-2">Tanggal</h5>
                                <p class="text-white mb-0 fw-semibold">12 Februari 2026</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon"><i class="fas fa-map-marker-alt"></i></div>
                                <h5 class="text-white mb-2">Lokasi</h5>
                                <p class="text-white mb-0 fw-semibold">Dermaga Lama Panarukan</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon"><i class="fas fa-users"></i></div>
                                <h5 class="text-white mb-2">Keterlibatan</h5>
                                <p class="text-white mb-0 fw-semibold">17 OPD + TNI-Polri</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- MAIN CONTENT -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="content-box" data-aos="fade-up">
                        <h2 class="section-title">Sinergi TNI dan Pemerintah Daerah dalam Gerakan ASRI</h2>
                        <p class="lead" style="color: var(--primary-blue); font-weight: 500;">Situbondo, 12 Februari 2026 – Bertempat di kawasan Dermaga Lama Panarukan, Desa Kilensari, Kecamatan Panarukan, telah dilaksanakan Karya Bakti dalam rangka Gerakan ASRI (Aman, Sehat, Resik, Indah).</p>
                        <p>Kegiatan ini merupakan tindak lanjut Instruksi Presiden RI pada Rakornas Pusat dan Daerah serta Surat Telegram Danrem 083/Bdj Nomor ST/108/2026. Secara spesifik, dasar pelaksanaan kegiatan adalah Surat Komando Distrik Militer 0823 Nomor <strong>B/99/II/2026</strong> tanggal 11 Februari 2026 perihal Permohonan Bantuan Personel.</p>
                        <div class="highlight-box">
                            <h5><i class="fas fa-envelope-open-text" style="color:var(--orange-primary);"></i> Surat Perintah Kodim 0823</h5>
                            <p class="mb-0">Nomor: B/99/II/2026, 11 Februari 2026 – Permohonan bantuan personel dari seluruh OPD Kabupaten Situbondo untuk mendukung karya bakti pembersihan pantai.</p>
                        </div>
                        <p>Dinas Peternakan dan Perikanan Kabupaten Situbondo turut berpartisipasi dengan mengerahkan <strong>20 personel</strong> yang dipimpin langsung oleh <strong>Kepala Bidang Pemberdayaan Nelayan, Bapak SUGENG PURWO PRIYANTO, S.E., M.M.</strong> beserta staf. Fokus kegiatan meliputi pembersihan area pendaratan ikan, pemotongan rumput liar, dan edukasi singkat kepada nelayan sekitar mengenai pentingnya menjaga kebersihan lingkungan.</p>
                    </div>
                    <div class="content-box" data-aos="fade-up" data-aos-delay="100">
                        <h2 class="section-title">Kolaborasi Pentahelix: TNI, Pemda, dan Masyarakat</h2>
                        <p>Gerakan ASRI di Dermaga Lama Panarukan menjadi simbol nyata kolaborasi antar institusi. Berdasarkan surat Kodim 0823, total personel yang dikerahkan dari masing-masing OPD adalah 20 orang, dengan rincian khusus:</p>
                        <ul style="font-size: 1rem; line-height: 1.8; margin-bottom: 20px;">
                            <li><strong>Dinas Lingkungan Hidup (DLH):</strong> 50 personel + 5 unit truk sampah</li>
                            <li><strong>Dinas Kesehatan:</strong> 20 personel + tim medis + 2 unit ambulans</li>
                            <li><strong>Dinas Perhubungan:</strong> 10 personel + 5 personel bantu lalu lintas</li>
                            <li><strong>Dinas Peternakan & Perikanan:</strong> 20 personel + peralatan kebersihan</li>
                            <li><strong>OPD lainnya:</strong> masing-masing 20 personel</li>
                        </ul>
                        <div class="highlight-box">
                            <h5><i class="fas fa-clipboard-list" style="color:var(--orange-primary);"></i> Kontribusi Strategis Dinas Peternakan & Perikanan</h5>
                            <ul class="mb-0">
                                <li>Pembersihan area pendaratan ikan dan sekitar dermaga</li>
                                <li>Edukasi tentang pengelolaan sampah plastik kepada nelayan</li>
                                <li>Pendataan potensi kerusakan fasilitas perikanan</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="content-box" data-aos="fade-left">
                        <h2 class="section-title">Pejabat & Perwakilan</h2>
                        <div class="d-flex align-items-center mb-4 p-3 rounded-3" style="background:#fff7ed;">
                            <div style="width:60px; height:60px; background:var(--orange-primary); border-radius:16px; display:flex; align-items:center; justify-content:center; color:white; font-size:1.8rem; margin-right:15px;">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <div>
                                <h5 class="mb-1" style="color:var(--primary-blue);">SUGENG PURWO PRIYANTO, S.E., M.M.</h5>
                                <p class="text-muted mb-0">Kepala Bidang Pemberdayaan Nelayan</p>
                            </div>
                        </div>
                        <div class="d-flex align-items-center p-3 rounded-3" style="background:#eff6ff;">
                            <div style="width:60px; height:60px; background:var(--secondary-blue); border-radius:16px; display:flex; align-items:center; justify-content:center; color:white; font-size:1.8rem; margin-right:15px;">
                                <i class="fas fa-shield"></i>
                            </div>
                            <div>
                                <h5 class="mb-1" style="color:var(--primary-blue);">Kepala Staf Kodim 0823</h5>
                                <p class="text-muted mb-0">Penanggung Jawab Kegiatan</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- MODULES SECTION -->
    <section style="padding: 60px 0; background: #f8fafc;">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Dimensi Kegiatan Karya Bakti</h2>
                    <p class="text-muted mt-3">Nilai strategis di balik gotong royong bersih pantai</p>
                </div>
            </div>
            <div class="row g-4">
                <div class="col-lg-3 col-md-6" data-aos="fade-up">
                    <div class="p-4 bg-white rounded-4 shadow-sm text-center h-100">
                        <div style="width:70px; height:70px; background:#ffedd5; border-radius:18px; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:var(--orange-primary); font-size:2rem;"><i class="fas fa-leaf"></i></div>
                        <h4>Lingkungan</h4>
                        <p class="text-muted">Pembersihan ekosistem pesisir, pengurangan sampah plastik.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="p-4 bg-white rounded-4 shadow-sm text-center h-100">
                        <div style="width:70px; height:70px; background:#ffedd5; border-radius:18px; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:var(--orange-primary); font-size:2rem;"><i class="fas fa-hand-holding-heart"></i></div>
                        <h4>Sosial</h4>
                        <p class="text-muted">Memperkuat hubungan sipil-militer, kebersamaan ASN.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="p-4 bg-white rounded-4 shadow-sm text-center h-100">
                        <div style="width:70px; height:70px; background:#ffedd5; border-radius:18px; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:var(--orange-primary); font-size:2rem;"><i class="fas fa-gavel"></i></div>
                        <h4>Legal</h4>
                        <p class="text-muted">Pelaksanaan instruksi Presiden dan surat perintah Kodim 0823.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                    <div class="p-4 bg-white rounded-4 shadow-sm text-center h-100">
                        <div style="width:70px; height:70px; background:#ffedd5; border-radius:18px; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:var(--orange-primary); font-size:2rem;"><i class="fas fa-fish"></i></div>
                        <h4>Ekonomi</h4>
                        <p class="text-muted">Dukungan terhadap sektor kelautan dan perikanan.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SPEAKERS SECTION -->
    <section class="speakers-section">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Pemimpin dan Penggerak Kegiatan</h2>
                    <p class="text-muted mt-3">Tokoh kunci di balik suksesnya karya bakti</p>
                </div>
            </div>
            <div class="row g-4">
                <div class="col-lg-4 col-md-6" data-aos="fade-up">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-kabid-dan-staff-sebelum-kegiatan.jpeg" alt="Kabid Pemberdayaan Nelayan" style="width:100%; height:100%; object-fit:cover;" onerror="this.src='https://ui-avatars.com/api/?name=SUGENG+PRIYANTO&background=1e3a8a&color=fff&size=400';">
                        </div>
                        <h3 class="speaker-name">SUGENG PURWO PRIYANTO, S.E., M.M.</h3>
                        <p class="speaker-role">Kepala Bidang Pemberdayaan Nelayan</p>
                        <p class="text-muted">Memimpin 20 personel Dinas Peternakan & Perikanan.</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-saat-arahan-komandan-kodim.jpeg" alt="Kodim 0823" style="width:100%; height:100%; object-fit:cover;" onerror="this.src='https://ui-avatars.com/api/?name=Kodim+0823&background=3b82f6&color=fff&size=400';">
                        </div>
                        <h3 class="speaker-name">Kepala Staf Kodim 0823</h3>
                        <p class="speaker-role">Penanggung Jawab Kegiatan</p>
                        <p class="text-muted">Memimpin apel pagi dan pengarahan teknis.</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-saat-kerjabakti-1.jpeg" alt="Nelayan" style="width:100%; height:100%; object-fit:cover;" onerror="this.src='https://ui-avatars.com/api/?name=Nelayan+Kilensari&background=60a5fa&color=fff&size=400';">
                        </div>
                        <h3 class="speaker-name">Masyarakat Nelayan</h3>
                        <p class="speaker-role">Desa Kilensari</p>
                        <p class="text-muted">Turut serta dalam pembersihan dermaga.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- GALLERY -->
    <section style="padding: 60px 0; background: white;">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Dokumentasi Karya Bakti</h2>
                    <p class="text-muted mt-3">Momen kebersamaan di Dermaga Lama Panarukan</p>
                </div>
            </div>
            <div class="row g-4">
                <div class="col-lg-4 col-md-6" data-aos="fade-up">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-kabid-dan-staff-sebelum-kegiatan.jpeg" alt="Foto bersama sebelum kegiatan">
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-kabid-dan-staff-selesai-kegiatan.jpeg" alt="Foto bersama selesai kegiatan">
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-saat-arahan-komandan-kodim.jpeg" alt="Arahan Komandan Kodim">
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-bersama-saat-upel-sebelum-kegiatan-dipimpin-kodim.jpeg" alt="Apel pagi">
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-saat-kerjabakti-1.jpeg" alt="Proses kerja bakti">
                    </div>
                </div>
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/dokumentasi/2026/februari/foto-saat-kerjabakti-2.jpeg" alt="Proses kerja bakti 2">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- VIDEO -->
    <section style="padding: 60px 0; background: #f8fafc;">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Video Dokumentasi</h2>
                    <p class="text-muted mt-3">Liputan singkat suasana kerja bakti</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-10 mx-auto" data-aos="fade-up">
                    <div style="position:relative; padding-bottom:56.25%; border-radius:24px; overflow:hidden; box-shadow:0 20px 40px rgba(0,0,0,0.1);">
                        <iframe style="position:absolute; top:0; left:0; width:100%; height:100%;" src="https://www.youtube.com/embed/ltIf0lYdyxU?si=RKRoGNfVE3xNI7yX" title="Video Karya Bakti" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ACTION BUTTONS -->
    <section style="padding: 60px 0; background: white;">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="mb-4" style="color:var(--primary-blue);">Akses Laporan dan Bagikan Kegiatan</h2>
                    <div class="d-flex flex-wrap justify-content-center gap-3">
                        <button class="btn btn-orange btn-lg" onclick="openPdfAuthModal()"><i class="fas fa-download me-2"></i>Download Laporan (PDF)</button>
                        <button class="btn btn-outline-warning btn-lg" onclick="openShareModal()" style="border:2px solid var(--orange-primary); color:var(--orange-primary);"><i class="fas fa-share-alt me-2"></i>Bagikan Kegiatan</button>
                        <a href="https://www.dinasperikanansitubondo.com/kegiatan" class="btn btn-outline-warning btn-lg" style="border:2px solid var(--orange-primary); color:var(--orange-primary);"><i class="fas fa-images me-2"></i>Kegiatan Lainnya</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-4 col-md-6">
                    <div class="d-flex flex-column">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/logo-header-footer-website-dinas-peternakan-perikanan.png" alt="Dinas Peternakan & Perikanan Situbondo" style="height: 90px; width: auto; margin-bottom: 20px;">
                        <h5>Dinas Peternakan & Perikanan</h5>
                        <p style="color: #d1d5db; font-size: 0.95rem;">Pemerintah Kabupaten Situbondo, Jawa Timur. Berkomitmen mewujudkan peternakan dan perikanan yang maju, mandiri, dan berkelanjutan.</p>
                        <div class="social-icons mt-3">
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-twitter"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6">
                    <h5>Tautan Cepat</h5>
                    <div class="footer-links mt-4">
                        <a href="https://www.dinasperikanansitubondo.com"><i class="fas fa-home me-2"></i>Beranda</a>
                        <a href="https://www.dinasperikanansitubondo.com/simpadan"><i class="fas fa-mobile-alt me-2"></i>SIMPADAN</a>
                        <a href="https://www.dinasperikanansitubondo.com/kegiatan"><i class="fas fa-images me-2"></i>Kegiatan</a>
                        <a href="https://situbondokab.go.id/"><i class="fas fa-university me-2"></i>Pemkab Situbondo</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5>Kontak</h5>
                    <div class="mt-4">
                        <div class="d-flex align-items-start mb-3">
                            <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:12px; margin-right:15px; color:var(--orange-primary); width:44px; height:44px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-map-marker-alt"></i></div>
                            <div><span class="d-block text-white fw-bold">Alamat</span><small class="text-light">Jl. PB Sudirman No.77 C, Situbondo</small></div>
                        </div>
                        <div class="d-flex align-items-start mb-3">
                            <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:12px; margin-right:15px; color:var(--orange-primary); width:44px; height:44px; display:flex; align-items:center; justify-content:center;"><i class="fab fa-whatsapp"></i></div>
                            <div><span class="d-block text-white fw-bold">WhatsApp</span><small class="text-light">0878 6561 4222</small></div>
                        </div>
                        <div class="d-flex align-items-start">
                            <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:12px; margin-right:15px; color:var(--orange-primary); width:44px; height:44px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-envelope"></i></div>
                            <div><span class="d-block text-white fw-bold">Email</span><small class="text-light">info@dinasperikanansitubondo.com</small></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5>Jam Pelayanan</h5>
                    <div class="mt-4">
                        <div class="d-flex align-items-start mb-3">
                            <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:12px; margin-right:15px; color:var(--orange-primary); width:44px; height:44px; display:flex; align-items:center; justify-content:center;"><i class="fas fa-clock"></i></div>
                            <div>
                                <span class="d-block text-white fw-bold">Senin – Kamis</span>
                                <small class="text-light">07:30 – 16:00 WIB</small>
                                <span class="d-block text-white fw-bold mt-2">Jumat</span>
                                <small class="text-light">07:30 – 11:00 WIB</small>
                            </div>
                        </div>
                        <div class="mt-4 pt-2">
                            <span class="text-light"><i class="fas fa-dove me-1" style="color: var(--orange-primary);"></i> #SitubondoNaikKelas</span>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="bg-light my-5" style="opacity:0.2;">
            <div class="text-center text-light">
                <p class="mb-2">© <span id="currentYear">2026</span> Dinas Peternakan & Perikanan Kabupaten Situbondo. Hak Cipta Dilindungi.</p>
                <small>Dibangun dengan <i class="fas fa-heart" style="color:var(--orange-primary);"></i> untuk Masyarakat Situbondo</small>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- ========= JAVASCRIPT FINAL – PERBAIKAN TOTAL ========= -->
    <script>
        // Inisialisasi AOS
        AOS.init({ duration: 800, once: true, offset: 100 });
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // ========= NAVBAR SCROLL EFFECT =========
        window.addEventListener('scroll', function () {
            const navbar = document.querySelector('.navbar');
            navbar.style.boxShadow = window.scrollY > 50
                ? '0 5px 20px rgba(0,0,0,0.08)'
                : '0 2px 15px rgba(0,0,0,0.05)';
            navbar.style.backgroundColor = 'rgba(255,255,255,0.98)';
        });

        // ========= GALLERY MODAL =========
        document.querySelectorAll('.gallery-item').forEach(item => {
            item.addEventListener('click', function () {
                const img = this.querySelector('img');
                const modalHTML = `
                <div class="modal fade" id="imageModal" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content border-0">
                            <div class="modal-body p-0 position-relative">
                                <img src="${img.src}" alt="${img.alt}" class="img-fluid w-100 rounded" style="border-radius:16px!important;">
                                <button type="button" class="btn-close position-absolute top-0 end-0 m-3 bg-white rounded-circle p-2" style="width:40px; height:40px;" data-bs-dismiss="modal"></button>
                            </div>
                        </div>
                    </div>
                </div>`;
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                const modal = new bootstrap.Modal(document.getElementById('imageModal'));
                modal.show();
                document.getElementById('imageModal').addEventListener('hidden.bs.modal', function () { this.remove(); });
            });
        });

        // ========= SMOOTH SCROLL =========
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) window.scrollTo({ top: target.offsetTop - 100, behavior: 'smooth' });
            });
        });

        // ========= SCROLL TO TOP =========
        const scrollTopBtn = document.createElement('button');
        scrollTopBtn.innerHTML = '<i class="fas fa-chevron-up"></i>';
        scrollTopBtn.className = 'btn btn-primary position-fixed rounded-circle shadow-lg';
        Object.assign(scrollTopBtn.style, {
            width: '50px', height: '50px', zIndex: '9999', display: 'none',
            background: 'linear-gradient(135deg, #f97316, #f59e0b)', border: 'none',
            bottom: '30px', right: '30px'
        });
        document.body.appendChild(scrollTopBtn);
        window.addEventListener('scroll', () => {
            scrollTopBtn.style.display = window.scrollY > 300 ? 'flex' : 'none';
            scrollTopBtn.style.alignItems = scrollTopBtn.style.justifyContent = 'center';
        });
        scrollTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

        // ========= SHARE FUNCTIONS (DECLARATION) =========
        window.openShareModal = function() {
            document.getElementById('shareModal').style.display = 'flex';
        };
        window.closeShareModal = function() {
            document.getElementById('shareModal').style.display = 'none';
        };
        window.shareToWhatsApp = function() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('Dinas Peternakan & Perikanan Situbondo turut serta dalam Karya Bakti Bersih Pantai Desa Kilensari, Kamis 12 Februari 2026.');
            window.open(`https://wa.me/?text=${text}%20${url}`, '_blank');
        };
        window.copyLink = function() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('Link berhasil disalin!');
                closeShareModal();
            });
        };
        document.getElementById('shareModal')?.addEventListener('click', e => e.target === e.currentTarget && closeShareModal());

        // ========= PDF AUTHORIZATION =========
        let maxAttempts = 3, currentAttempts = 0, lockoutTime = 0;
        const lockoutDuration = 5 * 60 * 1000;

        function generateSecurityCode() {
            const d = new Date();
            return `${String(d.getDate()).padStart(2, '0')}${String(d.getMonth() + 1).padStart(2, '0')}${d.getFullYear()}`;
        }

        function isLockedOut() {
            if (lockoutTime > 0) {
                const remaining = lockoutTime - Date.now();
                if (remaining > 0) {
                    const min = Math.floor(remaining / 60000), sec = Math.floor((remaining % 60000) / 1000);
                    return { locked: true, message: `Akses terkunci. Coba lagi dalam ${min} menit ${sec} detik.` };
                }
                lockoutTime = 0; currentAttempts = 0;
            }
            return { locked: false, message: '' };
        }

        let isPasswordVisible = false;
        window.togglePasswordVisibility = function() {
            const input = document.getElementById('securityCodeInput');
            const icon = document.getElementById('passwordToggle').querySelector('i');
            isPasswordVisible = !isPasswordVisible;
            input.type = isPasswordVisible ? 'text' : 'password';
            icon.className = isPasswordVisible ? 'fas fa-eye-slash' : 'fas fa-eye';
        };

        window.openPdfAuthModal = function() {
            const lock = isLockedOut();
            if (lock.locked) return alert(lock.message);
            const el = document.getElementById('securityCodeInput');
            el.value = ''; el.classList.remove('is-invalid');
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('attemptsLeft').textContent = maxAttempts - currentAttempts;
            document.getElementById('pdfAuthModal').style.display = 'flex';
            setTimeout(() => el.focus(), 300);
        };

        window.closePdfAuthModal = function() {
            document.getElementById('pdfAuthModal').style.display = 'none';
        };

        window.verifySecurityCode = function() {
            const lock = isLockedOut();
            if (lock.locked) {
                document.getElementById('errorText').textContent = lock.message;
                return document.getElementById('errorMessage').style.display = 'block';
            }
            const input = document.getElementById('securityCodeInput');
            const userCode = input.value;
            const correctCode = generateSecurityCode();
            const errorMsg = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');

            if (!userCode || userCode.length !== 8) {
                errorText.textContent = 'Kode harus 8 digit angka.';
                errorMsg.style.display = 'block';
                input.classList.add('is-invalid');
                return input.focus();
            }

            if (userCode === correctCode) {
                currentAttempts = 0;
                closePdfAuthModal();
                openPdfDataFormModal();
            } else {
                currentAttempts++;
                document.getElementById('attemptsLeft').textContent = maxAttempts - currentAttempts;
                if (currentAttempts >= maxAttempts) {
                    lockoutTime = Date.now() + lockoutDuration;
                    errorText.textContent = 'Terlalu banyak gagal. Akses terkunci 5 menit.';
                } else {
                    errorText.textContent = `Kode salah. Percobaan ${currentAttempts} dari ${maxAttempts}.`;
                }
                errorMsg.style.display = 'block';
                input.classList.add('is-invalid');
                input.style.animation = 'none';
                setTimeout(() => input.style.animation = 'shake 0.5s', 10);
                input.value = '';
                input.focus();
            }
        };

        // ========= FORM DATA PELAPOR =========
        let captchaResult = 0;

        window.openPdfDataFormModal = function() {
            const n1 = Math.floor(Math.random() * 5) + 3;
            const n2 = Math.floor(Math.random() * 5) + 2;
            captchaResult = n1 + n2;
            document.getElementById('captchaQuestion').innerHTML = `${n1} + ${n2} = ?`;
            document.getElementById('pdfDataForm').reset();
            ['namaPelapor', 'nipPelapor', 'captchaInput'].forEach(id => document.getElementById(id).classList.remove('is-invalid'));
            document.getElementById('captchaError').style.display = 'none';
            document.getElementById('pdfDataFormModal').style.display = 'flex';
        };

        window.closePdfDataFormModal = function() {
            document.getElementById('pdfDataFormModal').style.display = 'none';
        };

        window.submitPdfDataForm = function() {
            const nama = document.getElementById('namaPelapor').value.trim();
            const nip = document.getElementById('nipPelapor').value.trim();
            const captchaAnswer = document.getElementById('captchaInput').value.trim();
            const agreement = document.getElementById('agreementCheck').checked;

            let valid = true;
            if (!nama) { document.getElementById('namaPelapor').classList.add('is-invalid'); valid = false; }
            if (!nip || nip.length !== 18) { document.getElementById('nipPelapor').classList.add('is-invalid'); valid = false; }
            if (!captchaAnswer || parseInt(captchaAnswer) !== captchaResult) {
                document.getElementById('captchaInput').classList.add('is-invalid');
                document.getElementById('captchaError').style.display = 'block';
                valid = false;
            }
            if (!agreement) { alert('Anda harus menyetujui pernyataan.'); valid = false; }
            if (!valid) return;

            closePdfDataFormModal();
            generatePDFReport(nama, nip);
        };

        // ========= GENERATE PDF REPORT =========
        window.showLoading = function() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        };
        window.hideLoading = function() {
            document.getElementById('loadingOverlay').style.display = 'none';
        };
        window.openPdfPreview = function() {
            document.getElementById('pdfPreviewModal').style.display = 'flex';
        };
        window.closePdfPreview = function() {
            document.getElementById('pdfPreviewModal').style.display = 'none';
        };

        // Fungsi generate QR code lokal (data URL) dengan fallback
        function generateQRDataURL(text, size = 90) {
            if (typeof qrcode === 'undefined') {
                console.warn('qrcode-generator tidak tersedia, gunakan fallback canvas teks.');
                const canvas = document.createElement('canvas');
                canvas.width = size;
                canvas.height = size;
                const ctx = canvas.getContext('2d');
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, size, size);
                ctx.fillStyle = '#1e3a8a';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('QR', size/2, size/2);
                return canvas.toDataURL('image/png');
            }
            try {
                const qr = qrcode(0, 'H');
                qr.addData(text);
                qr.make();
                const cellSize = 4;
                const margin = 2;
                const canvas = document.createElement('canvas');
                const sz = qr.getModuleCount() * cellSize + margin * 2;
                canvas.width = canvas.height = sz;
                const ctx = canvas.getContext('2d');
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, sz, sz);
                ctx.fillStyle = '#1e3a8a';
                for (let r = 0; r < qr.getModuleCount(); r++) {
                    for (let c = 0; c < qr.getModuleCount(); c++) {
                        if (qr.isDark(r, c)) {
                            ctx.fillRect(c * cellSize + margin, r * cellSize + margin, cellSize, cellSize);
                        }
                    }
                }
                return canvas.toDataURL('image/png');
            } catch (e) {
                console.error('Gagal generate QR:', e);
                const canvas = document.createElement('canvas');
                canvas.width = 90;
                canvas.height = 90;
                return canvas.toDataURL('image/png');
            }
        }

        // Fungsi utama generate PDF
        async function generatePDFReport(namaPelapor, nipPelapor) {
            showLoading();
            const currentDate = new Date();
            const formattedDate = currentDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });

            const kopSuratURL = 'https://images.weserv.nl/?url=raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/kop-surat-resmi-dinas-peternakan-perikanan-situbondo.png';
            const qrDataURL = generateQRDataURL(window.location.href, 90);

            const pdfContent = `
            <div style="font-family: 'Times New Roman', Times, serif; line-height: 1.6; color: #2d3e50; padding: 5px 20px;">
                <div style="margin-bottom: 20px; text-align: center; border-bottom: 2px solid #1e3a8a; padding-bottom: 15px;">
                    <img src="${kopSuratURL}" alt="Kop Surat" style="width: 100%; max-width: 700px; height: auto; display: block; margin: 0 auto;" crossorigin="anonymous" loading="lazy">
                </div>
                <div style="text-align: center; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 5px; font-size: 14px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; color: #1e3a8a;">LAPORAN RESMI KEGIATAN</h3>
                    <h1 style="font-size: 18px; font-weight: bold; text-decoration: underline; color: #b45309; margin-bottom: 8px;">KARYA BAKTI BERSIH PANTAI DESA KILENSARI</h1>
                    <h2 style="font-size: 16px; font-weight: 600; color: #1e3a8a; margin-top: 0;">DERMAGA LAMA PANARUKAN</h2>
                </div>
                <div style="margin-bottom: 30px;">
                    <h4 style="font-size:13px; font-weight:bold; margin-bottom:10px; color:#1e3a8a; border-bottom: 1.5px solid #f97316; padding-bottom: 6px;">I. DASAR PELAKSANAAN</h4>
                    <p style="text-align:justify; margin-bottom:12px; font-size:12px; text-indent:30px;">
                        Surat Komando Distrik Militer 0823 Nomor <strong>B/99/II/2026</strong> tanggal 11 Februari 2026 perihal Permohonan Bantuan Personel, 
                        sebagai tindak lanjut Instruksi Presiden RI pada Rakornas Pusat dan Daerah serta Telegram Danrem 083/Bdj Nomor ST/108/2026.
                    </p>
                    <h4 style="font-size:13px; font-weight:bold; margin-bottom:10px; color:#1e3a8a; border-bottom: 1.5px solid #f97316; padding-bottom: 6px;">II. WAKTU DAN TEMPAT</h4>
                    <ul style="font-size:12px; line-height:1.7; padding-left: 20px;">
                        <li>Hari/Tanggal : Kamis, 12 Februari 2026</li>
                        <li>Waktu        : 06.00 WIB – selesai</li>
                        <li>Tempat       : Dermaga Lama Panarukan, Desa Kilensari, Kec. Panarukan, Kab. Situbondo</li>
                    </ul>
                    <h4 style="font-size:13px; font-weight:bold; margin-bottom:10px; color:#1e3a8a; border-bottom: 1.5px solid #f97316; padding-bottom: 6px;">III. PERSONEL DAN MATERIIL</h4>
                    <ul style="font-size:12px; line-height:1.7; padding-left: 20px;">
                        <li>Dinas Peternakan & Perikanan : 20 personel + Kabid Pemberdayaan Nelayan</li>
                        <li>Seluruh OPD Kab. Situbondo : masing-masing 20 personel (kecuali DLH 50, Dishub 10+5, Dinkes 20+tim medis)</li>
                        <li>Alat yang digunakan : sapu lidi, cangkul, sabit, mesin rumput, kantong sampah, 5 unit truk, 2 unit ambulans</li>
                    </ul>
                    <h4 style="font-size:13px; font-weight:bold; margin-bottom:10px; color:#1e3a8a; border-bottom: 1.5px solid #f97316; padding-bottom: 6px;">IV. HASIL KEGIATAN</h4>
                    <p style="text-align:justify; font-size:12px; text-indent:30px; margin-bottom:15px;">
                        Kegiatan berjalan lancar dan tertib. Kawasan Dermaga Lama Panarukan yang sebelumnya tampak kumuh dan dipenuhi sampah 
                        serta rumput liar berhasil dibersihkan secara signifikan. Sinergi antara TNI, Polri, Pemerintah Daerah, dan masyarakat 
                        terjalin sangat baik. Dinas Peternakan dan Perikanan turut serta membersihkan area pendaratan ikan dan memberikan edukasi 
                        kepada nelayan sekitar.
                    </p>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 70px; align-items: flex-end;">
                    <div style="width: 55%;">
                        <p style="margin-bottom:5px; font-size:12px;">Ditetapkan di : Situbondo</p>
                        <p style="margin-bottom:20px; font-size:12px;">Pada tanggal  : ${formattedDate}</p>
                        <p style="font-weight:bold; font-size:12px; margin-bottom:5px;">Pelapor,</p>
                        <div style="margin-top: 50px;">
                            <p style="font-size:14px; font-weight: bold; margin-bottom:2px;">${namaPelapor || '______________________'}</p>
                            <p style="font-size:11px; color: #4b5563;">NIP. ${nipPelapor || '______________________'}</p>
                        </div>
                    </div>
                    <div style="width: 35%; text-align: right;">
                        <div style="display: inline-block; background: white; padding: 8px; border-radius: 8px; border: 1px solid #e5e7eb; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);">
                            <img src="${qrDataURL}" alt="QR Code Laporan" style="width: 80px; height: 80px; display: block;">
                        </div>
                        <p style="font-size:9px; margin-top:8px; color: #6b7280;">Scan untuk akses laporan digital</p>
                    </div>
                </div>
                <div style="margin-top: 80px; border-top: 1px solid #d1d5db; padding-top: 15px; text-align: center; font-size: 10px; color: #6b7280;">
                    <p style="margin-bottom: 3px;">Dinas Peternakan dan Perikanan Kabupaten Situbondo – Dokumen Resmi</p>
                    <p style="margin-bottom: 0;">© ${currentDate.getFullYear()} · Laporan Karya Bakti Kodim 0823 · #SitubondoNaikKelas</p>
                </div>
            </div>
            `;

            const previewDiv = document.getElementById('pdfPreviewContent');
            previewDiv.innerHTML = pdfContent;
            previewDiv.style.backgroundColor = 'white';
            previewDiv.style.padding = '15px 20px';
            previewDiv.style.borderRadius = '8px';
            previewDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.05)';

            // Tunggu semua gambar selesai dimuat
            const imgs = previewDiv.getElementsByTagName('img');
            await Promise.all(Array.from(imgs).map(img => {
                if (img.complete) return Promise.resolve();
                return new Promise(resolve => {
                    img.onload = resolve;
                    img.onerror = () => {
                        console.warn('Gambar gagal dimuat:', img.src);
                        resolve();
                    };
                });
            }));

            hideLoading();
            openPdfPreview();
        }

        // ========= DOWNLOAD PDF – PERBAIKAN TOTAL (CLONE, ANTI TERPOTONG) =========
        window.downloadPDF = async function() {
            showLoading();
            try {
                const { jsPDF } = window.jspdf;
                if (!jsPDF) throw new Error('jsPDF tidak tersedia');

                const originalElement = document.getElementById('pdfPreviewContent');
                if (!originalElement) throw new Error('Elemen preview tidak ditemukan');

                // Clone elemen agar tidak mengganggu tampilan asli
                const cloneElement = originalElement.cloneNode(true);
                cloneElement.style.width = '210mm';
                cloneElement.style.padding = '10mm 12mm';
                cloneElement.style.backgroundColor = 'white';
                cloneElement.style.boxShadow = 'none';
                cloneElement.style.borderRadius = '0';
                cloneElement.style.position = 'absolute';
                cloneElement.style.left = '-9999px';
                cloneElement.style.top = '0';
                document.body.appendChild(cloneElement);

                // Tunggu semua gambar di clone selesai dimuat
                const imgs = cloneElement.getElementsByTagName('img');
                await Promise.all(Array.from(imgs).map(img => {
                    if (img.complete) return Promise.resolve();
                    return new Promise(resolve => {
                        img.onload = resolve;
                        img.onerror = () => {
                            console.warn('Gambar gagal dimuat di clone:', img.src);
                            resolve();
                        };
                    });
                }));

                // Beri sedikit jeda untuk rendering
                await new Promise(r => setTimeout(r, 300));

                const canvas = await html2canvas(cloneElement, {
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: false,
                    backgroundColor: '#ffffff',
                    imageTimeout: 15000,
                    windowWidth: cloneElement.scrollWidth,
                    windowHeight: cloneElement.scrollHeight
                });

                // Hapus clone dari DOM
                document.body.removeChild(cloneElement);

                if (canvas.width === 0 || canvas.height === 0) {
                    throw new Error('Canvas kosong, gagal render HTML');
                }

                const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
                const imgWidth = 210; // mm
                const pageHeight = 297; // mm
                const marginTop = 15;
                const marginBottom = 15;
                const contentHeight = pageHeight - marginTop - marginBottom;

                let imgHeight = (canvas.height * imgWidth) / canvas.width;
                let position = 0;
                let pageCount = 1;

                while (position < imgHeight) {
                    const canvasPage = document.createElement('canvas');
                    const ctx = canvasPage.getContext('2d');
                    const ratio = canvas.height / imgHeight;
                    const pageHeightPx = contentHeight * ratio;
                    const startY = position * ratio;
                    const remainingHeight = canvas.height - startY;

                    canvasPage.width = canvas.width;
                    canvasPage.height = Math.min(pageHeightPx, remainingHeight);

                    ctx.drawImage(canvas, 0, startY, canvas.width, canvasPage.height, 0, 0, canvas.width, canvasPage.height);

                    const imgData = canvasPage.toDataURL('image/png');

                    if (position > 0) doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, marginTop, imgWidth, (canvasPage.height * imgWidth) / canvas.width, undefined, 'FAST');

                    doc.setFont('times', 'normal');
                    doc.setFontSize(9);
                    doc.setTextColor(100, 100, 100);
                    doc.text(`Halaman ${pageCount}`, imgWidth - 25, pageHeight - 8);

                    position += contentHeight;
                    pageCount++;
                }

                doc.save(`Laporan_Karya_Bakti_Panarukan_${Date.now()}.pdf`);
                hideLoading();
                closePdfPreview();
                alert('✅ PDF berhasil diunduh!');
            } catch (err) {
                console.error('❌ PDF Error:', err);
                hideLoading();
                alert('❌ Gagal mengunduh PDF. Cek koneksi dan library.\nError: ' + err.message);
            }
        };

        // ========= EVENT LISTENERS =========
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                if (typeof closeShareModal === 'function') closeShareModal();
                if (typeof closePdfAuthModal === 'function') closePdfAuthModal();
                if (typeof closePdfPreview === 'function') closePdfPreview();
                if (typeof closePdfDataFormModal === 'function') closePdfDataFormModal();
            }
        });

        document.getElementById('passwordToggle')?.addEventListener('click', togglePasswordVisibility);
        document.getElementById('securityCodeInput')?.addEventListener('keypress', e => e.key === 'Enter' && verifySecurityCode());
        document.getElementById('securityCodeInput')?.addEventListener('input', function () { this.value = this.value.replace(/[^0-9]/g, ''); });
        document.getElementById('pdfAuthModal')?.addEventListener('click', e => e.target === e.currentTarget && closePdfAuthModal());
        document.getElementById('pdfDataFormModal')?.addEventListener('click', e => e.target === e.currentTarget && closePdfDataFormModal());
        document.getElementById('pdfPreviewModal')?.addEventListener('click', e => e.target === e.currentTarget && closePdfPreview());

        console.log('Kode akses hari ini:', generateSecurityCode());
    </script>
</body>
</html>
