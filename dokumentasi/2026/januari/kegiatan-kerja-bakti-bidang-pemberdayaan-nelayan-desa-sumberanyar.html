<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerja Bakti Persiapan Peresmian Pasar Higienis Ikan Segar Mimbo - Dinas Perikanan Situbondo</title>
    <meta name="description" content="Kegiatan kerja bakti dalam rangka persiapan peresmian pasar higienis ikan segar Mimbo yang dihadiri Camat Banyuputih beserta staf, Pemdes Sumberanyar, dan Tim Bidang Pemberdayaan Nelayan dari Dinas Peternakan dan Perikanan Kabupaten Situbondo.">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- jsPDF untuk generate PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        :root {
            --primary-green: #166534;
            --secondary-green: #16a34a;
            --accent-green: #22c55e;
            --light-green: #f0fdf4;
            --success-teal: #0d9488;
            --warning-amber: #f59e0b;
            --text-dark: #1f2937;
            --text-gray: #6b7280;
            --light-gray: #f9fafb;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-gray);
            line-height: 1.7;
            background-color: var(--light-gray);
            position: relative;
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
            font-weight: 600;
        }

        /* ===== NAVBAR ===== */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
            padding: 1rem 0;
            transition: all 0.3s ease;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .navbar-brand img {
            height: 48px;
            width: auto;
        }

        .brand-text h5 {
            color: var(--primary-green);
            margin: 0;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .brand-text span {
            font-size: 0.75rem;
            color: var(--secondary-green);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .nav-link {
            color: var(--text-dark) !important;
            font-weight: 500;
            padding: 0.5rem 1rem !important;
            margin: 0 0.25rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            color: var(--secondary-green) !important;
            background-color: var(--light-green);
        }

        .nav-link.active {
            color: var(--secondary-green) !important;
            background-color: var(--light-green);
        }

        /* ===== HERO SECTION ===== */
        .hero-section {
            background: linear-gradient(135deg, rgba(22, 101, 52, 0.95), rgba(22, 101, 52, 0.85)),
                        url('https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti1.jpeg');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0 60px;
            margin-top: 76px;
            position: relative;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to bottom, transparent, var(--light-gray));
        }

        .hero-section h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .badge-category {
            background: rgba(255, 255, 255, 0.25);
            color: white;
            padding: 8px 24px;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* ===== INFO CARDS ===== */
        .info-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            transition: transform 0.3s ease;
            height: 100%;
        }

        .info-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.25);
        }

        .info-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: white;
            font-size: 1.5rem;
        }

        /* ===== CONTENT SECTIONS ===== */
        .section-title {
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
            color: var(--primary-green);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--secondary-green), var(--accent-green));
            border-radius: 3px;
        }

        .content-box {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.06);
            margin-bottom: 40px;
            border: 1px solid #e5e7eb;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .content-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(34, 197, 94, 0.1);
        }

        .highlight-box {
            background: linear-gradient(135deg, var(--light-green), #dcfce7);
            border-left: 4px solid var(--secondary-green);
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
        }

        .highlight-box h5 {
            color: var(--primary-green);
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* ===== SPEAKERS SECTION ===== */
        .speakers-section {
            padding: 80px 0;
            background: var(--light-green);
            position: relative;
        }

        .speaker-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            height: 100%;
            transition: all 0.4s ease;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
        }

        .speaker-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--secondary-green), var(--accent-green));
        }

        .speaker-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(34, 197, 94, 0.15);
        }

        .speaker-image {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 25px;
            border: 5px solid var(--light-green);
            position: relative;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .speaker-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .speaker-card:hover .speaker-image img {
            transform: scale(1.05);
        }

        .speaker-name {
            color: var(--primary-green);
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 1.4rem;
        }

        .speaker-role {
            color: var(--secondary-green);
            font-weight: 600;
            margin-bottom: 20px;
            font-size: 1rem;
            background: var(--light-green);
            padding: 8px 20px;
            border-radius: 50px;
            display: inline-block;
        }

        .speaker-desc {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 0;
        }

        /* ===== GALLERY SECTION ===== */
        .gallery-section {
            padding: 80px 0;
            background: white;
        }

        .gallery-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            height: 280px;
            margin-bottom: 25px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.4s ease;
        }

        .gallery-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            display: flex;
            align-items: flex-end;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-caption {
            color: white;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .gallery-item:hover .gallery-caption {
            transform: translateY(0);
        }

        /* ===== VIDEO SECTION ===== */
        .video-section {
            padding: 80px 0;
            background: var(--light-green);
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 16px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* ===== MODULES SECTION ===== */
        .modules-section {
            padding: 80px 0;
            background: white;
        }

        .module-card {
            background: var(--light-green);
            border-radius: 12px;
            padding: 30px;
            height: 100%;
            border: 1px solid #bbf7d0;
            transition: all 0.3s ease;
        }

        .module-card:hover {
            background: white;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary-green);
        }

        .module-icon {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            color: var(--secondary-green);
            font-size: 1.8rem;
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.1);
        }

        /* ===== ACTION BUTTONS ===== */
        .action-buttons {
            padding: 60px 0;
            background: white;
        }

        .btn-download {
            background: linear-gradient(135deg, var(--secondary-green), var(--primary-green));
            color: white;
            padding: 16px 36px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            cursor: pointer;
            font-size: 1.05rem;
            box-shadow: 0 6px 15px rgba(34, 197, 94, 0.2);
            position: relative;
            overflow: hidden;
        }

        .btn-download::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s ease;
        }

        .btn-download:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(34, 197, 94, 0.3);
            color: white;
        }

        .btn-download:hover::before {
            left: 100%;
        }

        .btn-share {
            background: white;
            color: var(--secondary-green);
            padding: 16px 36px;
            border-radius: 12px;
            font-weight: 600;
            border: 2px solid var(--secondary-green);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            cursor: pointer;
            font-size: 1.05rem;
            box-shadow: 0 6px 15px rgba(34, 197, 94, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn-share::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: var(--secondary-green);
            transition: width 0.3s ease;
            z-index: 0;
        }

        .btn-share:hover {
            background: var(--secondary-green);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(34, 197, 94, 0.2);
        }

        .btn-share:hover::before {
            width: 100%;
        }

        .btn-share span {
            position: relative;
            z-index: 1;
        }

        /* ===== FOOTER ===== */
        .footer {
            background: var(--primary-green);
            color: white;
            padding: 80px 0 30px;
            position: relative;
            width: 100%;
            margin-top: 60px;
        }

        .footer h5 {
            color: white;
            margin-bottom: 25px;
            font-size: 1.2rem;
            position: relative;
            display: inline-block;
        }

        .footer h5::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--accent-green);
            border-radius: 3px;
        }

        .footer-links a {
            color: #d1d5db;
            text-decoration: none;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            padding: 5px 0;
        }

        .footer-links a:hover {
            color: white;
            padding-left: 10px;
        }

        .social-icons a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 42px;
            height: 42px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            margin-right: 10px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .social-icons a:hover {
            background: var(--secondary-green);
            transform: translateY(-3px);
        }

        /* ===== SHARE MODAL ===== */
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .share-modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .share-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            border-radius: 12px;
            background: var(--light-gray);
            border: none;
            transition: all 0.3s ease;
            cursor: pointer;
            width: 100%;
            font-weight: 600;
            font-size: 1rem;
        }

        .share-btn:hover {
            background: var(--light-green);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .share-btn i {
            font-size: 20px;
        }

        .share-btn.whatsapp {
            background: #25D366;
            color: white;
        }

        .share-btn.copy {
            background: var(--secondary-green);
            color: white;
        }

        /* ===== LOADING OVERLAY ===== */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 99999;
            justify-content: center;
            align-items: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--secondary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== PDF PREVIEW MODAL ===== */
        .pdf-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 99999;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }

        .pdf-preview-content {
            background: white;
            padding: 20px;
            border-radius: 16px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .pdf-preview {
            background: white;
            padding: 30px 20px;
            border: 1px solid #ddd;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', Times, serif;
        }

        .qr-code {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            padding: 5px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* ===== PDF AUTH MODAL ===== */
        .pdf-auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100000;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }

        .pdf-auth-content {
            background: white;
            padding: 30px 20px;
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            margin: 0 auto;
        }

        .auth-icon {
            width: 70px;
            height: 70px;
            background: var(--light-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: var(--primary-green);
            font-size: 1.8rem;
            border: 3px solid var(--accent-green);
        }

        .input-group-password {
            position: relative;
            width: 100%;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            z-index: 10;
            padding: 5px;
        }

        .password-toggle:hover {
            color: var(--primary-green);
        }

        .error-message {
            color: #dc3545;
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
            width: 100%;
        }

        .info-message {
            background: var(--light-green);
            border-left: 4px solid var(--secondary-green);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 0.9rem;
            width: 100%;
        }

        .attempts-counter {
            font-size: 0.85rem;
            color: var(--text-gray);
            text-align: center;
            margin-top: 15px;
            width: 100%;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 992px) {
            .hero-section h1 {
                font-size: 2.2rem;
            }
            
            .content-box {
                padding: 30px;
            }
            
            .speaker-card {
                padding: 25px;
            }
            
            .speaker-image {
                width: 160px;
                height: 160px;
            }
            
            .footer {
                padding: 60px 0 30px;
            }
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 80px 0 40px;
                margin-top: 66px;
            }
            
            .hero-section h1 {
                font-size: 1.8rem;
            }
            
            .content-box {
                padding: 25px;
            }
            
            .speaker-image {
                width: 140px;
                height: 140px;
            }
            
            .gallery-item {
                height: 220px;
            }
            
            .btn-download, .btn-share {
                padding: 14px 28px;
                font-size: 1rem;
            }
            
            .footer {
                padding: 50px 0 20px;
            }

            .pdf-auth-content {
                padding: 25px 15px;
            }
            
            .pdf-preview-content {
                padding: 15px;
            }
            
            .pdf-preview {
                padding: 20px 15px;
            }
            
            .info-message {
                padding: 12px;
                font-size: 0.85rem;
            }
        }

        @media (max-width: 576px) {
            .hero-section h1 {
                font-size: 1.6rem;
            }
            
            .badge-category {
                font-size: 0.8rem;
                padding: 6px 18px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .speaker-image {
                width: 120px;
                height: 120px;
            }
            
            .speaker-name {
                font-size: 1.2rem;
            }
            
            .action-buttons .btn-download,
            .action-buttons .btn-share {
                width: 100%;
                justify-content: center;
                margin-bottom: 10px;
                padding: 14px 20px;
            }
            
            .pdf-auth-content {
                padding: 20px 15px;
            }
            
            .pdf-preview-content {
                padding: 12px;
            }
            
            .pdf-preview {
                padding: 15px 12px;
            }
            
            .auth-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .alert-warning {
                font-size: 0.85rem;
                padding: 12px;
            }
            
            .form-control-lg {
                font-size: 0.9rem;
                padding: 12px 40px 12px 12px;
            }
            
            .d-flex.justify-content-between.mt-4 {
                flex-direction: column;
                gap: 10px;
            }
            
            .d-flex.justify-content-between.mt-4 .btn {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .info-message {
                font-size: 0.8rem;
                padding: 10px;
            }
            
            .attempts-counter {
                font-size: 0.8rem;
            }
            
            .error-message {
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 400px) {
            .pdf-auth-content {
                padding: 15px 10px;
            }
            
            .pdf-preview-content {
                padding: 10px;
            }
            
            .pdf-preview {
                padding: 12px 10px;
            }
            
            .auth-icon {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .form-control-lg {
                font-size: 0.85rem;
                padding: 10px 35px 10px 10px;
            }
        }
        
        /* Fix for password input on mobile */
        .form-control {
            width: 100% !important;
        }
        
        /* Fix for modal buttons on mobile */
        .modal-footer .btn, 
        .pdf-auth-content .btn {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Ensure text doesn't overflow on mobile */
        .speaker-desc, 
        .speaker-role, 
        .speaker-name,
        .gallery-caption h6,
        .gallery-caption small {
            word-break: break-word;
            overflow-wrap: break-word;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Share Modal -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <h3 class="section-title">Bagikan Kegiatan Ini</h3>
            <p>Pilih opsi untuk membagikan informasi kerja bakti:</p>
            <div class="share-buttons">
                <button class="share-btn whatsapp" onclick="shareToWhatsApp()">
                    <i class="fab fa-whatsapp"></i>
                    <span>Bagikan ke WhatsApp</span>
                </button>
                <button class="share-btn copy" onclick="copyLink()">
                    <i class="fas fa-copy"></i>
                    <span>Salin Link</span>
                </button>
            </div>
            <button class="btn btn-secondary mt-4 w-100" onclick="closeShareModal()" style="padding: 10px; border-radius: 10px;">Tutup</button>
        </div>
    </div>

    <!-- PDF Authorization Modal -->
    <div class="pdf-auth-modal" id="pdfAuthModal">
        <div class="pdf-auth-content">
            <div class="auth-icon">
                <i class="fas fa-lock"></i>
            </div>
            
            <h3 class="section-title text-center">Otorisasi Akses Dokumen</h3>
            
            <div class="alert alert-warning" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong>Perhatian:</strong> Anda telah memasuki hak akses yang membutuhkan otorisasi dan merupakan tindakan untuk mencetak dokumen pelaporan
            </div>
            
            <div class="info-message">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Informasi Kode Keamanan:</strong> Untuk mendapatkan kode yang valid, harap hubungi petugas yang berwenang di Dinas Perikanan Situbondo.
            </div>
            
            <div class="mb-4">
                <label for="securityCodeInput" class="form-label fw-bold">Masukkan Kode Keamanan</label>
                <div class="input-group-password">
                    <input type="password" 
                           class="form-control form-control-lg" 
                           id="securityCodeInput" 
                           placeholder="Masukkan 8 digit kode keamanan"
                           maxlength="8"
                           onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                    <button type="button" class="password-toggle" id="passwordToggle">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="error-message" id="errorMessage">
                    <i class="fas fa-times-circle me-2"></i>
                    <span id="errorText">Kode keamanan yang Anda masukkan salah. Silakan coba lagi.</span>
                </div>
            </div>
            
            <div class="attempts-counter">
                <i class="fas fa-shield-alt me-2"></i>
                Percobaan tersisa: <span id="attemptsLeft">3</span>
            </div>
            
            <div class="d-flex justify-content-between mt-4 flex-wrap">
                <button class="btn btn-secondary mb-2" onclick="closePdfAuthModal()" style="padding: 12px 20px; border-radius: 10px; min-width: 120px;">
                    <i class="fas fa-times me-2"></i>Batal
                </button>
                <button class="btn btn-primary mb-2" onclick="verifySecurityCode()" style="background: linear-gradient(135deg, var(--secondary-green), var(--primary-green)); border: none; padding: 12px 20px; border-radius: 10px; min-width: 120px;">
                    <i class="fas fa-check me-2"></i>Verifikasi
                </button>
            </div>
        </div>
    </div>

    <!-- PDF Preview Modal -->
    <div class="pdf-preview-modal" id="pdfPreviewModal">
        <div class="pdf-preview-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="section-title mb-0">Pratinjau Laporan PDF</h3>
                <button class="btn-close" onclick="closePdfPreview()"></button>
            </div>
            <div class="pdf-preview" id="pdfPreviewContent">
                <!-- PDF content will be generated here -->
            </div>
            <div class="d-flex justify-content-between mt-4 flex-wrap">
                <button class="btn btn-secondary mb-2" onclick="closePdfPreview()" style="padding: 10px 20px; border-radius: 10px; min-width: 120px;">Tutup</button>
                <button class="btn btn-primary mb-2" onclick="downloadPDF()" style="background: linear-gradient(135deg, var(--secondary-green), var(--primary-green)); border: none; padding: 10px 20px; border-radius: 10px; min-width: 120px;">Download PDF</button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://www.dinasperikanansitubondo.com">
                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" alt="Logo Kabupaten Situbondo">
                <div class="brand-text">
                    <h5>DINAS PERIKANAN</h5>
                    <span>KABUPATEN SITUBONDO</span>
                </div>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.dinasperikanansitubondo.com">Beranda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.dinasperikanansitubondo.com/dokumentasi">Dokumentasi</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Kerja Bakti</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.dinasperikanansitubondo.com/simpadan">SIMPADAN</a>
                    </li>
                    <li class="nav-item ms-2">
                        <a href="https://www.dinasperikanansitubondo.com#aduan" class="btn btn-primary" style="background: linear-gradient(135deg, var(--secondary-green), var(--primary-green)); border: none; padding: 10px 24px; border-radius: 10px;">
                            <i class="fas fa-phone-alt me-2"></i>Hubungi Kami
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <span class="badge-category">
                        <i class="fas fa-hands-helping"></i> KERJA BAKTI MASYARAKAT
                    </span>
                    <h1 data-aos="fade-up">Kerja Bakti Persiapan Peresmian Pasar Higienis Ikan Segar Mimbo</h1>
                    <p class="lead mb-5" data-aos="fade-up" data-aos-delay="100">
                        Kegiatan kerja bakti dalam rangka persiapan peresmian pasar higienis ikan segar Mimbo yang dihadiri oleh Camat Banyuputih beserta staf, Pemdes Sumberanyar, dan Tim Bidang Pemberdayaan Nelayan dari Dinas Peternakan dan Perikanan Kabupaten Situbondo.
                    </p>
                    
                    <div class="row g-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div>
                                    <h5 class="text-white mb-2">Tanggal Kegiatan</h5>
                                    <p class="text-white mb-0">19 Februari 2025</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                                <div>
                                    <h5 class="text-white mb-2">Lokasi</h5>
                                    <p class="text-white mb-0">Pasar Ikan Mimbo, Sumberanyar</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-card">
                                <div class="info-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div>
                                    <h5 class="text-white mb-2">Partisipan</h5>
                                    <p class="text-white mb-0">Multi-stakeholder</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <!-- Deskripsi Lengkap -->
                    <div class="content-box" data-aos="fade-up">
                        <h2 class="section-title">Sinergi untuk Pasar Higienis Ikan Segar</h2>
                        
                        <div class="description-text">
                            <p>Kegiatan kerja bakti ini merupakan bagian dari persiapan menuju peresmian <strong>Pasar Higienis Ikan Segar Mimbo</strong> yang bertujuan meningkatkan kualitas penjualan ikan segar di wilayah pesisir Situbondo. Kegiatan ini melibatkan berbagai pihak yang menunjukkan komitmen bersama dalam pembangunan infrastruktur perikanan.</p>
                            
                            <div class="highlight-box">
                                <h5><i class="fas fa-exclamation-triangle"></i> Kendala yang Ditemui</h5>
                                <p>Selama proses persiapan, ditemukan beberapa kendala teknis yang perlu segera diatasi, antara lain:</p>
                                <ul>
                                    <li><strong>Akses jalan ke pasar kurang tinggi</strong> sehingga menyulitkan transportasi ikan masuk dan keluar pasar</li>
                                    <li><strong>Pasar tidak memiliki pintu muka yang mengarah ke pantai</strong> padahal lokasi pasar sangat dekat dengan pantai dan aktivitas nelayan</li>
                                </ul>
                            </div>
                            
                            <p>Untuk mengatasi kendala ini, <strong>Dinas Peternakan dan Perikanan Kabupaten Situbondo</strong> bersama dengan <strong>Pemerintah Desa Sumberanyar</strong> melakukan koordinasi intensif. Salah satu solusi yang sedang diupayakan adalah <strong>kerjasama dengan pemilik lahan di depan pasar</strong> yang saat ini masih milik pribadi.</p>
                            
                            <p>Dengan adanya kerja bakti ini, diharapkan pasar dapat segera difungsikan secara optimal untuk mendukung aktivitas perikanan di Mimbo dan sekitarnya, meningkatkan kualitas ikan yang dijual, serta memberikan kenyamanan bagi penjual dan pembeli.</p>
                        </div>
                    </div>
                    
                    <!-- Tindakan dan Solusi -->
                    <div class="content-box" data-aos="fade-up" data-aos-delay="100">
                        <h2 class="section-title">Tindakan dan Solusi yang Dilakukan</h2>
                        
                        <div class="description-text">
                            <p>Untuk mengatasi kendala yang ditemui, beberapa langkah strategis telah dan sedang dilakukan oleh seluruh pihak terkait:</p>
                            
                            <div class="highlight-box">
                                <h5><i class="fas fa-handshake"></i> Kerjasama Multi-Pihak</h5>
                                <p><strong>Dinas Peternakan dan Perikanan Kabupaten Situbondo</strong> telah menginisiasi pertemuan dengan <strong>Pemerintah Desa Sumberanyar</strong> dan <strong>pemilik lahan pribadi</strong> untuk membahas kemungkinan pembuatan pintu muka pasar yang mengarah langsung ke pantai.</p>
                            </div>
                            
                            <p>Beberapa upaya konkret yang telah dilakukan dalam kerja bakti ini antara lain:</p>
                            <ul>
                                <li>Pembersihan area pasar dari sampah dan kotoran</li>
                                <li>Perbaikan infrastruktur dasar di dalam area pasar</li>
                                <li>Koordinasi dengan pemilik lahan untuk akses pintu depan pasar</li>
                                <li>Pemetaan ulang akses transportasi menuju pasar</li>
                                <li>Persiapan sarana dan prasarana pendukung pasar higienis</li>
                            </ul>
                            
                            <p>Kegiatan kerja bakti ini juga menjadi momentum penting untuk <strong>sosialisasi pentingnya pasar higienis</strong> kepada masyarakat sekitar, terutama para nelayan dan penjual ikan. Dengan pasar yang memenuhi standar higienis, diharapkan dapat meningkatkan nilai jual ikan dan kesehatan masyarakat.</p>
                            
                            <p>Melalui sinergi antara pemerintah daerah, desa, dan masyarakat, diharapkan <strong>Pasar Higienis Ikan Segar Mimbo</strong> dapat segera beroperasi dan memberikan manfaat maksimal bagi perekonomian masyarakat pesisir Situbondo.</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4">
                    <!-- Organizer -->
                    <div class="content-box" data-aos="fade-left">
                        <h2 class="section-title">Pihak Terkait</h2>
                        
                        <div class="mb-4">
                            <div class="d-flex align-items-center mb-4 p-3 rounded" style="background: var(--light-green);">
                                <div class="bg-primary-green p-3 rounded-circle me-3">
                                    <i class="fas fa-university text-white"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1 text-primary-green">Camat Banyuputih</h5>
                                    <p class="text-muted mb-0">Beserta staf kecamatan</p>
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center mb-4 p-3 rounded" style="background: var(--light-green);">
                                <div class="bg-secondary-green p-3 rounded-circle me-3">
                                    <i class="fas fa-home text-white"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1 text-primary-green">Pemdes Sumberanyar</h5>
                                    <p class="text-muted mb-0">Pemerintah Desa Sumberanyar</p>
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center p-3 rounded" style="background: var(--light-green);">
                                <div class="bg-accent-green p-3 rounded-circle me-3">
                                    <i class="fas fa-fish text-white"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1 text-primary-green">Dinas Perikanan</h5>
                                    <p class="text-muted mb-0">Tim Pemberdayaan Nelayan Situbondo</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <h5 class="section-title mb-3">Topik Terkait</h5>
                            <div class="d-flex flex-wrap gap-2">
                                <span class="badge bg-light text-dark p-2 border">kerja bakti</span>
                                <span class="badge bg-light text-dark p-2 border">pasar higienis mimbo</span>
                                <span class="badge bg-light text-dark p-2 border">ikan segar</span>
                                <span class="badge bg-light text-dark p-2 border">banyuputih</span>
                                <span class="badge bg-light text-dark p-2 border">sumberanyar</span>
                                <span class="badge bg-light text-dark p-2 border">pemberdayaan nelayan</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Facts -->
                    <div class="content-box" data-aos="fade-left" data-aos-delay="100">
                        <h2 class="section-title">Fakta Singkat</h2>
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-success-teal p-2 rounded-circle me-3">
                                <i class="fas fa-check text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Sinergi Multi-Pihak</h6>
                                <p class="text-muted mb-0">Kecamatan, desa, dan dinas terlibat</p>
                            </div>
                        </div>
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-warning-amber p-2 rounded-circle me-3">
                                <i class="fas fa-tools text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Fokus Perbaikan</h6>
                                <p class="text-muted mb-0">Akses jalan dan pintu depan pasar</p>
                            </div>
                        </div>
                        <div class="d-flex align-items-center">
                            <div class="bg-secondary-green p-2 rounded-circle me-3">
                                <i class="fas fa-handshake text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Kolaborasi</h6>
                                <p class="text-muted mb-0">Kerjasama dengan pemilik lahan</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modules Section -->
    <section class="modules-section">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Tahapan Persiapan Pasar Higienis</h2>
                    <p class="text-muted mt-3">Langkah-langkah yang dilakukan dalam persiapan peresmian pasar higienis ikan segar Mimbo</p>
                </div>
            </div>
            
            <div class="row g-4">
                <div class="col-lg-3 col-md-6" data-aos="fade-up">
                    <div class="module-card">
                        <div class="module-icon">
                            <i class="fas fa-road"></i>
                        </div>
                        <h4>Perbaikan Akses Jalan</h4>
                        <p class="text-muted">Peningkatan ketinggian dan perbaikan akses jalan menuju pasar untuk memudahkan transportasi ikan.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="module-card">
                        <div class="module-icon">
                            <i class="fas fa-door-open"></i>
                        </div>
                        <h4>Pintu Depan ke Pantai</h4>
                        <p class="text-muted">Koordinasi untuk pembuatan pintu depan pasar yang langsung mengarah ke pantai dan aktivitas nelayan.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="module-card">
                        <div class="module-icon">
                            <i class="fas fa-broom"></i>
                        </div>
                        <h4>Pembersihan Area</h4>
                        <p class="text-muted">Kerja bakti pembersihan area pasar dari sampah dan kotoran untuk menciptakan lingkungan higienis.</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                    <div class="module-card">
                        <div class="module-icon">
                            <i class="fas fa-users-cog"></i>
                        </div>
                        <h4>Koordinasi Stakeholder</h4>
                        <p class="text-muted">Pertemuan dan koordinasi dengan semua pihak terkait untuk penyelesaian kendala secara bersama-sama.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Speakers Section -->
    <section class="speakers-section">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Pihak yang Terlibat</h2>
                    <p class="text-muted mt-3">Perwakilan dari berbagai instansi yang hadir dalam kegiatan kerja bakti</p>
                </div>
            </div>
            
            <div class="row g-4">
                <div class="col-lg-4 col-md-6" data-aos="fade-up">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti1.jpeg" 
                                 alt="Camat Banyuputih"
                                 onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=Camat+Banyuputih&background=166534&color=fff&size=400'">
                        </div>
                        <h3 class="speaker-name">Camat Banyuputih</h3>
                        <p class="speaker-role">Perwakilan Kecamatan</p>
                        <p class="speaker-desc">Memimpin kegiatan kerja bakti bersama staf kecamatan, berkoordinasi dengan desa dan dinas terkait untuk persiapan peresmian pasar higienis ikan segar Mimbo.</p>
                    </div>
                </div>
                
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti2.jpeg" 
                                 alt="Perangkat Desa Sumberanyar"
                                 onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=Desa+Sumberanyar&background=16a34a&color=fff&size=400'">
                        </div>
                        <h3 class="speaker-name">Pemdes Sumberanyar</h3>
                        <p class="speaker-role">Pemerintah Desa</p>
                        <p class="speaker-desc">Berperan aktif dalam koordinasi dengan masyarakat dan pemilik lahan, serta memastikan pasar dapat berfungsi optimal untuk kesejahteraan warga desa.</p>
                    </div>
                </div>
                
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="speaker-card">
                        <div class="speaker-image">
                            <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti3.jpeg" 
                                 alt="Tim Dinas Perikanan"
                                 onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=Tim+Perikanan&background=22c55e&color=fff&size=400'">
                        </div>
                        <h3 class="speaker-name">Tim Dinas Perikanan</h3>
                        <p class="speaker-role">Bidang Pemberdayaan Nelayan</p>
                        <p class="speaker-desc">Menyediakan pendampingan teknis, berkoordinasi dengan berbagai pihak, dan memastikan pasar memenuhi standar higienis untuk penjualan ikan segar.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section class="gallery-section">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Galeri Foto Kegiatan</h2>
                    <p class="text-muted mt-3">Dokumentasi visual kerja bakti persiapan peresmian pasar higienis ikan segar Mimbo</p>
                </div>
            </div>
            
            <div class="row g-4">
                <!-- Foto 1 -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti1.jpeg" 
                             alt="Koordinasi antar pihak terkait"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Koordinasi Awal</h6>
                                <small class="text-white">Diskusi antara camat, desa, dan dinas</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Foto 2 -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti2.jpeg" 
                             alt="Pembersihan area pasar"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1574231164645-d6f0e8553590?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Pembersihan Area</h6>
                                <small class="text-white">Kerja bakti membersihkan lingkungan pasar</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Foto 3 -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti3.jpeg" 
                             alt="Diskusi teknis tentang akses jalan"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Diskusi Teknis</h6>
                                <small class="text-white">Membahas kendala akses jalan ke pasar</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Foto 5 -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti5.jpeg" 
                             alt="Rencana pembuatan pintu depan ke pantai"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1516937941344-00b4e0337589?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Rencana Pintu Depan</h6>
                                <small class="text-white">Lokasi rencana pembuatan pintu ke pantai</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tambahan foto lain jika perlu -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti1.jpeg" 
                             alt="Kegiatan kerja bakti lainnya"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Aktivitas Kerja Bakti</h6>
                                <small class="text-white">Kegiatan gotong royong membersihkan area</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Foto tambahan -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/foto/kerjabakti/kerjabakti2.jpeg" 
                             alt="Pembersihan area pasar"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1574231164645-d6f0e8553590?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        <div class="gallery-overlay">
                            <div class="gallery-caption">
                                <h6 class="text-white mb-0">Lingkungan Pasar</h6>
                                <small class="text-white">Area pasar yang sudah dibersihkan</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Video Section -->
    <section class="video-section">
        <div class="container">
            <div class="row mb-5">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="section-title d-inline-block">Video Dokumentasi Kerja Bakti</h2>
                    <p class="text-muted mt-3">Rekaman kegiatan dan suasana kerja bakti persiapan pasar higienis ikan segar Mimbo</p>
                </div>
            </div>
            
            <div class="row">
                <div class="col-lg-10 mx-auto" data-aos="fade-up">
                    <div class="video-container">
                        <iframe src="https://www.youtube.com/watch?v=_GyZhrSfMWY" 
                                title="Video Dokumentasi Kerja Bakti Persiapan Pasar Higienis Ikan Segar Mimbo" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen></iframe>
                    </div>
                    <div class="text-center mt-4">
                        <h4>Dokumentasi Kerja Bakti Persiapan Pasar Higienis</h4>
                        <p>Video dokumentasi lengkap kegiatan kerja bakti persiapan peresmian pasar higienis ikan segar Mimbo di Desa Sumberanyar, Kecamatan Banyuputih, Situbondo</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Action Buttons -->
    <section class="action-buttons">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="mb-4">Akses Laporan dan Bagikan Kegiatan</h2>
                    <div class="d-flex flex-wrap justify-content-center gap-3">
                        <button class="btn-download" onclick="openPdfAuthModal()">
                            <i class="fas fa-download me-2"></i>Download Laporan Kegiatan (PDF)
                        </button>
                        <button class="btn-share" onclick="openShareModal()">
                            <i class="fas fa-share-alt me-2"></i>Bagikan Kegiatan Ini
                        </button>
                        <a href="https://www.dinasperikanansitubondo.com/kegiatan" class="btn-share">
                            <i class="fas fa-images me-2"></i>Kegiatan Lainnya
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-4">
                    <div class="d-flex align-items-center mb-4">
                        <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" 
                             alt="Logo Kabupaten Situbondo" 
                             height="50" 
                             class="me-3">
                        <div>
                            <h4 class="text-white mb-0">DINAS PERIKANAN</h4>
                            <small class="text-light">Kabupaten Situbondo</small>
                        </div>
                    </div>
                    <p class="text-light mb-4" style="line-height: 1.7;">
                        Berkontribusi aktif dalam memajukan sektor perikanan tangkap dan memberdayakan masyarakat pesisir Situbondo melalui berbagai program inovatif dan berkelanjutan.
                    </p>
                    <div class="social-icons mt-4">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                
                <div class="col-lg-3">
                    <h5>Tautan Cepat</h5>
                    <div class="footer-links mt-4">
                        <a href="https://www.dinasperikanansitubondo.com"><i class="fas fa-home me-2"></i>Beranda</a>
                        <a href="https://www.dinasperikanansitubondo.com/simpadan"><i class="fas fa-mobile-alt me-2"></i>SIMPADAN</a>
                        <a href="https://www.dinasperikanansitubondo.com/dokumentasi"><i class="fas fa-images me-2"></i>Dokumentasi</a>
                        <a href="https://situbondokab.go.id/"><i class="fas fa-university me-2"></i>Pemkab Situbondo</a>
                        <a href="https://www.dinasperikanansitubondo.com#aduan"><i class="fas fa-headset me-2"></i>Pengaduan</a>
                    </div>
                </div>
                
                <div class="col-lg-5">
                    <h5>Kontak Kami</h5>
                    <div class="mt-4">
                        <div class="d-flex align-items-start mb-4">
                            <div class="bg-secondary-green p-2 rounded-circle me-3 flex-shrink-0">
                                <i class="fas fa-map-marker-alt text-white"></i>
                            </div>
                            <div>
                                <span class="d-block text-white fw-bold">Alamat Kantor</span>
                                <small class="text-light">Jl. PB Sudirman No.77 C, Situbondo, Jawa Timur</small>
                            </div>
                        </div>
                        <div class="d-flex align-items-start mb-4">
                            <div class="bg-secondary-green p-2 rounded-circle me-3 flex-shrink-0">
                                <i class="fab fa-whatsapp text-white"></i>
                            </div>
                            <div>
                                <span class="d-block text-white fw-bold">WhatsApp Admin</span>
                                <small class="text-light">0878 6561 4222</small>
                            </div>
                        </div>
                        <div class="d-flex align-items-start">
                            <div class="bg-secondary-green p-2 rounded-circle me-3 flex-shrink-0">
                                <i class="fas fa-envelope text-white"></i>
                            </div>
                            <div>
                                <span class="d-block text-white fw-bold">Email</span>
                                <small class="text-light">info@dinasperikanansitubondo.com</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <hr class="bg-light my-5">
            
            <div class="text-center text-light">
                <p class="mb-2">&copy; <span id="currentYear">2025</span> Dinas Perikanan Situbondo. Hak Cipta Dilindungi.</p>
                <small>Dibuat dengan <i class="fas fa-heart text-danger"></i> untuk Nelayan Situbondo</small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            once: true,
            offset: 100
        });

        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.boxShadow = '0 5px 20px rgba(0, 0, 0, 0.1)';
                navbar.style.backgroundColor = 'rgba(255, 255, 255, 0.98)';
            } else {
                navbar.style.boxShadow = '0 2px 20px rgba(0, 0, 0, 0.08)';
                navbar.style.backgroundColor = 'rgba(255, 255, 255, 0.95)';
            }
        });

        // Gallery modal functionality
        const galleryItems = document.querySelectorAll('.gallery-item');
        galleryItems.forEach(item => {
            item.addEventListener('click', function() {
                const imgSrc = this.querySelector('img').src;
                const imgAlt = this.querySelector('img').alt;
                
                // Create modal
                const modalHTML = `
                <div class="modal fade" id="imageModal" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content border-0">
                            <div class="modal-body p-0 position-relative">
                                <img src="${imgSrc}" alt="${imgAlt}" class="img-fluid w-100 rounded">
                                <button type="button" class="btn-close position-absolute top-0 end-0 m-3 bg-white" data-bs-dismiss="modal"></button>
                            </div>
                        </div>
                    </div>
                </div>
                `;
                
                // Add modal to body
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                
                // Show modal
                const modal = new bootstrap.Modal(document.getElementById('imageModal'));
                modal.show();
                
                // Remove modal when closed
                document.getElementById('imageModal').addEventListener('hidden.bs.modal', function() {
                    this.remove();
                });
            });
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if(targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if(targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Add scroll to top button
        const scrollTopBtn = document.createElement('button');
        scrollTopBtn.innerHTML = '<i class="fas fa-chevron-up"></i>';
        scrollTopBtn.className = 'btn btn-primary position-fixed bottom-3 end-3 rounded-circle shadow-lg';
        scrollTopBtn.style.width = '50px';
        scrollTopBtn.style.height = '50px';
        scrollTopBtn.style.zIndex = '1000';
        scrollTopBtn.style.display = 'none';
        scrollTopBtn.style.background = 'linear-gradient(135deg, var(--secondary-green), var(--primary-green))';
        scrollTopBtn.style.border = 'none';
        
        document.body.appendChild(scrollTopBtn);
        
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                scrollTopBtn.style.display = 'flex';
                scrollTopBtn.style.alignItems = 'center';
                scrollTopBtn.style.justifyContent = 'center';
            } else {
                scrollTopBtn.style.display = 'none';
            }
        });
        
        scrollTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Share functionality
        function openShareModal() {
            document.getElementById('shareModal').style.display = 'flex';
        }

        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
        }

        function shareToWhatsApp() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('Kerja Bakti Persiapan Peresmian Pasar Higienis Ikan Segar Mimbo\n\nKegiatan kerja bakti dalam rangka persiapan peresmian pasar higienis ikan segar Mimbo yang dihadiri Camat Banyuputih beserta staf, Pemdes Sumberanyar, dan Tim Bidang Pemberdayaan Nelayan dari Dinas Peternakan dan Perikanan Kabupaten Situbondo.\n\nBaca selengkapnya di:');
            window.open(`https://wa.me/?text=${text}%20${url}`, '_blank');
        }

        function copyLink() {
            const currentUrl = window.location.href;
            navigator.clipboard.writeText(currentUrl).then(() => {
                alert('Link berhasil disalin ke clipboard!');
                closeShareModal();
            }).catch(err => {
                console.error('Gagal menyalin link: ', err);
                alert('Gagal menyalin link. Silakan coba lagi.');
            });
        }

        // Close modal when clicking outside
        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeShareModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeShareModal();
                closePdfPreview();
                closePdfAuthModal();
            }
        });

        // ==================== PDF AUTHORIZATION FUNCTIONS ====================
        
        // Security system variables
        let maxAttempts = 3;
        let currentAttempts = 0;
        let lockoutTime = 0;
        const lockoutDuration = 5 * 60 * 1000; // 5 minutes in milliseconds
        
        // PERBAIKAN: Generate security code berdasarkan format DDMMYYYY
        function generateSecurityCode() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            
            // Format DDMMYYYY seperti yang diminta
            // Contoh: 31 Januari 2026 -> 31012026
            // Contoh: 01 Februari 2026 -> 01022026
            return day + month + year;
        }

        // Check if user is locked out
        function isLockedOut() {
            if (lockoutTime > 0) {
                const currentTime = new Date().getTime();
                const timeRemaining = lockoutTime - currentTime;
                
                if (timeRemaining > 0) {
                    const minutes = Math.floor(timeRemaining / 60000);
                    const seconds = Math.floor((timeRemaining % 60000) / 1000);
                    return {
                        locked: true,
                        message: `Akses terkunci. Silakan coba lagi dalam ${minutes} menit ${seconds} detik.`
                    };
                } else {
                    // Lockout period has ended
                    lockoutTime = 0;
                    currentAttempts = 0;
                    return { locked: false, message: '' };
                }
            }
            return { locked: false, message: '' };
        }

        // Toggle password visibility
        let isPasswordVisible = false;
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('securityCodeInput');
            const toggleIcon = document.getElementById('passwordToggle').querySelector('i');
            
            isPasswordVisible = !isPasswordVisible;
            
            if (isPasswordVisible) {
                passwordInput.type = 'text';
                toggleIcon.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                toggleIcon.className = 'fas fa-eye';
            }
        }

        // Open PDF authorization modal
        function openPdfAuthModal() {
            // Check if user is locked out
            const lockoutStatus = isLockedOut();
            if (lockoutStatus.locked) {
                alert(lockoutStatus.message);
                return;
            }
            
            // Reset form
            document.getElementById('securityCodeInput').value = '';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('errorText').textContent = 'Kode keamanan yang Anda masukkan salah. Silakan coba lagi.';
            document.getElementById('securityCodeInput').classList.remove('is-invalid');
            
            // Update attempts counter
            document.getElementById('attemptsLeft').textContent = maxAttempts - currentAttempts;
            
            // Show modal
            document.getElementById('pdfAuthModal').style.display = 'flex';
            
            // Focus on input
            setTimeout(() => {
                document.getElementById('securityCodeInput').focus();
            }, 300);
        }

        // Close PDF authorization modal
        function closePdfAuthModal() {
            document.getElementById('pdfAuthModal').style.display = 'none';
        }

        // Verify security code
        function verifySecurityCode() {
            // Check if user is locked out
            const lockoutStatus = isLockedOut();
            if (lockoutStatus.locked) {
                document.getElementById('errorText').textContent = lockoutStatus.message;
                document.getElementById('errorMessage').style.display = 'block';
                return;
            }
            
            const userInput = document.getElementById('securityCodeInput').value;
            const correctCode = generateSecurityCode(); // Get the SECRET code
            const errorMessage = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            const inputElement = document.getElementById('securityCodeInput');
            
            // Validate input
            if (!userInput || userInput.length !== 8) {
                errorText.textContent = 'Kode keamanan harus terdiri dari 8 digit angka.';
                errorMessage.style.display = 'block';
                inputElement.classList.add('is-invalid');
                inputElement.focus();
                return;
            }
            
            // PERBAIKAN: Bandingkan langsung dengan kode yang benar
            if (userInput === correctCode) {
                // Code is correct - reset attempts
                currentAttempts = 0;
                closePdfAuthModal();
                generatePDFReport();
            } else {
                // Code is incorrect
                currentAttempts++;
                
                // Update attempts counter
                const attemptsLeft = maxAttempts - currentAttempts;
                document.getElementById('attemptsLeft').textContent = attemptsLeft;
                
                if (currentAttempts >= maxAttempts) {
                    // Lock user out
                    lockoutTime = new Date().getTime() + lockoutDuration;
                    errorText.textContent = 'Terlalu banyak percobaan gagal. Akses terkunci selama 5 menit.';
                } else {
                    errorText.textContent = `Kode keamanan salah. Percobaan ${currentAttempts} dari ${maxAttempts}.`;
                }
                
                errorMessage.style.display = 'block';
                inputElement.classList.add('is-invalid');
                
                // Shake animation for error
                inputElement.style.animation = 'none';
                setTimeout(() => {
                    inputElement.style.animation = 'shake 0.5s';
                }, 10);
                
                // Clear input and focus
                inputElement.value = '';
                inputElement.focus();
            }
        }

        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // PDF Generation Functions
        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function openPdfPreview() {
            document.getElementById('pdfPreviewModal').style.display = 'flex';
        }

        function closePdfPreview() {
            document.getElementById('pdfPreviewModal').style.display = 'none';
        }

        // Generate PDF report after successful authorization
        function generatePDFReport() {
            showLoading();
            
            // Get current date for report
            const currentDate = new Date();
            const formattedDate = currentDate.toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            // Create PDF content with formal format
            const pdfContent = `
            <div style="font-family: 'Times New Roman', Times, serif; line-height: 1.6; color: #333;">
                <!-- Kop Surat -->
                <div style="margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 20px;">
                    <table style="width: 100%;">
                        <tr>
                            <td style="width: 80px; vertical-align: middle; padding-top: 5px;">
                                <img src="https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png" 
                                     alt="Logo Kabupaten Situbondo" 
                                     style="width: 70px; height: 70px; object-fit: contain; display: block; border-radius: 0;">
                            </td>
                            <td style="vertical-align: middle; padding-left: 15px;">
                                <h2 style="margin: 0; font-size: 16px; font-weight: bold; letter-spacing: 0.5px;">PEMERINTAH KABUPATEN SITUBONDO</h2>
                                <h1 style="margin: 5px 0; font-size: 18px; font-weight: bold; color: #166534;">DINAS PETERNAKAN DAN PERIKANAN</h1>
                                <p style="margin: 0; font-size: 12px; letter-spacing: 0.3px; line-height: 1.5;">
                                    Jl. PB SUDIRMAN No 77c SITUBONDO TELP/FAX (0338) 672664<br>
                                    SITUBONDO 68312
                                </p>
                            </td>
                        </tr>
                    </table>
                </div>
                
                <!-- Judul Laporan -->
                <div style="text-align: center; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 10px; font-size: 14px; font-weight: bold; color: #333;">LAPORAN KEGIATAN</h3>
                    <h1 style="font-size: 16px; font-weight: bold; text-decoration: underline; color: #166534; line-height: 1.4;">
                        KERJA BAKTI PERSIAPAN PERESMIAN<br>
                        PASAR HIGIENIS IKAN SEGAR MIMBO
                    </h1>
                </div>
                
                <!-- Isi Laporan -->
                <div style="margin-bottom: 30px;">
                    <h4 style="font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #166534;">
                        I. LATAR BELAKANG
                    </h4>
                    <p style="text-align: justify; margin-bottom: 20px; font-size: 12px; line-height: 1.7; text-indent: 30px;">
                        Dalam rangka persiapan peresmian Pasar Higienis Ikan Segar Mimbo, Dinas Peternakan dan Perikanan Kabupaten Situbondo bersama dengan Camat Banyuputih beserta staf, Pemerintah Desa Sumberanyar, dan Tim Bidang Pemberdayaan Nelayan melaksanakan kegiatan kerja bakti. Kegiatan ini bertujuan untuk mempersiapkan infrastruktur pasar agar memenuhi standar higienis dan dapat berfungsi optimal untuk mendukung aktivitas perikanan di wilayah pesisir Situbondo.
                    </p>
                    
                    <h4 style="font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #166534;">
                        II. TUJUAN KEGIATAN
                    </h4>
                    <ol style="margin-bottom: 20px; padding-left: 25px; font-size: 12px; line-height: 1.7;">
                        <li style="margin-bottom: 10px; text-align: justify;">Mempersiapkan infrastruktur Pasar Higienis Ikan Segar Mimbo</li>
                        <li style="margin-bottom: 10px; text-align: justify;">Mengatasi kendala teknis berupa akses jalan yang kurang tinggi</li>
                        <li style="margin-bottom: 10px; text-align: justify;">Mengkoordinasikan pembuatan pintu depan pasar yang mengarah ke pantai</li>
                        <li style="margin-bottom: 10px; text-align: justify;">Membersihkan dan menyiapkan area pasar untuk aktivitas perdagangan ikan</li>
                        <li style="margin-bottom: 0; text-align: justify;">Memperkuat sinergi antar pihak terkait dalam pengembangan infrastruktur perikanan</li>
                    </ol>
                    
                    <h4 style="font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #166534;">
                        III. KENDALA YANG DIHADAPI
                    </h4>
                    <ul style="margin-bottom: 20px; padding-left: 25px; font-size: 12px; line-height: 1.7;">
                        <li style="margin-bottom: 10px; text-align: justify;">Akses jalan ke pasar kurang tinggi sehingga menyulitkan transportasi ikan</li>
                        <li style="margin-bottom: 0; text-align: justify;">Pasar tidak memiliki pintu muka yang mengarah ke pantai padahal lokasi sangat dekat dengan aktivitas nelayan</li>
                    </ul>
                    
                    <h4 style="font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #166534;">
                        IV. TINDAKAN YANG DILAKUKAN
                    </h4>
                    <ul style="margin-bottom: 20px; padding-left: 25px; font-size: 12px; line-height: 1.7;">
                        <li style="margin-bottom: 10px; text-align: justify;">Kerja bakti pembersihan area pasar dari sampah dan kotoran</li>
                        <li style="margin-bottom: 10px; text-align: justify;">Koordinasi dengan Pemdes Sumberanyar dan pemilik lahan pribadi untuk pembuatan pintu depan pasar</li>
                        <li style="margin-bottom: 10px; text-align: justify;">Evaluasi dan perencanaan perbaikan akses jalan menuju pasar</li>
                        <li style="margin-bottom: 0; text-align: justify;">Sosialisasi pentingnya pasar higienis kepada masyarakat sekitar</li>
                    </ul>
                    
                    <h4 style="font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #166534;">
                        V. HASIL KEGIATAN
                    </h4>
                    <p style="text-align: justify; margin-bottom: 20px; font-size: 12px; line-height: 1.7; text-indent: 30px;">
                        Kegiatan kerja bakti berlangsung dengan lancar dan diikuti dengan semangat oleh seluruh pihak terkait. Area pasar telah dibersihkan dan siap untuk dipersiapkan lebih lanjut. Telah dilakukan koordinasi intensif untuk mengatasi kendala akses jalan dan pintu depan pasar. Dengan sinergi yang terbangun antara kecamatan, desa, dan dinas, diharapkan Pasar Higienis Ikan Segar Mimbo dapat segera beroperasi dan memberikan manfaat maksimal bagi masyarakat pesisir Situbondo.
                    </p>
                </div>
                
                <!-- Tanda Tangan -->
                <div style="display: flex; justify-content: space-between; margin-top: 80px; align-items: flex-start;">
                    <div style="width: 60%;">
                        <div style="margin-bottom: 10px;">
                            <p style="margin-bottom: 5px; font-size: 12px;">Situbondo, ${formattedDate}</p>
                            <p style="font-weight: bold; font-size: 12px; margin-top: 40px;">Pelapor,</p>
                        </div>
                    </div>
                    <div style="width: 35%;">
                        <!-- Kosongkan untuk QR code nanti -->
                    </div>
                </div>
                
                <!-- Footer dengan garis dan QR code -->
                <div style="margin-top: 100px; border-top: 1px solid #ddd; padding-top: 15px; position: relative;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="text-align: left; font-size: 10px; color: #666; width: 70%;">
                            <p style="margin-bottom: 5px;">Laporan ini dibuat secara otomatis oleh sistem Dinas Perikanan Situbondo</p>
                            <p> ${currentDate.getFullYear()} Dinas Peternakan dan Perikanan Kabupaten Situbondo</p>
                        </div>
                        <div style="text-align: right; width: 25%;">
                            <div class="qr-code" style="background: #ffffff; padding: 5px; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); float: right;">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=${encodeURIComponent(window.location.href)}&color=166534&bgcolor=ffffff" 
                                     alt="QR Code Sumber Laporan" 
                                     style="width: 70px; height: 70px; object-fit: contain;">
                            </div>
                            <p style="font-size: 9px; margin-top: 5px; color: #666; clear: both; text-align: right;">Scan untuk mengakses sumber laporan</p>
                        </div>
                    </div>
                </div>
            </div>
            `;
            
            // Set content to preview
            document.getElementById('pdfPreviewContent').innerHTML = pdfContent;
            
            hideLoading();
            openPdfPreview();
        }

        // Base64 encoded placeholder logo untuk menghindari CORS issues
        const placeholderLogo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFjSURBVHgB7d2xTQNBEIXhsfAFARIgQzKgTToYAjg3j6JXODcPwdJgOSc/9Vx3/oPnOe6OnnH0l93Tsz+e3/kv3pnvxAAQIIAAIgwggAgDiCCAAAIIIICAIIAAAggggAACCCDAABBAgAEggAADQAABBoAAAggggAACCCCAABBAgAEggAACCAgCCCAgCCCAgCCAAAKCAAIICAIICDAABBAQBBBAQBBAAAFBAAEEBAEEEBAEEECAAQSRl/bVc52Z63K6r7c+87Nf3tpyuvfsbT3f2/Kje+6W073n9Tk9e/Z6Hv3wWIIYAAIIIMAABhBAgAEggAADQAABBoAAAggggAACCDAABBAQBBBAQBBAAAFBAAEEBAEEEBAEEECAAQygT+3b89J+PF+c7T37S/tX53vP3nLq2X09r+f7cua+/V7PW5/ZZ1/L6fXc1/Nx/Bj7O8/HXyIABBBCABnQEcTAACgYgAADQAABBBgAAggwAAQQYAATfLZXKSDj7SwAAAAASUVORK5CYII=';

        async function downloadPDF() {
            showLoading();
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });
                
                // Set margins
                const margin = 20;
                let yPos = margin;
                
                // Current date
                const currentDate = new Date();
                const formattedDate = currentDate.toLocaleDateString('id-ID', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });
                
                // Logo dimensions
                const logoWidth = 18;
                const logoHeight = 18;
                
                // Try to load real logo, fallback to placeholder
                try {
                    const logoImg = new Image();
                    logoImg.crossOrigin = 'Anonymous';
                    
                    await new Promise((resolve, reject) => {
                        logoImg.onload = resolve;
                        logoImg.onerror = () => {
                            // Use placeholder if real logo fails
                            logoImg.src = placeholderLogo;
                            resolve();
                        };
                        logoImg.src = 'https://raw.githubusercontent.com/pemberdayaannelayan/situbondo/refs/heads/main/LOGO%20KABUPATEN%20SITUBONDO.png';
                    });
                    
                    // Add logo at the top-left
                    doc.addImage(logoImg, 'PNG', margin, yPos, logoWidth, logoHeight);
                } catch (e) {
                    console.log('Using placeholder logo');
                    const placeholderImg = new Image();
                    placeholderImg.src = placeholderLogo;
                    await new Promise(resolve => {
                        placeholderImg.onload = resolve;
                    });
                    doc.addImage(placeholderImg, 'PNG', margin, yPos, logoWidth, logoHeight);
                }
                
                // Add header text to the right of the logo
                doc.setFontSize(11);
                doc.setFont("helvetica", "bold");
                doc.text("PEMERINTAH KABUPATEN SITUBONDO", 105, yPos + 5, { align: 'center' });
                
                doc.setFontSize(12);
                doc.text("DINAS PETERNAKAN DAN PERIKANAN", 105, yPos + 11, { align: 'center' });
                
                doc.setFontSize(9);
                doc.setFont("helvetica", "normal");
                doc.text("Jl. PB SUDIRMAN No 77c SITUBONDO TELP/FAX (0338) 672664", 105, yPos + 17, { align: 'center' });
                doc.text("SITUBONDO 68312", 105, yPos + 22, { align: 'center' });
                
                yPos += 30;
                
                // Add horizontal line
                doc.setLineWidth(0.5);
                doc.line(margin, yPos, 210 - margin, yPos);
                yPos += 15;
                
                // Report title
                doc.setFontSize(12);
                doc.setFont("helvetica", "bold");
                doc.text("LAPORAN KEGIATAN", 105, yPos, { align: 'center' });
                yPos += 10;
                
                // Main title
                doc.setFontSize(14);
                const title1 = "KERJA BAKTI PERSIAPAN PERESMIAN";
                const title2 = "PASAR HIGIENIS IKAN SEGAR MIMBO";
                
                // Split jika terlalu panjang
                const titleLines1 = doc.splitTextToSize(title1, 170);
                const titleLines2 = doc.splitTextToSize(title2, 170);
                
                titleLines1.forEach(line => {
                    doc.text(line, 105, yPos, { align: 'center' });
                    yPos += 7;
                });
                
                titleLines2.forEach(line => {
                    doc.text(line, 105, yPos, { align: 'center' });
                    yPos += 7;
                });
                
                yPos += 10;
                
                // Helper function untuk menambahkan teks dengan pemisahan yang baik
                function addText(title, content, isList = false, isNumberedList = false) {
                    // Check for page break
                    if (yPos > 270) {
                        doc.addPage();
                        yPos = margin;
                    }
                    
                    // Add title
                    doc.setFontSize(12);
                    doc.setFont("helvetica", "bold");
                    doc.text(title, margin, yPos);
                    yPos += 8;
                    
                    // Add content
                    doc.setFontSize(11);
                    doc.setFont("helvetica", "normal");
                    
                    if (isList) {
                        const items = content.split('\n');
                        items.forEach((item, index) => {
                            if (yPos > 270) {
                                doc.addPage();
                                yPos = margin + 8;
                            }
                            // Gunakan splitTextToSize untuk item yang panjang
                            const lines = doc.splitTextToSize(item, 160);
                            lines.forEach((line, lineIndex) => {
                                if (lineIndex === 0) {
                                    if (isNumberedList) {
                                        doc.text(`${index + 1}. ${line}`, margin + 5, yPos);
                                    } else {
                                        doc.text(` ${line}`, margin + 5, yPos);
                                    }
                                } else {
                                    doc.text(line, margin + 10, yPos);
                                }
                                yPos += 6;
                            });
                        });
                    } else {
                        // Split long text into lines with a max width of 170mm
                        const lines = doc.splitTextToSize(content, 170);
                        lines.forEach(line => {
                            if (yPos > 270) {
                                doc.addPage();
                                yPos = margin + 8;
                            }
                            doc.text(line, margin, yPos);
                            yPos += 6;
                        });
                    }
                    
                    yPos += 8; // Spacing between sections
                }
                
                // Add content sections with improved text wrapping
                addText("I. LATAR BELAKANG", 
                    "Dalam rangka persiapan peresmian Pasar Higienis Ikan Segar Mimbo, Dinas Peternakan dan Perikanan Kabupaten Situbondo bersama dengan Camat Banyuputih beserta staf, Pemerintah Desa Sumberanyar, dan Tim Bidang Pemberdayaan Nelayan melaksanakan kegiatan kerja bakti. Kegiatan ini bertujuan untuk mempersiapkan infrastruktur pasar agar memenuhi standar higienis dan dapat berfungsi optimal untuk mendukung aktivitas perikanan di wilayah pesisir Situbondo.");
                
                addText("II. TUJUAN KEGIATAN", 
                    "Mempersiapkan infrastruktur Pasar Higienis Ikan Segar Mimbo\n" +
                    "Mengatasi kendala teknis berupa akses jalan yang kurang tinggi\n" +
                    "Mengkoordinasikan pembuatan pintu depan pasar yang mengarah ke pantai\n" +
                    "Membersihkan dan menyiapkan area pasar untuk aktivitas perdagangan ikan\n" +
                    "Memperkuat sinergi antar pihak terkait dalam pengembangan infrastruktur perikanan", true, true);
                
                addText("III. KENDALA YANG DIHADAPI", 
                    "Akses jalan ke pasar kurang tinggi sehingga menyulitkan transportasi ikan\n" +
                    "Pasar tidak memiliki pintu muka yang mengarah ke pantai padahal lokasi sangat dekat dengan aktivitas nelayan", true);
                
                addText("IV. TINDAKAN YANG DILAKUKAN", 
                    "Kerja bakti pembersihan area pasar dari sampah dan kotoran\n" +
                    "Koordinasi dengan Pemdes Sumberanyar dan pemilik lahan pribadi untuk pembuatan pintu depan pasar\n" +
                    "Evaluasi dan perencanaan perbaikan akses jalan menuju pasar\n" +
                    "Sosialisasi pentingnya pasar higienis kepada masyarakat sekitar", true);
                
                addText("V. HASIL KEGIATAN", 
                    "Kegiatan kerja bakti berlangsung dengan lancar dan diikuti dengan semangat oleh seluruh pihak terkait. Area pasar telah dibersihkan dan siap untuk dipersiapkan lebih lanjut. Telah dilakukan koordinasi intensif untuk mengatasi kendala akses jalan dan pintu depan pasar. Dengan sinergi yang terbangun antara kecamatan, desa, dan dinas, diharapkan Pasar Higienis Ikan Segar Mimbo dapat segera beroperasi dan memberikan manfaat maksimal bagi masyarakat pesisir Situbondo.");
                
                // Add signature section
                if (yPos > 250) {
                    doc.addPage();
                    yPos = margin;
                }
                
                doc.setFontSize(11);
                doc.text(`Situbondo, ${formattedDate}`, margin, yPos);
                yPos += 12;
                doc.setFont("helvetica", "bold");
                doc.text("Pelapor,", margin, yPos);
                yPos += 25;
                
                // Draw a line above the footer
                doc.setLineWidth(0.1);
                doc.line(margin, yPos, 210 - margin, yPos);
                
                // Add footer text on the left
                yPos += 5;
                doc.setFontSize(8);
                doc.setFont("helvetica", "normal");
                doc.text("Laporan ini dibuat secara otomatis oleh sistem Dinas Perikanan Situbondo", margin, yPos);
                doc.text(` ${currentDate.getFullYear()} Dinas Peternakan dan Perikanan Kabupaten Situbondo`, margin, yPos + 4);
                
                // Add QR Code on the right side, below the line
                const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=${encodeURIComponent(window.location.href)}&color=166534&bgcolor=ffffff`;
                try {
                    const qrImg = new Image();
                    qrImg.crossOrigin = 'Anonymous';
                    
                    await new Promise(resolve => {
                        qrImg.onload = resolve;
                        qrImg.onerror = resolve; // Continue even if QR code fails
                        qrImg.src = qrCodeUrl;
                    });
                    
                    const qrSize = 15;
                    const qrX = 210 - margin - qrSize;
                    const qrY = yPos - 9;
                    
                    if (qrImg.complete && qrImg.naturalHeight !== 0) {
                        doc.addImage(qrImg, 'PNG', qrX, qrY, qrSize, qrSize);
                        doc.setFontSize(6);
                        doc.text("Scan untuk", qrX + qrSize/2, qrY + qrSize + 3, { align: 'center' });
                        doc.text("mengakses", qrX + qrSize/2, qrY + qrSize + 6, { align: 'center' });
                    }
                } catch (e) {
                    console.log('QR code generation failed, continuing without it');
                }
                
                // Save the PDF
                const fileName = `Laporan_Kerja_Bakti_Pasar_Higienis_Mimbo_${currentDate.getFullYear()}${String(currentDate.getMonth()+1).padStart(2,'0')}${String(currentDate.getDate()).padStart(2,'0')}.pdf`;
                doc.save(fileName);
                
                hideLoading();
                closePdfPreview();
                
                // Show success message
                setTimeout(() => {
                    alert('Laporan PDF berhasil diunduh!');
                }, 500);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                hideLoading();
                alert('PDF berhasil dibuat! Silakan cek folder download Anda.');
            }
        }

        // Fix for footer positioning
        function fixFooterPosition() {
            const footer = document.querySelector('.footer');
            const bodyHeight = document.body.offsetHeight;
            const windowHeight = window.innerHeight;
            
            if (bodyHeight < windowHeight) {
                footer.style.position = 'fixed';
                footer.style.bottom = '0';
            } else {
                footer.style.position = 'relative';
            }
        }

        // Call on load and resize
        window.addEventListener('load', fixFooterPosition);
        window.addEventListener('resize', fixFooterPosition);

        // Initialize password toggle
        document.getElementById('passwordToggle').addEventListener('click', togglePasswordVisibility);
        
        // Allow pressing Enter to submit the security code
        document.getElementById('securityCodeInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                verifySecurityCode();
            }
        });
        
        // Close PDF auth modal when clicking outside
        document.getElementById('pdfAuthModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closePdfAuthModal();
            }
        });
        
        // Restrict input to numbers only
        document.getElementById('securityCodeInput').addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
        
        // Debug: Tampilkan kode keamanan saat ini di console untuk testing
        console.log("Kode keamanan hari ini:", generateSecurityCode());
    </script>
</body>
</html>
